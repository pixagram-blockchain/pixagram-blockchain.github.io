/*! For license information please see chunk_21.min.js.LICENSE.txt */
(self.webpackChunkpixagram_io=self.webpackChunkpixagram_io||[]).push([[21],{918:(e,t,n)=>{"use strict";var i=n(377),s=n(459);t.A=void 0;var a=s(n(228)),o=(0,i(n(460)).default)(a.createElement(a.Fragment,null,a.createElement("circle",{cx:"12",cy:"12",r:"3"}),a.createElement("path",{d:"M20 4h-3.17l-1.24-1.35c-.37-.41-.91-.65-1.47-.65H9.88c-.56 0-1.1.24-1.48.65L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 13c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"})),"PhotoCameraRounded");t.A=o},919:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var i=n(237),s=n(215),a=n(228),o=n(382),r=n(235),c=n(456),l=n(439),d=a.forwardRef((function(e,t){var n=e.children,r=e.classes,d=e.className,u=e.color,p=void 0===u?"default":u,h=e.component,f=void 0===h?"button":h,g=e.disabled,m=void 0!==g&&g,_=e.disableFocusRipple,w=void 0!==_&&_,v=e.focusVisibleClassName,b=e.size,y=void 0===b?"large":b,k=e.variant,x=void 0===k?"circular":k,E=(0,i.A)(e,["children","classes","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"]);return a.createElement(c.A,(0,s.A)({className:(0,o.default)(r.root,d,"large"!==y&&r["size".concat((0,l.A)(y))],m&&r.disabled,"extended"===x&&r.extended,{primary:r.primary,secondary:r.secondary,inherit:r.colorInherit}[p]),component:f,disabled:m,focusRipple:!w,focusVisibleClassName:(0,o.default)(r.focusVisible,v),ref:t},E),a.createElement("span",{className:r.label},n))}));const u=(0,r.A)((function(e){return{root:(0,s.A)({},e.typography.button,{boxSizing:"border-box",minHeight:36,transition:e.transitions.create(["background-color","box-shadow","border"],{duration:e.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,boxShadow:e.shadows[6],"&:active":{boxShadow:e.shadows[12]},color:e.palette.getContrastText(e.palette.grey[300]),backgroundColor:e.palette.grey[300],"&:hover":{backgroundColor:e.palette.grey.A100,"@media (hover: none)":{backgroundColor:e.palette.grey[300]},"&$disabled":{backgroundColor:e.palette.action.disabledBackground},textDecoration:"none"},"&$focusVisible":{boxShadow:e.shadows[6]},"&$disabled":{color:e.palette.action.disabled,boxShadow:e.shadows[0],backgroundColor:e.palette.action.disabledBackground}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},primary:{color:e.palette.primary.contrastText,backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark,"@media (hover: none)":{backgroundColor:e.palette.primary.main}}},secondary:{color:e.palette.secondary.contrastText,backgroundColor:e.palette.secondary.main,"&:hover":{backgroundColor:e.palette.secondary.dark,"@media (hover: none)":{backgroundColor:e.palette.secondary.main}}},extended:{borderRadius:24,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48,"&$sizeSmall":{width:"auto",padding:"0 8px",borderRadius:17,minWidth:34,height:34},"&$sizeMedium":{width:"auto",padding:"0 16px",borderRadius:20,minWidth:40,height:40}},focusVisible:{},disabled:{},colorInherit:{color:"inherit"},sizeSmall:{width:40,height:40},sizeMedium:{width:48,height:48}}}),{name:"MuiFab"})(d)},931:(e,t,n)=>{"use strict";n.d(t,{A:()=>p});var i=n(215),s=n(237),a=n(228),o=n(382),r=n(932),c=n(235),l=n(653),d=n(439),u=a.forwardRef((function(e,t){e.checked;var n=e.classes,c=e.className,u=e.control,p=e.disabled,h=(e.inputRef,e.label),f=e.labelPlacement,g=void 0===f?"end":f,m=(e.name,e.onChange,e.value,(0,s.A)(e,["checked","classes","className","control","disabled","inputRef","label","labelPlacement","name","onChange","value"])),_=(0,r.A)(),w=p;void 0===w&&void 0!==u.props.disabled&&(w=u.props.disabled),void 0===w&&_&&(w=_.disabled);var v={disabled:w};return["checked","name","onChange","value","inputRef"].forEach((function(t){void 0===u.props[t]&&void 0!==e[t]&&(v[t]=e[t])})),a.createElement("label",(0,i.A)({className:(0,o.default)(n.root,c,"end"!==g&&n["labelPlacement".concat((0,d.A)(g))],w&&n.disabled),ref:t},m),a.cloneElement(u,v),a.createElement(l.A,{component:"span",className:(0,o.default)(n.label,w&&n.disabled)},h))}));const p=(0,c.A)((function(e){return{root:{display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,"&$disabled":{cursor:"default"}},labelPlacementStart:{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},labelPlacementTop:{flexDirection:"column-reverse",marginLeft:16},labelPlacementBottom:{flexDirection:"column",marginLeft:16},disabled:{},label:{"&$disabled":{color:e.palette.text.disabled}}}}),{name:"MuiFormControlLabel"})(u)},934:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var i=n(215),s=n(266),a=n(237),o=n(228),r=n(382),c=n(454),l=n(932),d=n(235),u=n(455),p=o.forwardRef((function(e,t){var n=e.autoFocus,d=e.checked,p=e.checkedIcon,h=e.classes,f=e.className,g=e.defaultChecked,m=e.disabled,_=e.icon,w=e.id,v=e.inputProps,b=e.inputRef,y=e.name,k=e.onBlur,x=e.onChange,E=e.onFocus,$=e.readOnly,S=e.required,C=e.tabIndex,A=e.type,z=e.value,O=(0,a.A)(e,["autoFocus","checked","checkedIcon","classes","className","defaultChecked","disabled","icon","id","inputProps","inputRef","name","onBlur","onChange","onFocus","readOnly","required","tabIndex","type","value"]),T=(0,c.A)({controlled:d,default:Boolean(g),name:"SwitchBase",state:"checked"}),N=(0,s.A)(T,2),P=N[0],j=N[1],D=(0,l.A)(),R=m;D&&void 0===R&&(R=D.disabled);var B="checkbox"===A||"radio"===A;return o.createElement(u.A,(0,i.A)({component:"span",className:(0,r.default)(h.root,f,P&&h.checked,R&&h.disabled),disabled:R,tabIndex:null,role:void 0,onFocus:function(e){E&&E(e),D&&D.onFocus&&D.onFocus(e)},onBlur:function(e){k&&k(e),D&&D.onBlur&&D.onBlur(e)},ref:t},O),o.createElement("input",(0,i.A)({autoFocus:n,checked:d,defaultChecked:g,className:h.input,disabled:R,id:B&&w,name:y,onChange:function(e){var t=e.target.checked;j(t),x&&x(e,t)},readOnly:$,ref:b,required:S,tabIndex:C,type:A,value:z},v)),P?p:_)}));const h=(0,d.A)({root:{padding:9},checked:{},disabled:{},input:{cursor:"inherit",position:"absolute",opacity:0,width:"100%",height:"100%",top:0,left:0,margin:0,padding:0,zIndex:1}},{name:"PrivateSwitchBase"})(p)},944:(e,t,n)=>{"use strict";var i=n(377),s=n(459);t.A=void 0;var a=s(n(228)),o=(0,i(n(460)).default)(a.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"}),"InsertDriveFileOutlined");t.A=o},945:(e,t,n)=>{"use strict";var i=n(377),s=n(459);t.A=void 0;var a=s(n(228)),o=(0,i(n(460)).default)(a.createElement("path",{d:"M10 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h5v2h2V1h-2v2zm0 15H5l5-6v6zm9-15h-5v2h5v13l-5-6v9h5c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"Compare");t.A=o},946:(e,t,n)=>{"use strict";var i=n(377),s=n(459);t.A=void 0;var a=s(n(228)),o=(0,i(n(460)).default)(a.createElement("path",{d:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"}),"Send");t.A=o},952:(e,t,n)=>{"use strict";n.d(t,{Kj:()=>de});var i=n(490),s=(n(489).Buffer,Object.defineProperty),a=e=>{throw TypeError(e)},o=(e,t,n)=>((e,t,n)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n),r=(e,t,n)=>t.has(e)||a("Cannot "+n),c=(e,t,n)=>(r(e,t,"read from private field"),n?n.call(e):t.get(e)),l=new Intl.Collator(0,{numeric:1}).compare;function d(e,t,n){return e=e.split("."),t=t.split("."),l(e[0],t[0])||l(e[1],t[1])||(t[2]=t.slice(2).join("."),(n=/[.-]/.test(e[2]=e.slice(2).join(".")))==/[.-]/.test(t[2])?l(e[2],t[2]):n?-1:1)}const u="host",p="queue/data",h="upload",f="login",g="config",m="This application is currently busy. Please try again. ",_="Connection errored out. ",w="Could not resolve app config. ",v="Space metadata could not be loaded. ",b="Not authorized to access this space. ",y="Invalid credentials. Could not login. ",k="Login credentials are required to access this space.",x="File system access is only available in Node.js environments",E="Root URL not found in client config";async function $(e,t,n){try{return(await(await fetch(`https://huggingface.co/api/spaces/${e}/jwt`,{headers:{Authorization:`Bearer ${t}`,...n?{Cookie:n}:{}}})).json()).token||!1}catch{return!1}}async function S(e){const t=this.options.hf_token?{Authorization:`Bearer ${this.options.hf_token}`}:{};if(t["Content-Type"]="application/json",typeof window<"u"&&window.gradio_config&&"http://localhost:9876"!==location.origin){if(window.gradio_config.current_page&&(e=e.substring(0,e.lastIndexOf("/"))),window.gradio_config.dev_mode){let n=D(e,this.deep_link?g+"?deep_link="+this.deep_link:g);const i=await this.fetch(n,{headers:t,credentials:"include"}),s=await C(i,e,!!this.options.auth);window.gradio_config={...s,current_page:window.gradio_config.current_page}}return window.gradio_config.root=e,{...window.gradio_config}}if(e){let n=D(e,this.deep_link?g+"?deep_link="+this.deep_link:g);return C(await this.fetch(n,{headers:t,credentials:"include"}),e,!!this.options.auth)}throw new Error(w)}async function C(e,t,n){var i,s;if(401===(null==e?void 0:e.status)&&!n){const t=await e.json(),n=null==(i=null==t?void 0:t.detail)?void 0:i.auth_message;throw new Error(n||k)}if(401===(null==e?void 0:e.status)&&n)throw new Error(y);if(200===(null==e?void 0:e.status)){let n=await e.json();return n.root=t,null==(s=n.dependencies)||s.forEach(((e,t)=>{void 0===e.id&&(e.id=t)})),n}if(401===(null==e?void 0:e.status))throw new Error(b);throw new Error(w)}async function A(){const{http_protocol:e,host:t}=await j(this.app_reference,this.options.hf_token);try{if(this.options.auth){const n=await z(e,t,this.options.auth,this.fetch,this.options.hf_token);n&&this.set_cookies(n)}}catch(e){throw Error(e.message)}}async function z(e,t,n,i,s){const a=new FormData;a.append("username",null==n?void 0:n[0]),a.append("password",null==n?void 0:n[1]);let o={};s&&(o.Authorization=`Bearer ${s}`);const r=await i(`${e}//${t}/${f}`,{headers:o,method:"POST",body:a,credentials:"include"});if(200===r.status)return r.headers.get("set-cookie");throw 401===r.status?new Error(y):new Error(v)}function O(e){if(e.startsWith("http")){const{protocol:t,host:n,pathname:i}=new URL(e);return{ws_protocol:"https:"===t?"wss":"ws",http_protocol:t,host:n+("/"!==i?i:"")}}return{ws_protocol:"wss",http_protocol:"https:",host:new URL(e).host}}const T=e=>{let t=[];return e.split(/,(?=\s*[^\s=;]+=[^\s=;]+)/).forEach((e=>{const[n,i]=e.split(";")[0].split("=");n&&i&&t.push(`${n.trim()}=${i.trim()}`)})),t},N=/^[a-zA-Z0-9_\-\.]+\/[a-zA-Z0-9_\-\.]+$/,P=/.*hf\.space\/{0,1}.*$/;async function j(e,t){const n={};t&&(n.Authorization=`Bearer ${t}`);const i=e.trim().replace(/\/$/,"");if(N.test(i))try{return{space_id:e,...O((await(await fetch(`https://huggingface.co/api/spaces/${i}/${u}`,{headers:n})).json()).host)}}catch{throw new Error(v)}if(P.test(i)){const{ws_protocol:e,http_protocol:t,host:n}=O(i);return{space_id:n.split("/")[0].replace(".hf.space",""),ws_protocol:e,http_protocol:t,host:n}}return{space_id:!1,...O(i)}}const D=(...e)=>{try{return e.reduce(((e,t)=>(e=e.replace(/\/+$/,""),t=t.replace(/^\/+/,""),new URL(t,e+"/").toString())))}catch{throw new Error("Invalid URL. A full URL path is required.")}};function R(e,t,n,i){if("Api"===t)return e.type;switch(null==e?void 0:e.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}return"JSONSerializable"===n||"StringSerializable"===n?"any":"ListStringSerializable"===n?"string[]":"Image"===t?"parameter"===i?"Blob | File | Buffer":"string":"FileSerializable"===n?"array"===(null==e?void 0:e.type)?"parameter"===i?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":"parameter"===i?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}":"GallerySerializable"===n?"parameter"===i?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]":void 0}function B(e,t){return"GallerySerializable"===t?"array of [file, label] tuples":"ListStringSerializable"===t?"array of strings":"FileSerializable"===t?"array of files or single file":null==e?void 0:e.description}function q(e,t){switch(e.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:!0,message:m,stage:"error",code:e.code,success:e.success}};case"heartbeat":return{type:"heartbeat"};case"unexpected_error":return{type:"unexpected_error",status:{queue:!0,message:e.message,session_not_found:e.session_not_found,stage:"error",success:!1}};case"broken_connection":return{type:"broken_connection",status:{queue:!0,message:e.message,stage:"error",success:!1}};case"estimation":return{type:"update",status:{queue:!0,stage:t||"pending",code:e.code,size:e.queue_size,position:e.rank,eta:e.rank_eta,success:e.success}};case"progress":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,progress_data:e.progress_data,success:e.success}};case"log":return{type:"log",data:e};case"process_generating":return{type:"generating",status:{queue:!0,message:e.success?null:e.output.error,stage:e.success?"generating":"error",code:e.code,progress_data:e.progress_data,eta:e.average_duration,changed_state_ids:e.success?e.output.changed_state_ids:void 0},data:e.success?e.output:null};case"process_streaming":return{type:"streaming",status:{queue:!0,message:e.output.error,stage:"streaming",time_limit:e.time_limit,code:e.code,progress_data:e.progress_data,eta:e.eta},data:e.output};case"process_completed":return"error"in e.output?{type:"update",status:{queue:!0,title:e.output.title,message:e.output.error,visible:e.output.visible,duration:e.output.duration,stage:"error",code:e.code,success:e.success}}:{type:"complete",status:{queue:!0,message:e.success?void 0:e.output.error,stage:e.success?"complete":"error",code:e.code,progress_data:e.progress_data,changed_state_ids:e.success?e.output.changed_state_ids:void 0},data:e.success?e.output:null};case"process_starts":return{type:"update",status:{queue:!0,stage:"pending",code:e.code,size:e.rank,position:0,success:e.success,eta:e.eta},original_msg:"process_starts"}}return{type:"none",status:{stage:"error",queue:!0}}}async function L(){if(this.api_info)return this.api_info;const{hf_token:e}=this.options,{config:t}=this,n={"Content-Type":"application/json"};if(e&&(n.Authorization=`Bearer ${e}`),t)try{let e,i;if(typeof window<"u"&&window.gradio_api_info)i=window.gradio_api_info;else{if(d((null==t?void 0:t.version)||"2.0.0","3.30")<0)e=await this.fetch("https://gradio-space-api-fetcher-v2.hf.space/api",{method:"POST",body:JSON.stringify({serialize:!1,config:JSON.stringify(t)}),headers:n,credentials:"include"});else{const i=D(t.root,this.api_prefix,"info");e=await this.fetch(i,{headers:n,credentials:"include"})}if(!e.ok)throw new Error(_);i=await e.json()}return"api"in i&&(i=i.api),i.named_endpoints["/predict"]&&!i.unnamed_endpoints[0]&&(i.unnamed_endpoints[0]=i.named_endpoints["/predict"]),function(e,t,n){const i={named_endpoints:{},unnamed_endpoints:{}};return Object.keys(e).forEach((s=>{("named_endpoints"===s||"unnamed_endpoints"===s)&&(i[s]={},Object.entries(e[s]).forEach((([e,{parameters:a,returns:o}])=>{var r,c,l,d;const u=(null==(r=t.dependencies.find((t=>t.api_name===e||t.api_name===e.replace("/",""))))?void 0:r.id)||n[e.replace("/","")]||-1,p=-1!==u?null==(c=t.dependencies.find((e=>e.id==u)))?void 0:c.types:{generator:!1,cancel:!1};if(-1!==u&&(null==(d=null==(l=t.dependencies.find((e=>e.id==u)))?void 0:l.inputs)?void 0:d.length)!==a.length){const e=t.dependencies.find((e=>e.id==u)).inputs.map((e=>{var n;return null==(n=t.components.find((t=>t.id===e)))?void 0:n.type}));try{e.forEach(((e,t)=>{if("state"===e){const e={component:"state",example:null,parameter_default:null,parameter_has_default:!0,parameter_name:null,hidden:!0};a.splice(t,0,e)}}))}catch(e){}}const h=(e,t,n,i)=>({...e,description:B(null==e?void 0:e.type,n),type:R(null==e?void 0:e.type,t,n,i)||""});i[s][e]={parameters:a.map((e=>h(e,null==e?void 0:e.component,null==e?void 0:e.serializer,"parameter"))),returns:o.map((e=>h(e,null==e?void 0:e.component,null==e?void 0:e.serializer,"return"))),type:p}})))})),i}(i,t,this.api_map)}catch(e){throw new Error("Could not get API info. "+e.message)}}async function I(e,t,n){var i;const s={};null!=(i=null==this?void 0:this.options)&&i.hf_token&&(s.Authorization=`Bearer ${this.options.hf_token}`);const a=[];let o;for(let i=0;i<t.length;i+=1e3){const r=t.slice(i,i+1e3),c=new FormData;r.forEach((e=>{c.append("files",e)}));try{const t=n?`${e}${this.api_prefix}/${h}?upload_id=${n}`:`${e}${this.api_prefix}/${h}`;o=await this.fetch(t,{method:"POST",body:c,headers:s,credentials:"include"})}catch(e){throw new Error(_+e.message)}if(!o.ok){const e=await o.text();return{error:`HTTP ${o.status}: ${e}`}}const l=await o.json();l&&a.push(...l)}return{files:a}}async function F(e,t,n,i){let s=(Array.isArray(e)?e:[e]).map((e=>e.blob));const a=s.filter((e=>e.size>(i??1/0)));if(a.length)throw new Error(`File size exceeds the maximum allowed size of ${i} bytes: ${a.map((e=>e.name)).join(", ")}`);return await Promise.all(await this.upload_files(t,s,n).then((async n=>{if(n.error)throw new Error(n.error);return n.files?n.files.map(((n,i)=>new U({...e[i],path:n,url:`${t}${this.api_prefix}/file=${n}`}))):[]})))}class U{constructor({path:e,url:t,orig_name:n,size:i,blob:s,is_stream:a,mime_type:r,alt_text:c,b64:l}){o(this,"path"),o(this,"url"),o(this,"orig_name"),o(this,"size"),o(this,"blob"),o(this,"is_stream"),o(this,"mime_type"),o(this,"alt_text"),o(this,"b64"),o(this,"meta",{_type:"gradio.FileData"}),this.path=e,this.url=t,this.orig_name=n,this.size=i,this.blob=t?void 0:s,this.is_stream=a,this.mime_type=r,this.alt_text=c,this.b64=l}}class M{constructor(e,t){o(this,"type"),o(this,"command"),o(this,"meta"),o(this,"fileData"),this.type="command",this.command=e,this.meta=t}}function W(e,t,n){for(;n.length>1;){const t=n.shift();if("string"!=typeof t&&"number"!=typeof t)throw new Error("Invalid key type");e=e[t]}const i=n.shift();if("string"!=typeof i&&"number"!=typeof i)throw new Error("Invalid key type");e[i]=t}async function H(e,t=void 0,n=[],i=!1,s=void 0){if(Array.isArray(e)){let a=[];return await Promise.all(e.map((async(o,r)=>{var c;let l=n.slice();l.push(String(r));const d=await H(e[r],i?(null==(c=null==s?void 0:s.parameters[r])?void 0:c.component)||void 0:t,l,!1,s);a=a.concat(d)}))),a}if(globalThis.Buffer&&e instanceof globalThis.Buffer||e instanceof Blob)return[{path:n,blob:new Blob([e]),type:t}];if("object"==typeof e&&null!==e){let t=[];for(const i of Object.keys(e)){const a=[...n,i],o=e[i];t=t.concat(await H(o,void 0,a,!1,s))}return t}return[]}function J(e,t,n,i,s=!1){if("input"===i&&!s)throw new Error("Invalid code path. Cannot skip state inputs for input.");if("output"===i&&s)return e;let a=[],o=0;const r="input"===i?t.inputs:t.outputs;for(let t=0;t<r.length;t++){const i=r[t],c=n.find((e=>e.id===i));if("state"!==(null==c?void 0:c.type)){const t=e[o];a.push(t),o++}else{if(!s){o++;continue}if(e.length===r.length){const t=e[o];a.push(t),o++}else a.push(null)}}return a}async function V(e,t,n){const i=this;await async function(e,t){var n,i;if(!(null==(n=e.config)?void 0:n.root)&&!(null==(i=e.config)?void 0:i.root_url))throw new Error(E);await G(e,t)}(i,t);const s=await H(t,void 0,[],!0,n);return(await Promise.all(s.map((async({path:t,blob:n,type:s})=>{if(!n)return{path:t,type:s};const a=await i.upload_files(e,[n]);return{path:t,file_url:a.files&&a.files[0],type:s,name:typeof File<"u"&&n instanceof File?null==n?void 0:n.name:void 0}})))).forEach((({path:e,file_url:n,type:i,name:s})=>{if("Gallery"===i)W(t,n,e);else if(n){const i=new U({path:n,orig_name:s});W(t,i,e)}})),t}async function G(e,t,n=[]){for(const i in t)t[i]instanceof M?await X(e,t,i):"object"==typeof t[i]&&null!==t[i]&&await G(e,t[i],[...n,i])}async function X(e,t,s){var a,o;let r=t[s];const c=(null==(a=e.config)?void 0:a.root)||(null==(o=e.config)?void 0:o.root_url);if(!c)throw new Error(E);try{let a,o;if(!(typeof i<"u"&&i.versions&&i.versions.node))throw new Error(x);{const e=await n.e(50).then(n.bind(n,2171));o=(await n.e(50).then(n.bind(n,2171))).resolve(i.cwd(),r.meta.path),a=await e.readFile(o)}const l=new Blob([a],{type:"application/octet-stream"}),d=await e.upload_files(c,[l]),u=d.files&&d.files[0];if(u){const e=new U({path:u,orig_name:r.meta.name||""});t[s]=e}}catch(e){}}async function K(e,t,n){const i={"Content-Type":"application/json"};this.options.hf_token&&(i.Authorization=`Bearer ${this.options.hf_token}`);try{var s=await this.fetch(e,{method:"POST",body:JSON.stringify(t),headers:{...i,...n},credentials:"include"})}catch{return[{error:_},500]}let a,o;try{a=await s.json(),o=s.status}catch(e){a={error:`Could not parse server response: ${e}`},o=500}return[a,o]}async function Z(e,t={}){let n=!1,i=!1;if(!this.config)throw new Error("Could not resolve app config");if("number"==typeof e)this.config.dependencies.find((t=>t.id==e));else{const t=e.replace(/^\//,"");this.config.dependencies.find((e=>e.id==this.api_map[t]))}return new Promise((async(s,a)=>{const o=this.submit(e,t,null,null,!0);let r;for await(const e of o)"data"===e.type&&(i&&s(r),n=!0,r=e),"status"===e.type&&("error"===e.stage&&a(e),"complete"===e.stage&&(i=!0,n&&s(r)))}))}async function Q(e,t,n){let i,s,a="subdomain"===t?`https://huggingface.co/api/spaces/by-subdomain/${e}`:`https://huggingface.co/api/spaces/${e}`;try{if(i=await fetch(a),s=i.status,200!==s)throw new Error;i=await i.json()}catch{return void n({status:"error",load_status:"error",message:"Could not get space status. ",detail:"NOT_FOUND"})}if(!i||200!==s)return;const{runtime:{stage:o},id:r}=i;switch(o){case"STOPPED":case"SLEEPING":n({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:o}),setTimeout((()=>{Q(e,t,n)}),1e3);break;case"PAUSED":n({status:"paused",load_status:"error",message:"This space has been paused by the author. If you would like to try this demo, consider duplicating the space.",detail:o,discussions_enabled:await te(r)});break;case"RUNNING":case"RUNNING_BUILDING":n({status:"running",load_status:"complete",message:"Space is running.",detail:o});break;case"BUILDING":n({status:"building",load_status:"pending",message:"Space is building...",detail:o}),setTimeout((()=>{Q(e,t,n)}),1e3);break;case"APP_STARTING":n({status:"starting",load_status:"pending",message:"Space is starting...",detail:o}),setTimeout((()=>{Q(e,t,n)}),1e3);break;default:n({status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:o,discussions_enabled:await te(r)})}}typeof i<"u"&&i.versions&&i.versions.node;const Y=async(e,t)=>{let n=0;return new Promise((i=>{Q(e,N.test(e)?"space_name":"subdomain",(s=>{t(s),"running"===s.status||"error"===s.status||"paused"===s.status||"space_error"===s.status?i():("sleeping"===s.status||"building"===s.status)&&(n<12?(n++,setTimeout((()=>{Y(e,t).then(i)}),5e3)):i())}))}))},ee=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/;async function te(e){try{const t=await fetch(`https://huggingface.co/api/spaces/${e}/discussions`,{method:"HEAD"}),n=t.headers.get("x-error-message");return!(!t.ok||n&&ee.test(n))}catch{return!1}}const ne=["cpu-basic","cpu-upgrade","cpu-xl","t4-small","t4-medium","a10g-small","a10g-large","a10g-largex2","a10g-largex4","a100-large","zero-a10g","h100","h100x8"];var ie;class se extends TransformStream{constructor(e={allowCR:!1}){var t,n;super({transform:(t,n)=>{for(t=c(this,ie)+t;;){const i=t.indexOf("\n"),s=e.allowCR?t.indexOf("\r"):-1;if(-1!==s&&s!==t.length-1&&(-1===i||i-1>s)){n.enqueue(t.slice(0,s)),t=t.slice(s+1);continue}if(-1===i)break;const a="\r"===t[i-1]?i-1:i;n.enqueue(t.slice(0,a)),t=t.slice(i+1)}((e,t,n)=>{r(e,t,"write to private field"),t.set(e,n)})(this,ie,t)},flush:t=>{if(""===c(this,ie))return;const n=e.allowCR&&c(this,ie).endsWith("\r")?c(this,ie).slice(0,-1):c(this,ie);t.enqueue(n)}}),t=this,(n=ie).has(t)?a("Cannot add the same private member more than once"):n instanceof WeakSet?n.add(t):n.set(t,"")}}function ae(e){let t=/[:]\s*/.exec(e),n=t&&t.index;if(n)return[e.substring(0,n),e.substring(n+t[0].length)]}function oe(e,t,n){e.get(t)||e.set(t,n)}async function re(){let{event_callbacks:e,unclosed_events:t,pending_stream_messages:n,stream_status:i,config:s,jwt:a}=this;const o=this;if(!s)throw new Error("Could not resolve app config");i.open=!0;let r=null,c=new URLSearchParams({session_hash:this.session_hash}).toString(),l=new URL(`${s.root}${this.api_prefix}/${p}?${c}`);a&&l.searchParams.set("__sign",a),r=this.stream(l),r&&(r.onmessage=async function(a){let r=JSON.parse(a.data);if("close_stream"===r.msg)return void ce(i,o.abort_controller);const c=r.event_id;if(c)if(e[c]&&s){"process_completed"===r.msg&&["sse","sse_v1","sse_v2","sse_v2.1","sse_v3"].includes(s.protocol)&&t.delete(c);let n=e[c];typeof window<"u"&&typeof document<"u"?setTimeout(n,0,r):n(r)}else n[c]||(n[c]=[]),n[c].push(r);else await Promise.all(Object.keys(e).map((t=>e[t](r))))},r.onerror=async function(t){await Promise.all(Object.keys(e).map((t=>e[t]({msg:"broken_connection",message:_}))))})}function ce(e,t){e&&(e.open=!1,null==t||t.abort())}function le(e,t={},n,i,s){var a;try{let o=function(e){(s||K[e.type])&&u(e)},r=function(){for(ee=!0;ne.length>0;)ne.shift()({value:void 0,done:!0})},c=function(e){ne.length>0?ne.shift()(e):te.push(e)},l=function(e){c(function(e){return{then:(t,n)=>n(e)}}(e)),r()},u=function(e){c({value:e,done:!1})},h=function(){return te.length>0?Promise.resolve(te.shift()):new Promise((e=>ne.push(e)))};const{hf_token:f}=this.options,{fetch:g,app_reference:w,config:v,session_hash:b,api_info:y,api_map:k,stream_status:x,pending_stream_messages:E,pending_diff_streams:$,event_callbacks:S,unclosed_events:C,post_data:A,options:z,api_prefix:O}=this,T=this;if(!y)throw new Error("No API found");if(!v)throw new Error("Could not resolve app config");let N,P,{fn_index:D,endpoint_info:R,dependency:B}=function(e,t,n,i){let s,a,o;if("number"==typeof t)s=t,a=e.unnamed_endpoints[s],o=i.dependencies.find((e=>e.id==t));else{const r=t.replace(/^\//,"");s=n[r],a=e.named_endpoints[t.trim()],o=i.dependencies.find((e=>e.id==n[r]))}if("number"!=typeof s)throw new Error("There is no endpoint matching that name of fn_index matching that number.");return{fn_index:s,endpoint_info:a,dependency:o}}(y,e,k,v),L=((e=[],t)=>{const n=t?t.parameters:[];if(Array.isArray(e))return t&&n.length>0&&(e.length,n.length),e;const i=[],s=Object.keys(e);return n.forEach(((t,n)=>{if(e.hasOwnProperty(t.parameter_name))i[n]=e[t.parameter_name];else{if(!t.parameter_has_default)throw new Error(`No value provided for required parameter: ${t.parameter_name}`);i[n]=t.parameter_default}})),s.forEach((e=>{if(!n.some((t=>t.parameter_name===e)))throw new Error(`Parameter \`${e}\` is not a valid keyword argument. Please refer to the API for usage.`)})),i.forEach(((e,t)=>{if(void 0===e&&!n[t].parameter_has_default)throw new Error(`No value provided for required parameter: ${n[t].parameter_name}`)})),i})(t,R),I=v.protocol??"ws",F="",U=()=>F;const M="number"==typeof e?"/predict":e;let W,H=null,V=!1,G={},X=typeof window<"u"&&typeof document<"u"?new URLSearchParams(window.location.search).toString():"";const K=(null==(a=null==z?void 0:z.events)?void 0:a.reduce(((e,t)=>(e[t]=!0,e)),{}))||{};async function Z(){let e={},t={};"ws"===I?(N&&0===N.readyState?N.addEventListener("open",(()=>{N.close()})):N.close(),e={fn_index:D,session_hash:b}):(e={event_id:H},t={event_id:H,session_hash:b,fn_index:D});try{if(!v)throw new Error("Could not resolve app config");"event_id"in t&&await g(`${v.root}${O}/cancel`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(t)}),await g(`${v.root}${O}/reset`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)})}catch{}}const Q=async e=>{await this._resolve_heartbeat(e)};async function Y(e){if(!v)return;let t=e.render_id;v.components=[...v.components.filter((e=>e.props.rendered_in!==t)),...e.components],v.dependencies=[...v.dependencies.filter((e=>e.rendered_in!==t)),...e.dependencies];const n=v.components.some((e=>"state"===e.type)),i=v.dependencies.some((e=>e.targets.some((e=>"unload"===e[1]))));v.connect_heartbeat=n||i,await Q(v),o({type:"render",data:e,endpoint:M,fn_index:D})}this.handle_blob(v.root,L,R).then((async e=>{var t;if(W={data:J(e,B,v.components,"input",!0)||[],event_data:n,fn_index:D,trigger_id:i},function(e,t){var n,i;let s=null==(i=null==(n=null==t?void 0:t.dependencies)?void 0:n.find((t=>t.id==e)))?void 0:i.queue;return null!=s?!s:!t.enable_queue}(D,v))o({type:"status",endpoint:M,stage:"pending",queue:!1,fn_index:D,time:new Date}),A(`${v.root}${O}/run${M.startsWith("/")?M:`/${M}`}${X?"?"+X:""}`,{...W,session_hash:b}).then((([e,t])=>{const s=e.data;200==t?(o({type:"data",endpoint:M,fn_index:D,data:J(s,B,v.components,"output",z.with_null_state),time:new Date,event_data:n,trigger_id:i}),e.render_config&&Y(e.render_config),o({type:"status",endpoint:M,fn_index:D,stage:"complete",eta:e.average_duration,queue:!1,time:new Date})):o({type:"status",stage:"error",endpoint:M,fn_index:D,message:e.error,queue:!1,time:new Date})})).catch((e=>{o({type:"status",stage:"error",message:e.message,endpoint:M,fn_index:D,queue:!1,time:new Date})}));else if("ws"==I){const{ws_protocol:e,host:t}=await j(w,f);o({type:"status",stage:"pending",queue:!0,endpoint:M,fn_index:D,time:new Date});let s=new URL(`${e}://${function(e,t){return t.startsWith("http://")||t.startsWith("https://")?e:e+t}(t,v.root)}/queue/join${X?"?"+X:""}`);this.jwt&&s.searchParams.set("__sign",this.jwt),N=new WebSocket(s),N.onclose=e=>{e.wasClean||o({type:"status",stage:"error",broken:!0,message:_,queue:!0,endpoint:M,fn_index:D,time:new Date})},N.onmessage=function(e){const t=JSON.parse(e.data),{type:s,status:a,data:r}=q(t,G[D]);if("update"===s&&a&&!V)o({type:"status",endpoint:M,fn_index:D,time:new Date,...a}),"error"===a.stage&&N.close();else{if("hash"===s)return void N.send(JSON.stringify({fn_index:D,session_hash:b}));"data"===s?N.send(JSON.stringify({...W,session_hash:b})):"complete"===s?V=a:"log"===s?o({type:"log",title:r.title,log:r.log,level:r.level,endpoint:M,duration:r.duration,visible:r.visible,fn_index:D}):"generating"===s&&o({type:"status",time:new Date,...a,stage:null==a?void 0:a.stage,queue:!0,endpoint:M,fn_index:D})}r&&(o({type:"data",time:new Date,data:J(r.data,B,v.components,"output",z.with_null_state),endpoint:M,fn_index:D,event_data:n,trigger_id:i}),V&&(o({type:"status",time:new Date,...V,stage:null==a?void 0:a.stage,queue:!0,endpoint:M,fn_index:D}),N.close()))},d(v.version||"2.0.0","3.6")<0&&addEventListener("open",(()=>N.send(JSON.stringify({hash:b}))))}else if("sse"==I){o({type:"status",stage:"pending",queue:!0,endpoint:M,fn_index:D,time:new Date});var s=new URLSearchParams({fn_index:D.toString(),session_hash:b}).toString();let e=new URL(`${v.root}${O}/${p}?${X?X+"&":""}${s}`);if(this.jwt&&e.searchParams.set("__sign",this.jwt),P=this.stream(e),!P)return Promise.reject(new Error("Cannot connect to SSE endpoint: "+e.toString()));P.onmessage=async function(e){const t=JSON.parse(e.data),{type:s,status:a,data:c}=q(t,G[D]);if("update"===s&&a&&!V)o({type:"status",endpoint:M,fn_index:D,time:new Date,...a}),"error"===a.stage&&(null==P||P.close(),r());else if("data"===s){let[e,t]=await A(`${v.root}${O}/queue/data`,{...W,session_hash:b,event_id:H});200!==t&&(o({type:"status",stage:"error",message:_,queue:!0,endpoint:M,fn_index:D,time:new Date}),null==P||P.close(),r())}else"complete"===s?V=a:"log"===s?o({type:"log",title:c.title,log:c.log,level:c.level,endpoint:M,duration:c.duration,visible:c.visible,fn_index:D}):("generating"===s||"streaming"===s)&&o({type:"status",time:new Date,...a,stage:null==a?void 0:a.stage,queue:!0,endpoint:M,fn_index:D});c&&(o({type:"data",time:new Date,data:J(c.data,B,v.components,"output",z.with_null_state),endpoint:M,fn_index:D,event_data:n,trigger_id:i}),V&&(o({type:"status",time:new Date,...V,stage:null==a?void 0:a.stage,queue:!0,endpoint:M,fn_index:D}),null==P||P.close(),r()))}}else if("sse_v1"==I||"sse_v2"==I||"sse_v2.1"==I||"sse_v3"==I){o({type:"status",stage:"pending",queue:!0,endpoint:M,fn_index:D,time:new Date});let e="";typeof window<"u"&&typeof document<"u"&&(e=null==(t=null==window?void 0:window.location)?void 0:t.hostname);const n=e.includes(".dev.")?`https://moon-${e.split(".")[1]}.dev.spaces.huggingface.tech`:"https://huggingface.co";(typeof window<"u"&&typeof document<"u"&&window.parent!=window&&window.supports_zerogpu_headers?function(e,t){return new Promise(((e,n)=>{const i=new MessageChannel;i.port1.onmessage=({data:t})=>{i.port1.close(),e(t)},window.parent.postMessage("zerogpu-headers",t,[i.port2])}))}(0,n):Promise.resolve(null)).then((e=>A(`${v.root}${O}/queue/join?${X}`,{...W,session_hash:b},e))).then((async([e,t])=>{if(503===t)o({type:"status",stage:"error",message:m,queue:!0,endpoint:M,fn_index:D,time:new Date});else if(422===t)o({type:"status",stage:"error",message:e.detail,queue:!0,endpoint:M,fn_index:D,code:"validation_error",time:new Date}),r();else if(200!==t)o({type:"status",stage:"error",broken:!1,message:e.detail,queue:!0,endpoint:M,fn_index:D,time:new Date});else{H=e.event_id,F=H;let t=async function(e){try{const{type:t,status:n,data:i,original_msg:s}=q(e,G[D]);if("heartbeat"==t)return;if("update"===t&&n&&!V)o({type:"status",endpoint:M,fn_index:D,time:new Date,original_msg:s,...n});else if("complete"===t)V=n;else if("unexpected_error"==t||"broken_connection"==t){const e="broken_connection"===t;o({type:"status",stage:"error",message:(null==n?void 0:n.message)||"An Unexpected Error Occurred!",queue:!0,endpoint:M,broken:e,session_not_found:null==n?void 0:n.session_not_found,fn_index:D,time:new Date})}else{if("log"===t)return void o({type:"log",title:i.title,log:i.log,level:i.level,endpoint:M,duration:i.duration,visible:i.visible,fn_index:D});("generating"===t||"streaming"===t)&&(o({type:"status",time:new Date,...n,stage:null==n?void 0:n.stage,queue:!0,endpoint:M,fn_index:D}),i&&"stream"!==B.connection&&["sse_v2","sse_v2.1","sse_v3"].includes(I)&&function(e,t,n){e[t]?n.data.forEach(((i,s)=>{let a=function(e,t){return t.forEach((([t,n,i])=>{e=function(e,t,n,i){if(0===t.length){if("replace"===n)return i;if("append"===n)return e+i;throw new Error(`Unsupported action: ${n}`)}let s=e;for(let e=0;e<t.length-1;e++)s=s[t[e]];const a=t[t.length-1];switch(n){case"replace":s[a]=i;break;case"append":s[a]+=i;break;case"add":Array.isArray(s)?s.splice(Number(a),0,i):s[a]=i;break;case"delete":Array.isArray(s)?s.splice(Number(a),1):delete s[a];break;default:throw new Error(`Unknown action: ${n}`)}return e}(e,n,t,i)})),e}(e[t][s],i);e[t][s]=a,n.data[s]=a})):(e[t]=[],n.data.forEach(((n,i)=>{e[t][i]=n})))}($,H,i))}i&&(o({type:"data",time:new Date,data:J(i.data,B,v.components,"output",z.with_null_state),endpoint:M,fn_index:D}),i.render_config&&await Y(i.render_config),V&&(o({type:"status",time:new Date,...V,stage:null==n?void 0:n.stage,queue:!0,endpoint:M,fn_index:D}),r())),("complete"===(null==n?void 0:n.stage)||"error"===(null==n?void 0:n.stage))&&(S[H]&&delete S[H],H in $&&delete $[H])}catch(e){o({type:"status",stage:"error",message:"An Unexpected Error Occurred!",queue:!0,endpoint:M,fn_index:D,time:new Date}),["sse_v2","sse_v2.1","sse_v3"].includes(I)&&(ce(x,T.abort_controller),x.open=!1,r())}};H in E&&(E[H].forEach((e=>t(e))),delete E[H]),S[H]=t,C.add(H),x.open||await this.open_stream()}}))}}));let ee=!1;const te=[],ne=[],ie={[Symbol.asyncIterator]:()=>ie,next:h,throw:async e=>(l(e),h()),return:async()=>(r(),h()),cancel:Z,event_id:U};return ie}catch(se){throw se}}ie=new WeakMap;class de{constructor(e,t={events:["data"]}){var n;o(this,"app_reference"),o(this,"options"),o(this,"deep_link",null),o(this,"config"),o(this,"api_prefix",""),o(this,"api_info"),o(this,"api_map",{}),o(this,"session_hash",Math.random().toString(36).substring(2)),o(this,"jwt",!1),o(this,"last_status",{}),o(this,"cookies",null),o(this,"stream_status",{open:!1}),o(this,"closed",!1),o(this,"pending_stream_messages",{}),o(this,"pending_diff_streams",{}),o(this,"event_callbacks",{}),o(this,"unclosed_events",new Set),o(this,"heartbeat_event",null),o(this,"abort_controller",null),o(this,"stream_instance",null),o(this,"current_payload"),o(this,"ws_map",{}),o(this,"view_api"),o(this,"upload_files"),o(this,"upload"),o(this,"handle_blob"),o(this,"post_data"),o(this,"submit"),o(this,"predict"),o(this,"open_stream"),o(this,"resolve_config"),o(this,"resolve_cookies"),this.app_reference=e,this.deep_link=(null==(n=t.query_params)?void 0:n.deep_link)||null,t.events||(t.events=["data"]),this.options=t,this.current_payload={},this.view_api=L.bind(this),this.upload_files=I.bind(this),this.handle_blob=V.bind(this),this.post_data=K.bind(this),this.submit=le.bind(this),this.predict=Z.bind(this),this.open_stream=re.bind(this),this.resolve_config=S.bind(this),this.resolve_cookies=A.bind(this),this.upload=F.bind(this),this.fetch=this.fetch.bind(this),this.handle_space_success=this.handle_space_success.bind(this),this.stream=this.stream.bind(this)}get_url_config(e=null){if(!this.config)throw new Error(w);null===e&&(e=window.location.href);const t=e=>e.replace(/^\/+|\/+$/g,"");let n,i=t(new URL(this.config.root).pathname),s=t(new URL(e).pathname);return n=s.startsWith(i)?t(s.substring(i.length)):"",this.get_page_config(n)}get_page_config(e){if(!this.config)throw new Error(w);let t=this.config;return e in t.page||(e=""),{...t,current_page:e,layout:t.page[e].layout,components:t.components.filter((n=>t.page[e].components.includes(n.id))),dependencies:this.config.dependencies.filter((n=>t.page[e].dependencies.includes(n.id)))}}fetch(e,t){const n=new Headers((null==t?void 0:t.headers)||{});if(this&&this.cookies&&n.append("Cookie",this.cookies),this&&this.options.headers)for(const e in this.options.headers)n.append(e,this.options.headers[e]);return fetch(e,{...t,headers:n})}stream(e){const t=new Headers;if(this&&this.cookies&&t.append("Cookie",this.cookies),this&&this.options.headers)for(const e in this.options.headers)t.append(e,this.options.headers[e]);return this&&this.options.hf_token&&t.append("Authorization",`Bearer ${this.options.hf_token}`),this.abort_controller=new AbortController,this.stream_instance=function(e,t={}){const n={close:()=>{},onerror:null,onmessage:null,onopen:null,readyState:0,url:e.toString(),withCredentials:!1,CONNECTING:0,OPEN:1,CLOSED:2,addEventListener:()=>{throw new Error("Method not implemented.")},dispatchEvent:()=>{throw new Error("Method not implemented.")},removeEventListener:()=>{throw new Error("Method not implemented.")}};return async function(e,t){let n=new Request(e,t);oe(n.headers,"Accept","text/event-stream"),oe(n.headers,"Content-Type","application/json");let i=await fetch(n);if(!i.ok)throw i;return async function*(e,t){if(!e.body)return;let n,i,s=function(e){let t=new TextDecoderStream,n=new se({allowCR:!0});return e.pipeThrough(t).pipeThrough(n)}(e.body),a=s.getReader();for(;;){if(t&&t.aborted)return a.cancel();if(n=await a.read(),n.done)return;if(!n.value){i&&(yield i),i=void 0;continue}let[e,s]=ae(n.value)||[];e&&("data"===e?(i||(i={}),i[e]=i[e]?i[e]+"\n"+s:s):"event"===e?(i||(i={}),i[e]=s):"id"===e?(i||(i={}),i[e]=+s||s):"retry"===e&&(i||(i={}),i[e]=+s||void 0))}}(i,n.signal)}(e,t).then((async e=>{n.readyState=n.OPEN;try{for await(const t of e)n.onmessage&&n.onmessage(t);n.readyState=n.CLOSED}catch(e){n.onerror&&n.onerror(e),n.readyState=n.CLOSED}})).catch((e=>{n.onerror&&n.onerror(e),n.readyState=n.CLOSED})),n}(e.toString(),{credentials:"include",headers:t,signal:this.abort_controller.signal}),this.stream_instance}async init(){var e;this.options.auth&&await this.resolve_cookies(),await this._resolve_config().then((({config:e})=>this._resolve_heartbeat(e))),this.api_info=await this.view_api(),this.api_map=function(e){let t={};return e.forEach((({api_name:e,id:n})=>{e&&(t[e]=n)})),t}((null==(e=this.config)?void 0:e.dependencies)||[])}async _resolve_heartbeat(e){if(e&&(this.config=e,this.api_prefix=e.api_prefix||"",this.config&&this.config.connect_heartbeat&&this.config.space_id&&this.options.hf_token&&(this.jwt=await $(this.config.space_id,this.options.hf_token,this.cookies))),e.space_id&&this.options.hf_token&&(this.jwt=await $(e.space_id,this.options.hf_token)),this.config&&this.config.connect_heartbeat){const e=new URL(`${this.config.root}${this.api_prefix}/heartbeat/${this.session_hash}`);this.jwt&&e.searchParams.set("__sign",this.jwt),this.heartbeat_event||(this.heartbeat_event=this.stream(e))}}static async connect(e,t={events:["data"]}){const n=new this(e,t);return t.session_hash&&(n.session_hash=t.session_hash),await n.init(),n}async reconnect(){const e=new URL(`${this.config.root}${this.api_prefix}/app_id`);let t;try{const n=await this.fetch(e);if(!n.ok)throw new Error;t=(await n.json()).app_id}catch{return"broken"}return t!==this.config.app_id?"changed":"connected"}close(){this.closed=!0,ce(this.stream_status,this.abort_controller)}set_current_payload(e){this.current_payload=e}static async duplicate(e,t={events:["data"]}){return async function(e,t){const{hf_token:n,private:i,hardware:s,timeout:a,auth:o}=t;if(s&&!ne.includes(s))throw new Error(`Invalid hardware type provided. Valid types are: ${ne.map((e=>`"${e}"`)).join(",")}.`);const{http_protocol:r,host:c}=await j(e,n);let l=null;if(o){const e=await z(r,c,o,fetch);e&&(l=T(e))}const d={Authorization:`Bearer ${n}`,"Content-Type":"application/json",...l?{Cookie:l.join("; ")}:{}},u=(await(await fetch("https://huggingface.co/api/whoami-v2",{headers:d})).json()).name,p=e.split("/")[1],h={repository:`${u}/${p}`};let f;i&&(h.private=!0);try{s||(f=await async function(e,t){const n={};t&&(n.Authorization=`Bearer ${t}`);try{const t=await fetch(`https://huggingface.co/api/spaces/${e}/runtime`,{headers:n});if(200!==t.status)throw new Error("Space hardware could not be obtained.");const{hardware:i}=await t.json();return i.current}catch(e){throw new Error(e.message)}}(e,n))}catch(e){throw Error(v+e.message)}const g=s||f||"cpu-basic";h.hardware=g;try{const i=await fetch(`https://huggingface.co/api/spaces/${e}/duplicate`,{method:"POST",headers:d,body:JSON.stringify(h)});if(409===i.status)try{return await de.connect(`${u}/${p}`,t)}catch(e){throw e}else if(200!==i.status)throw new Error(i.statusText);const s=await i.json();return await async function(e,t,n){const i={};n&&(i.Authorization=`Bearer ${n}`);const s={seconds:t};try{const t=await fetch(`https://huggingface.co/api/spaces/${e}/sleeptime`,{method:"POST",headers:{"Content-Type":"application/json",...i},body:JSON.stringify(s)});if(200!==t.status)throw new Error("Could not set sleep timeout on duplicated Space. Please visit *ADD HF LINK TO SETTINGS* to set a timeout manually to reduce billing charges.");return await t.json()}catch(e){throw new Error(e.message)}}(`${u}/${p}`,a||300,n),await de.connect(function(e){const t=e.match(/https:\/\/huggingface.co\/spaces\/([^/]+\/[^/]+)/);if(t)return t[1]}(s.url),t)}catch(e){throw new Error(e)}}(e,t)}async _resolve_config(){const{http_protocol:e,host:t,space_id:n}=await j(this.app_reference,this.options.hf_token),{status_callback:i}=this.options;let s;n&&i&&await Y(n,i);try{let n=`${e}//${t}`;if(s=await this.resolve_config(n),!s)throw new Error(w);return this.config_success(s)}catch(e){if(!n||!i)throw i&&i({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),Error(e);Q(n,N.test(n)?"space_name":"subdomain",this.handle_space_success)}}async config_success(e){if(this.config=e,this.api_prefix=e.api_prefix||"",this.config.auth_required)return this.prepare_return_obj();try{this.api_info=await this.view_api()}catch(e){}return this.prepare_return_obj()}async handle_space_success(e){var t;if(!this)throw new Error(w);const{status_callback:n}=this.options;if(n&&n(e),"running"===e.status)try{if(this.config=await this._resolve_config(),this.api_prefix=(null==(t=null==this?void 0:this.config)?void 0:t.api_prefix)||"",!this.config)throw new Error(w);return await this.config_success(this.config)}catch(e){throw n&&n({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),e}}async component_server(e,t,n){var i;if(!this.config)throw new Error(w);const s={},{hf_token:a}=this.options,{session_hash:o}=this;a&&(s.Authorization=`Bearer ${this.options.hf_token}`);let r,c,l=this.config.components.find((t=>t.id===e));if(r=null!=(i=null==l?void 0:l.props)&&i.root_url?l.props.root_url:this.config.root,"binary"in n){c=new FormData;for(const e in n.data)"binary"!==e&&c.append(e,n.data[e]);c.set("component_id",e.toString()),c.set("fn_name",t),c.set("session_hash",o)}else c=JSON.stringify({data:n,component_id:e,fn_name:t,session_hash:o}),s["Content-Type"]="application/json";a&&(s.Authorization=`Bearer ${a}`);try{const e=await this.fetch(`${r}${this.api_prefix}/component_server/`,{method:"POST",body:c,headers:s,credentials:"include"});if(!e.ok)throw new Error("Could not connect to component server: "+e.statusText);return await e.json()}catch(e){}}set_cookies(e){this.cookies=T(e).join("; ")}prepare_return_obj(){return{config:this.config,predict:this.predict,submit:this.submit,view_api:this.view_api,component_server:this.component_server}}async connect_ws(e){return new Promise(((t,n)=>{let i;try{i=new WebSocket(e)}catch{return void(this.ws_map[e]="failed")}this.ws_map[e]="pending",i.onopen=()=>{this.ws_map[e]=i,t()},i.onerror=n=>{this.close_ws(e),this.ws_map[e]="failed",t()},i.onclose=()=>{this.ws_map[e]="closed"},i.onmessage=e=>{}}))}async send_ws_message(e,t){if(e in this.ws_map){if("pending"===this.ws_map[e]||"closed"===this.ws_map[e]||"failed"===this.ws_map[e])return}else await this.connect_ws(e);const n=this.ws_map[e];n instanceof WebSocket?n.send(JSON.stringify(t)):this.post_data(e,t)}async close_ws(e){if(e in this.ws_map){const t=this.ws_map[e];t instanceof WebSocket&&(t.close(),delete this.ws_map[e])}}}},956:(e,t,n)=>{"use strict";var i=n(4),s=n(84).some;i({target:"Array",proto:!0,forced:!n(105)("some")},{some:function(e){return s(this,e,arguments.length>1?arguments[1]:void 0)}})},957:(e,t,n)=>{"use strict";n(958)},958:(e,t,n)=>{"use strict";var i=n(4),s=n(179),a=n(31),o=n(47),r=n(205);i({target:"Iterator",proto:!0,real:!0},{some:function(e){o(this),a(e);var t=r(this),n=0;return s(t,(function(t,i){if(e(t,n++))return i()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},959:(e,t,n)=>{"use strict";var i=n(459),s=n(377);t.Ay=void 0;var a=s(n(378)),o=s(n(389)),r=i(n(228)),c=(s(n(392)),s(n(382))),l=(n(391),s(n(960))),d=s(n(376)),u=r.forwardRef((function(e,t){var n=e.disableUnderline,i=e.classes,s=e.fullWidth,d=void 0!==s&&s,u=e.inputComponent,p=void 0===u?"input":u,h=e.multiline,f=void 0!==h&&h,g=e.type,m=void 0===g?"text":g,_=(0,o.default)(e,["disableUnderline","classes","fullWidth","inputComponent","multiline","type"]);return r.createElement(l.default,(0,a.default)({classes:(0,a.default)({},i,{root:(0,c.default)(i.root,!n&&i.underline),underline:null}),fullWidth:d,inputComponent:p,multiline:f,ref:t,type:m},_))}));u.muiName="Input";var p=(0,d.default)((function(e){var t="light"===e.palette.type,n=t?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",i=t?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.09)";return{root:{position:"relative",backgroundColor:i,borderTopLeftRadius:e.shape.borderRadius,borderTopRightRadius:e.shape.borderRadius,transition:e.transitions.create("background-color",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),"&:hover":{backgroundColor:t?"rgba(0, 0, 0, 0.13)":"rgba(255, 255, 255, 0.13)","@media (hover: none)":{backgroundColor:i}},"&$focused":{backgroundColor:t?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.09)"},"&$disabled":{backgroundColor:t?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)"}},colorSecondary:{"&$underline:after":{borderBottomColor:e.palette.secondary.main}},underline:{"&:after":{borderBottom:"2px solid ".concat(e.palette.primary.main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},"&$focused:after":{transform:"scaleX(1)"},"&$error:after":{borderBottomColor:e.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:"1px solid ".concat(n),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},"&:hover:before":{borderBottom:"1px solid ".concat(e.palette.text.primary)},"&$disabled:before":{borderBottomStyle:"dotted"}},focused:{},disabled:{},adornedStart:{paddingLeft:12},adornedEnd:{paddingRight:12},error:{},marginDense:{},multiline:{padding:"27px 12px 10px","&$marginDense":{paddingTop:23,paddingBottom:6}},input:{padding:"27px 12px 10px","&:-webkit-autofill":{WebkitBoxShadow:"light"===e.palette.type?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:"light"===e.palette.type?null:"#fff",caretColor:"light"===e.palette.type?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},inputMarginDense:{paddingTop:23,paddingBottom:6},inputHiddenLabel:{paddingTop:18,paddingBottom:19,"&$inputMarginDense":{paddingTop:10,paddingBottom:11}},inputMultiline:{padding:0},inputAdornedStart:{paddingLeft:0},inputAdornedEnd:{paddingRight:0}}}),{name:"MuiFilledInput"})(u);t.Ay=p},960:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>i.A});var i=n(925)},961:(e,t)=>{var n;!function(){"use strict";var i={}.hasOwnProperty;function s(){for(var e=[],t=0;t<arguments.length;t++){var n=arguments[t];if(n){var a=typeof n;if("string"===a||"number"===a)e.push(n);else if(Array.isArray(n)){if(n.length){var o=s.apply(null,n);o&&e.push(o)}}else if("object"===a){if(n.toString!==Object.prototype.toString&&!n.toString.toString().includes("[native code]")){e.push(n.toString());continue}for(var r in n)i.call(n,r)&&n[r]&&e.push(r)}}}return e.join(" ")}e.exports?(s.default=s,e.exports=s):void 0===(n=function(){return s}.apply(t,[]))||(e.exports=n)}()},973:(e,t,n)=>{"use strict";var i=n(377),s=n(459);t.A=void 0;var a=s(n(228)),o=(0,i(n(460)).default)(a.createElement("path",{d:"M5.2496 8.0688l2.83-2.8268 14.134 14.15-2.83 2.8268zM9.4857 3.8272l2.828-2.8288 5.6576 5.656-2.828 2.8288zM.9989 12.3147l2.8284-2.8284L9.484 15.143l-2.8284 2.8284zM1 21h12v2H1z"}),"Gavel");t.A=o},974:(e,t,n)=>{"use strict";var i=n(377),s=n(459);t.A=void 0;var a=s(n(228)),o=(0,i(n(460)).default)(a.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");t.A=o},1007:(e,t,n)=>{"use strict";n.d(t,{A:()=>v});var i=n(215),s=n(237),a=n(228),o=n(382),r=n(934),c=n(462);const l=(0,c.A)(a.createElement("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),d=(0,c.A)(a.createElement("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox");var u=n(264);const p=(0,c.A)(a.createElement("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox");var h=n(439),f=n(235),g=a.createElement(d,null),m=a.createElement(l,null),_=a.createElement(p,null),w=a.forwardRef((function(e,t){var n=e.checkedIcon,c=void 0===n?g:n,l=e.classes,d=e.color,u=void 0===d?"secondary":d,p=e.icon,f=void 0===p?m:p,w=e.indeterminate,v=void 0!==w&&w,b=e.indeterminateIcon,y=void 0===b?_:b,k=e.inputProps,x=e.size,E=void 0===x?"medium":x,$=(0,s.A)(e,["checkedIcon","classes","color","icon","indeterminate","indeterminateIcon","inputProps","size"]),S=v?y:f,C=v?y:c;return a.createElement(r.A,(0,i.A)({type:"checkbox",classes:{root:(0,o.default)(l.root,l["color".concat((0,h.A)(u))],v&&l.indeterminate),checked:l.checked,disabled:l.disabled},color:u,inputProps:(0,i.A)({"data-indeterminate":v},k),icon:a.cloneElement(S,{fontSize:void 0===S.props.fontSize&&"small"===E?E:S.props.fontSize}),checkedIcon:a.cloneElement(C,{fontSize:void 0===C.props.fontSize&&"small"===E?E:C.props.fontSize}),ref:t},$))}));const v=(0,f.A)((function(e){return{root:{color:e.palette.text.secondary},checked:{},disabled:{},indeterminate:{},colorPrimary:{"&$checked":{color:e.palette.primary.main,"&:hover":{backgroundColor:(0,u.X4)(e.palette.primary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}},colorSecondary:{"&$checked":{color:e.palette.secondary.main,"&:hover":{backgroundColor:(0,u.X4)(e.palette.secondary.main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"&$disabled":{color:e.palette.action.disabled}}}}),{name:"MuiCheckbox"})(w)}}]);