"use strict";(self.webpackChunkpixagram_io=self.webpackChunkpixagram_io||[]).push([["default-src_js_components_NewPost_js"],{32163:(e,t,a)=>{a.d(t,{A:()=>I});a(42762),a(62953);var i=a(17402),n=a(5556),r=a.n(n),o=a(8728),s=a(7160),l=a(88016),p=a(38306),c=a(33615),u=a(79626),d=a(69312),h=a(95652),f=a(32485),m=a.n(f);const _=["allowDuplicates","alwaysShowPlaceholder","blurBehavior","children","chipRenderer","classes","className","clearInputValueOnChange","dataSource","dataSourceConfig","defaultValue","delayBeforeAdd","disabled","disableUnderline","error","filter","FormHelperTextProps","fullWidth","fullWidthInput","helperText","id","InputProps","inputRef","InputLabelProps","inputValue","label","newChipKeyCodes","newChipKeys","onBeforeAdd","onAdd","onBlur","onDelete","onChange","onFocus","onKeyDown","onKeyPress","onKeyUp","onUpdateInput","placeholder","readOnly","required","rootRef","value","variant","endAdornment"];function g(){return g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)({}).hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},g.apply(null,arguments)}function b(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function v(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?b(Object(a),!0).forEach((function(t){y(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):b(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function y(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const w={standard:o.A,filled:s.Ay,outlined:l.A},C=8,A=46,x=37,E=39;class S extends i.default.PureComponent{constructor(e){super(e),y(this,"state",{chips:[],errorText:void 0,focusedChip:null,inputValue:"",isClean:!0,isFocused:!1,chipsUpdated:!1,prevPropsValue:[]}),y(this,"focus",(()=>{this.actualInput.focus(),null!=this.state.focusedChip&&this.setState({focusedChip:null})})),y(this,"handleInputBlur",(e=>{this.props.onBlur&&this.props.onBlur(e),this.setState({isFocused:!1}),null!=this.state.focusedChip&&this.setState({focusedChip:null});const t=e.target.value;let a;switch(this.props.blurBehavior){case"add-or-clear":a={clearInputOnFail:!0};case"add":if(this.props.delayBeforeAdd){const e=(this.props.value||this.state.chips).length;this.inputBlurTimeout=setTimeout((()=>{const i=(this.props.value||this.state.chips).length;e===i?this.handleAddChip(t,a):this.clearInput()}),150)}else this.handleAddChip(t,a);break;case"clear":this.clearInput()}})),y(this,"handleInputFocus",(e=>{this.setState({isFocused:!0}),this.props.onFocus&&this.props.onFocus(e)})),y(this,"handleKeyDown",(e=>{const{focusedChip:t}=this.state;if(this._keyPressed=!1,this._preventChipCreation=!1,this.props.onKeyDown&&(this.props.onKeyDown(e),e.isDefaultPrevented()))return;const a=this.props.value||this.state.chips;if(this.props.newChipKeyCodes.indexOf(e.keyCode)>=0||this.props.newChipKeys.indexOf(e.key)>=0){!1!==this.handleAddChip(e.target.value)&&e.preventDefault()}else switch(e.keyCode){case C:""===e.target.value&&(null!=t?(this.handleDeleteChip(a[t],t),t>0&&this.setState({focusedChip:t-1})):this.setState({focusedChip:a.length-1}));break;case A:""===e.target.value&&null!=t&&(this.handleDeleteChip(a[t],t),t<=a.length-1&&this.setState({focusedChip:t}));break;case x:null==t&&""===e.target.value&&a.length?this.setState({focusedChip:a.length-1}):null!=t&&t>0&&this.setState({focusedChip:t-1});break;case E:null!=t&&t<a.length-1?this.setState({focusedChip:t+1}):this.setState({focusedChip:null});break;default:this.setState({focusedChip:null})}})),y(this,"handleKeyUp",(e=>{!this._preventChipCreation&&(this.props.newChipKeyCodes.indexOf(e.keyCode)>=0||this.props.newChipKeys.indexOf(e.key)>=0)&&this._keyPressed?this.clearInput():this.updateInput(e.target.value),this.props.onKeyUp&&this.props.onKeyUp(e)})),y(this,"handleKeyPress",(e=>{this._keyPressed=!0,this.props.onKeyPress&&this.props.onKeyPress(e)})),y(this,"handleUpdateInput",(e=>{null==this.props.inputValue&&this.updateInput(e.target.value),this.props.onUpdateInput&&this.props.onUpdateInput(e)})),y(this,"setActualInputRef",(e=>{this.actualInput=e,this.props.inputRef&&this.props.inputRef(e)})),e.defaultValue&&(this.state.chips=e.defaultValue),this.labelRef=i.default.createRef(),this.input=i.default.createRef()}componentDidMount(){"outlined"===this.props.variant&&(this.labelNode=i.default.findDOMNode(this.labelRef.current),this.forceUpdate())}componentWillUnmount(){clearTimeout(this.inputBlurTimeout)}static getDerivedStateFromProps(e,t){let a=null;return e.value&&e.value.length!==t.prevPropsValue.length&&(a={prevPropsValue:e.value},e.clearInputValueOnChange&&(a.inputValue="")),e.clearInputValueOnChange&&e.value&&e.value.length!==t.prevPropsValue.length&&(a={prevPropsValue:e.value,inputValue:""}),e.disabled&&(a=v(v({},a),{},{focusedChip:null})),!t.chipsUpdated&&e.defaultValue&&(a=v(v({},a),{},{chips:e.defaultValue})),a}blur(){this.input&&this.actualInput.blur()}handleAddChip(e,t){if(this.props.onBeforeAdd&&!this.props.onBeforeAdd(e))return this._preventChipCreation=!0,null!=t&&t.clearInputOnFail&&this.clearInput(),!1;this.clearInput();const a=this.props.value||this.state.chips;return this.props.dataSourceConfig?("string"==typeof e&&(e={[this.props.dataSourceConfig.text]:e,[this.props.dataSourceConfig.value]:e}),!this.props.allowDuplicates&&a.some((t=>t[this.props.dataSourceConfig.value]===e[this.props.dataSourceConfig.value]))||(this.props.value&&this.props.onAdd?this.props.onAdd(e):this.updateChips([...this.state.chips,e])),!0):e.trim().length>0&&((this.props.allowDuplicates||-1===a.indexOf(e))&&(this.props.value&&this.props.onAdd?this.props.onAdd(e):this.updateChips([...this.state.chips,e])),!0)}handleDeleteChip(e,t){if(this.props.value)this.props.onDelete&&this.props.onDelete(e,t);else{const e=this.state.chips.slice();if(e.splice(t,1)){let a=this.state.focusedChip;this.state.focusedChip===t?a=null:this.state.focusedChip>t&&(a=this.state.focusedChip-1),this.updateChips(e,{focusedChip:a})}}}updateChips(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setState(v({chips:e,chipsUpdated:!0},t)),this.props.onChange&&this.props.onChange(e)}clearInput(){this.updateInput("")}updateInput(e){this.setState({inputValue:e})}render(){const e=this.props,{allowDuplicates:t,alwaysShowPlaceholder:a,blurBehavior:n,children:r,chipRenderer:o=k,classes:s,className:l,clearInputValueOnChange:c,dataSource:u,dataSourceConfig:f,defaultValue:b,delayBeforeAdd:v,disabled:y,disableUnderline:C,error:A,filter:x,FormHelperTextProps:E,fullWidth:S,fullWidthInput:I,helperText:P,id:O,InputProps:z={},inputRef:D,InputLabelProps:U={},inputValue:T,label:B,newChipKeyCodes:q,newChipKeys:j,onBeforeAdd:R,onAdd:M,onBlur:F,onDelete:K,onChange:V,onFocus:W,onKeyDown:N,onKeyPress:L,onKeyUp:$,onUpdateInput:X,placeholder:H,readOnly:Z,required:Q,rootRef:Y,value:G,variant:J,endAdornment:ee}=e,te=function(e,t){if(null==e)return{};var a,i,n=function(e,t){if(null==e)return{};var a={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.includes(i))continue;a[i]=e[i]}return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)a=r[i],t.includes(a)||{}.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}(e,_),ae=G||this.state.chips,ie=null!=T?T:this.state.inputValue,ne=(this.props.value||ie).length>0||ie.length>0,re=null!=U.shrink?U.shrink:null!=B&&(ne||this.state.isFocused||ae.length>0),oe=ae.map(((e,t)=>{const a=f?e[f.value]:e;return o({value:a,text:f?e[f.text]:e,chip:e,isDisabled:!!y,isReadOnly:Z,isFocused:this.state.focusedChip===t,handleClick:()=>this.setState({focusedChip:t}),handleDelete:()=>this.handleDeleteChip(e,t),className:s.chip},t)})),se={};"outlined"===J&&(se.notched=re,se.labelWidth=re&&this.labelNode&&this.labelNode.offsetWidth||0),"standard"!==J?se.startAdornment=i.default.createElement(i.default.Fragment,null,oe):z.disableUnderline=!0,se.endAdornment=ee;const le=w[J];return i.default.createElement(d.A,g({ref:Y,fullWidth:S,className:m()(l,s.root,{[s.marginDense]:"dense"===te.margin}),error:A,required:ae.length>0?void 0:Q,onClick:this.focus,disabled:y,variant:J},te),B&&i.default.createElement(p.A,g({htmlFor:O,classes:{root:m()(s[J],s.label),shrink:s.labelShrink},shrink:re,focused:this.state.isFocused,variant:J,ref:this.labelRef,required:Q},U),B),i.default.createElement("div",{className:m()(s[J],s.chipContainer,{[s.focused]:this.state.isFocused,[s.underline]:!C&&"standard"===J,[s.disabled]:y,[s.labeled]:null!=B,[s.error]:A})},"standard"===J&&oe,i.default.createElement(le,g({ref:this.input,classes:{input:m()(s.input,s[J]),root:m()(s.inputRoot,s[J])},id:O,value:ie,onChange:this.handleUpdateInput,onKeyDown:this.handleKeyDown,onKeyPress:this.handleKeyPress,onKeyUp:this.handleKeyUp,onFocus:this.handleInputFocus,onBlur:this.handleInputBlur,inputRef:this.setActualInputRef,disabled:y,fullWidth:I,placeholder:!ne&&(re||null==B)||a?H:null,readOnly:Z},z,se))),P&&i.default.createElement(h.A,g({},E,{className:E?m()(E.className,s.helperText):s.helperText}),P))}}S.propTypes={endAdornment:r().node,allowDuplicates:r().bool,alwaysShowPlaceholder:r().bool,blurBehavior:r().oneOf(["clear","add","add-or-clear","ignore"]),chipRenderer:r().func,clearInputValueOnChange:r().bool,dataSource:r().array,dataSourceConfig:r().shape({text:r().string.isRequired,value:r().string.isRequired}),defaultValue:r().array,delayBeforeAdd:r().bool,disabled:r().bool,disableUnderline:r().bool,FormHelperTextProps:r().object,fullWidth:r().bool,fullWidthInput:r().bool,helperText:r().node,InputLabelProps:r().object,InputProps:r().object,inputRef:r().func,inputValue:r().string,label:r().node,newChipKeyCodes:r().arrayOf(r().number),newChipKeys:r().arrayOf(r().string),onAdd:r().func,onBeforeAdd:r().func,onChange:r().func,onDelete:r().func,onUpdateInput:r().func,placeholder:r().string,readOnly:r().bool,value:r().array,variant:r().oneOf(["outlined","standard","filled"])},S.defaultProps={allowDuplicates:!1,blurBehavior:"clear",clearInputValueOnChange:!1,delayBeforeAdd:!1,disableUnderline:!1,newChipKeyCodes:[13],newChipKeys:["Enter"],variant:"standard"};const I=(0,u.default)((e=>{const t="light"===e.palette.type,a=t?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return{root:{},inputRoot:{display:"inline-flex",flexWrap:"wrap",flex:1,marginTop:0,minWidth:70,"&$outlined,&$filled":{boxSizing:"border-box"},"&$outlined":{paddingTop:14},"&$filled":{paddingTop:28}},input:{display:"inline-block",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",appearance:"none",WebkitTapHighlightColor:"rgba(0,0,0,0)",float:"left",flex:1},chipContainer:{display:"flex",flexFlow:"row wrap",cursor:"text",marginBottom:-2,minHeight:40,"&$labeled&$standard":{marginTop:18}},outlined:{"& input":{height:16,paddingTop:4,paddingBottom:12,marginTop:4,marginBottom:4}},standard:{},filled:{"& input":{height:22,marginBottom:4,marginTop:4,paddingTop:0},"$marginDense & input":{height:26}},labeled:{},label:{top:4,"&$outlined&:not($labelShrink)":{top:2,"$marginDense &":{top:5}},"&$filled&:not($labelShrink)":{top:15,"$marginDense &":{top:20}}},labelShrink:{top:0},helperText:{marginBottom:-20},focused:{},disabled:{},underline:{"&:after":{borderBottom:"2px solid ".concat(e.palette.primary[t?"dark":"light"]),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:e.transitions.create("transform",{duration:e.transitions.duration.shorter,easing:e.transitions.easing.easeOut}),pointerEvents:"none"},"&$focused:after":{transform:"scaleX(1)"},"&$error:after":{borderBottomColor:e.palette.error.main,transform:"scaleX(1)"},"&:before":{borderBottom:"1px solid ".concat(a),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:e.transitions.create("border-bottom-color",{duration:e.transitions.duration.shorter}),pointerEvents:"none"},"&:hover:not($disabled):not($focused):not($error):before":{borderBottom:"2px solid ".concat(e.palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(a)}},"&$disabled:before":{borderBottomStyle:"dotted"}},error:{"&:after":{backgroundColor:e.palette.error.main,transform:"scaleX(1)"}},chip:{margin:"0 8px 8px 0",float:"left"},marginDense:{}}}),{name:"WAMuiChipInput"})(S),k=(e,t)=>{let{value:a,text:n,isFocused:r,isDisabled:o,isReadOnly:s,handleClick:l,handleDelete:p,className:u}=e;return i.default.createElement(c.A,{key:t,className:u,style:{pointerEvents:o||s?"none":void 0,backgroundColor:r?"rgb(96, 96, 96)":void 0},onClick:l,onDelete:p,label:n})}},40497:(e,t,a)=>{a.a(e,(async(e,i)=>{try{a.d(t,{A:()=>D});a(54743),a(11745),a(21489),a(22134),a(75044),a(28845),a(373),a(62953),a(3296),a(27208),a(48408);var n=a(17402),r=a(79626),o=a(52706),s=a(65816),l=a(68016),p=a(96746),c=a(39870),u=a(54392),d=a(8728),h=a(69113),f=a(83182),m=a(69312),_=a(15776),g=a(94422),b=a(72572),v=a(44041),y=a(44385),w=a(34274),C=a(69232),A=a(32163),x=a(95834),E=a(40024),S=e([w]);function I(e,t,a){return(t=k(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function k(e){var t=P(e,"string");return"symbol"==typeof t?t:t+""}function P(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}w=(S.then?(await S)():S)[0],await(0,E.Ay)();const O=e=>({dropZone:{width:"100%",height:"100%",minHeight:"384px",border:"2px dashed #666",textAlign:"center",verticalAlign:"middle",backgroundColor:"transparent",transition:"all 225ms cubic-bezier(0.4, 0, 0.2, 1) 225ms"},dropZoneActive:{width:"100%",height:"100%",minHeight:"384px",border:"2px solid #666",textAlign:"center",verticalAlign:"middle",backgroundColor:"rgba(255, 255, 255, 0.07)",transition:"all 225ms cubic-bezier(0.4, 0, 0.2, 1) 25ms"},whiteDialog:{backgroundColor:"#fff !important",color:"#000 !important",boxShadow:"0px 11px 15px -7px rgb(255 255 255 / 20%), 0px 24px 38px 3px rgb(255 255 255 / 14%), 0px 9px 46px 8px rgb(255 255 255 / 12%) !important","& .MuiButton-textPrimary":{color:"#222 !important","&:hover":{color:"#000 !important"}},"& .MuiButton-containedPrimary":{color:"#fff !important",backgroundColor:"#000 !important","&:hover":{color:"#ddd !important",backgroundColor:"#222 !important"}},"& .MuiRadio-colorPrimary.Mui-checked, & .MuiCheckbox-colorPrimary.Mui-checked, & .MuiRadio-colorSecondary.Mui-checked":{color:"#000 !important"},"& .MuiRadio-root, & .MuiFormLabel-root.Mui-focused, .MuiTypography-root":{color:"#000 !important"},"& .MuiSlider-root":{color:"#000 !important"},"& span.MuiSlider-valueLabel > span > span":{color:"#fff !important"}},inputImage:{margin:"0px 0px -4px 0px",borderRadius:"12px",width:"100%",filter:"grayscale(1) contrast(.8) brightness(0.55) opacity(0.65) blur(8px)",transition:"filter 400ms cubic-bezier(0.4, 0, 0.2, 1) 25ms !important",animationName:"$opacity-create",animationTimingFunction:"ease-in-out",animationDuration:"2400ms",animationFillMode:"both",animationDelay:"1200ms",animationDirection:"alternate",animationIterationCount:"infinite","@global":{"@keyframes opacity-create":{"0%":{opacity:"0.666"},"100%":{opacity:"1.000"}}},"&:hover":{filter:"grayscale(0.15) contrast(.8) brightness(0.6) opacity(0.7) blur(0px)"},"&::after":{content:"''",position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"linear-gradient(to top, black, transparent)"}}});class z extends n.PureComponent{constructor(e){var t;super(e),t=this,I(this,"_resetProps",(()=>{try{URL.revokeObjectURL(this.state._input_file_url)}catch(e){}this.setState({_drop_ref:null,_preferred_size:"M",_title:"",_currentStep:0,_totalStep:3,_drag_file:{},_cache:{},_preview:{},_preview_kb:0,_previews:[],_canvas:{},_offscreen_canvas:{},_base64:"",_style:0,_dropzone_active:!1,_message:"We maintains privacy and doesn't store uploaded images.",_close_confirm_close_open:!1,_quantize_dialog_open:!1,_quantize_downscale:4,_quantize_colors:64,process:{name:"upload file",start:0,finish:0}},this.forceUpdate)})),I(this,"_setTags",(e=>{this.setState({_tags:e.target.value.toString()},this.forceUpdate)})),I(this,"_drop_start",(e=>{e.preventDefault(),e.stopPropagation();const t=this.state._dropzone_active;this.setState({_dropzone_active:!0},(()=>{t||this.forceUpdate()}))})),I(this,"_drop_end",(e=>{e.preventDefault(),e.stopPropagation();const t=this.state._dropzone_active;this.setState({_dropzone_active:!1},(()=>{t&&this.forceUpdate()}))})),I(this,"_trigger_message",(e=>{this.setState({_message:e},this.forceUpdate)})),I(this,"_handle_file_upload",(async e=>{"dataTransfer"in e&&e.dataTransfer.files.length>0&&(e.preventDefault(),e.stopPropagation());const t=(e.target||{}).files||(e.srcElement||{}).files||(e.currentTarget||{}).files||((e.path||[])[0]||{}).files||(e.dataTransfer||{}).files||[],a=t[0]||null;let i=null;for(let e=0;e<t.length;e++)i=t[e],i.type.startsWith("image/")&&(e=t.length);if(null===i&&null===a);else if(null!==i){Boolean("image/png"===i.type)||i.type;const e=await(0,w.E)(i,512,512,160);if(e instanceof ImageData)this._trigger_message("The image appears to be already optimized!"),this.setState({_previews:[{name:"default",imageData:e}],_title:"",_currentStep:1,process:{name:"upload file",start:0,finish:0}},(()=>{this.forceUpdate((()=>{this._set_size()}))}));else{try{URL.revokeObjectURL(this.state._input_file_url)}catch(e){}const e=URL.createObjectURL(i);this.setState({_input_file_url:e,_use_ai_open:!0,_input_file:i},this.forceUpdate)}}})),I(this,"_setTitle",(e=>{this.setState({_title:e.target.value},this.forceUpdate)})),I(this,"_set_process",((e,t,a)=>{const i=setInterval(this.forceUpdate.bind(this),250),n=setTimeout((()=>{this.state.process._interval===i&&clearInterval(this.state.process._interval)}),a-t);this.setState({process:{name:e,start:t,finish:a,_interval:i,_timout:n}},(()=>{this.forceUpdate()}))})),I(this,"_handle_size_change",(e=>{this.setState({_preferred_size:e.target.value},(()=>{this._set_size()}))})),I(this,"_handle_style_change",(e=>{this.setState({_style:parseInt(e.target.value)},(()=>{this.forceUpdate()}))})),I(this,"_set_canvas_ref",(e=>{if(void 0===e)return this._set_size();if(null==e)return this._set_size();if(void 0===e.width)return this._set_size();if(null==e.width)return this._set_size();if("function"==typeof e.getContext){var t=e;t.context=e.getContext("2d"),this.setState({_canvas:t},(()=>{this._set_size()}))}})),I(this,"_set_size",(()=>{this.state._previews.forEach((e=>{1!==this.state._previews.length&&e.name.toUpperCase()!==this.state._preferred_size.toUpperCase()||this.setState({_preview:e.imageData},(()=>{this.state._canvas.width=this.state._preview.width,this.state._canvas.height=this.state._preview.height,(0,C.A)((()=>Promise.all([a.e("default-src_js_utils_encodeImage_js"),a.e("default-src_js_utils_png_quant_js")]).then(a.bind(a,15656)))).then((e=>{let{encodeIMG:t}=e;t(this.state._preview,"WEBP",!0).then((e=>{this.setState({_base64:e},(()=>{this.forceUpdate((()=>{this.state._canvas.context.putImageData(this.state._preview,0,0)}))}))}))}))}))}))})),I(this,"download_artwork",(()=>{let e=document.createElement("a");e.download="Pixagram.webp",e.href=this.state._base64,e.click(),e.remove()})),I(this,"_set_drop_ref",(e=>{null!=e&&this.setState({_drop_ref:e},(()=>{this.state._drop_ref.addEventListener("drop",this._handle_file_upload.bind(this)),this.state._drop_ref.addEventListener("dragenter",this._drop_start.bind(this)),this.state._drop_ref.addEventListener("dragover",this._drop_start.bind(this)),this.state._drop_ref.addEventListener("dragleave",this._drop_end.bind(this)),this.state._drop_ref.addEventListener("dragend",this._drop_end.bind(this))}))})),I(this,"_backOrCancel",(e=>{parseInt(this.state._currentStep)<=1?e?this.close_confirm():this.setState({_close_confirm_close_open:!0},this.forceUpdate):this.setState({_currentStep:parseInt(this.state._currentStep)-1},this.forceUpdate)})),I(this,"request_close",(()=>{this.setState({_close_confirm_close_open:!0},this.forceUpdate)})),I(this,"_nextOrFinish",(()=>{2===parseInt(this.state._currentStep)?(this._resetProps(),this.props.onClose()):this.setState({_currentStep:parseInt(this.state._currentStep)+1},this.forceUpdate)})),I(this,"_open_link",(e=>{window.open(e,"_blank")})),I(this,"close_confirm_close",(()=>{this.setState({_close_confirm_close_open:!1},(()=>{this.forceUpdate()}))})),I(this,"close_use_ai",(function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.setState({_use_ai_open:!1,_use_ai:e},(()=>{t.forceUpdate((async()=>{const a=await(0,w.z)(t.state._input_file,1028,1028,void 0,t._trigger_message,t._set_process,e);t.setState({_previews:a.artworks,_cache:a.artwork,_title:a.prompt,_currentStep:1,process:{name:"upload file",start:0,finish:0}},(()=>{t.forceUpdate((()=>{t._set_size()}))}))}))}))})),I(this,"close_confirm",(()=>{this.setState({_close_confirm_close_open:!1},(()=>{this.forceUpdate((()=>{this._resetProps(),this.props.onClose()}))}))})),I(this,"_set_quantize_preview_canvas_ref",(e=>{e&&this.state._quantize_preview_canvas!==e&&this.setState({_quantize_preview_canvas:e},(()=>{this._update_quantize_preview(),this.forceUpdate()}))})),I(this,"_open_quantize_dialog",(()=>{this.setState({_quantize_dialog_open:!0,_quantize_downscale:4,_quantize_colors:64},(()=>{this.forceUpdate()}))})),I(this,"_close_quantize_dialog",(e=>{if(e){const e=this.quantizeAndResize(this.state._preview,this.state._quantize_downscale,this.state._quantize_colors);this.setState({_preview:e,_quantize_dialog_open:!1,_currentStep:this.state._currentStep+1},(()=>{this.state._canvas&&this.state._canvas.context&&e&&(this.state._canvas.width=e.width,this.state._canvas.height=e.height,this.state._canvas.context.putImageData(e,0,0)),this.forceUpdate()}))}else this.setState({_quantize_dialog_open:!1},(()=>{this.forceUpdate()}))})),I(this,"_handle_downscale_change",((e,t)=>{this.setState({_quantize_downscale:t},(()=>{this._debounced_quantize_update(),this.forceUpdate()}))})),I(this,"_handle_colors_change",((e,t)=>{this.setState({_quantize_colors:t},(()=>{this._debounced_quantize_update(),this.forceUpdate()}))})),I(this,"_debounced_quantize_update",(()=>{this.debounceTimeout&&clearTimeout(this.debounceTimeout),this.debounceTimeout=setTimeout((()=>{this._update_quantize_preview()}),300)})),I(this,"_update_quantize_preview",(()=>{const e=this.state._quantize_preview_canvas;if(!e)return;const t=this.quantizeAndResize(this.state._cache,this.state._quantize_downscale,this.state._quantize_colors);if(t&&e.getContext){e.width=t.width,e.height=t.height;const a=e.getContext("2d");a.clearRect(0,0,t.width,t.height),a.putImageData(t,0,0)}})),I(this,"quantizeAndResize",((e,t,a)=>{const i=new E.Cf(new Uint8Array(e.data),e.width,e.height),n=i.process(t,a),[r,o]=i.get_processed_dimensions(t);return new ImageData(new Uint8ClampedArray(n),parseInt(r),parseInt(o))})),this.state={classes:e.classes,keepMounted:e.keepMounted||!1,open:e.open,_drop_ref:null,_preferred_size:"M",_title:"",_currentStep:0,_totalStep:3,_drag_file:{},_cache:{},_preview:{},_preview_kb:0,_previews:[],_canvas:{},_offscreen_canvas:{},_base64:"",_style:0,_use_ai:!1,_use_ai_open:!1,_input_file:{},_input_file_url:"",_dropzone_active:!1,_tags:[],_message:"We maintains privacy and doesn't store uploaded images.",_close_confirm_close_open:!1,_quantize_dialog_open:!1,_quantize_downscale:4,_quantize_colors:64,_quantize_preview_canvas:{},_quantize_debounce_timer:null,process:{name:"upload file",start:0,finish:0}},this.debounceTimeout=null}shouldComponentUpdate(e,t,a){return!1}componentWillReceiveProps(e){this.setState(e,(()=>{this.forceUpdate()}))}render(){const{classes:e,_title:t,_preferred_size:a,_currentStep:i,_totalStep:r,open:w,keepMounted:C,_preview:E,_dropzone_active:S,process:I,_base64:k,_tags:P,_previews:O,_message:z,_close_confirm_close_open:D,_use_ai_open:U,_use_ai:T,_style:B,_input_file_url:q,_quantize_dialog_open:j,_quantize_downscale:R,_quantize_colors:M}=this.state,{name:F,start:K,finish:V}=I;Math.round(i/r*100);let W=null,N=V-K,L=Date.now()-K,$=L/N,X=N>L,H=((k||"").length||0)/1e3*3/4;switch(i.toString()){case"0":W=n.createElement("div",{ref:this._set_drop_ref},n.createElement("div",{style:{borderRadius:"12px"},className:S?e.dropZoneActive:e.dropZone},n.createElement(x.A,{in:q,timeout:300},n.createElement("img",{src:q,className:e.inputImage+" pixelated",alt:"Input Image"})),n.createElement(d.A,{onChange:this._handle_file_upload,accept:"image/*",style:{display:"none",position:"absolute"},id:"button-file-dialog-secondary",type:"file"}),n.createElement(x.A,{in:!0,timeout:600},n.createElement("div",{style:{pointerEvents:X||"upload file"!==F?"none":"auto",transform:"translate(-50%, -50%)",top:"50%",left:"50%",position:"absolute",display:"inline"}},n.createElement(x.A,{in:!0,timeout:600},n.createElement(p.A,{disabled:X||"upload file"!==F,component:"label",htmlFor:"button-file-dialog-secondary",onClick:this._handle_file_upload},n.createElement("span",{style:{fontWeight:"bold",fontSize:"24px",verticalAlign:"super",color:"#999",marginRight:"16px"}},F||"Upload Image"),X||"upload file"!==F?n.createElement(h.A,{position:"relative",display:"inline-flex"},n.createElement(f.A,{variant:X?"determinate":"indeterminate",color:"#ffffff",value:Math.round(100*$)}),n.createElement(h.A,{top:0,left:0,bottom:0,right:0,position:"absolute",display:"flex",alignItems:"center",justifyContent:"center"},n.createElement(u.A,{variant:"caption",component:"div",color:"textSecondary"},X?"".concat(Math.round(Math.min(100*$,100)),"%"):"wait"))):n.createElement(y.A,{style:{color:"#666"}}))),n.createElement(x.A,{in:!0,timeout:900},n.createElement("p",{style:{textAlign:"center",color:"#a7a7a7"}},z))))));break;case"1":W=n.createElement("div",{noValidate:!0,autoComplete:"off",style:{position:"relative"}},n.createElement(m.A,{component:"fieldset",style:{padding:"8px 16px 64px 16px",position:"absolute",background:"linear-gradient(180deg, #101010cf 20%, #10101075 60%, #10101000 90%)",width:"100%",top:"0px"}},1===(O||0).length?n.createElement(x.A,{in:!0,timeout:600},n.createElement("p",null,"Your artwork is already optimized for pixel art")):n.createElement(o.A,{row:!0,defaultValue:"top","aria-label":"size",name:"SIZE",color:"primary",value:a,onChange:this._handle_size_change},n.createElement(x.A,{in:!0,timeout:200},n.createElement(_.A,{value:"XS",control:n.createElement(g.A,null),label:"XS"})),n.createElement(x.A,{in:!0,timeout:400},n.createElement(_.A,{value:"S",control:n.createElement(g.A,null),label:"S"})),n.createElement(x.A,{in:!0,timeout:600},n.createElement(_.A,{value:"M",control:n.createElement(g.A,null),label:"M"})),n.createElement(x.A,{in:!0,timeout:800},n.createElement(_.A,{value:"L",control:n.createElement(g.A,null),label:"L"})),n.createElement(x.A,{in:!0,timeout:1e3},n.createElement(_.A,{value:"XL",control:n.createElement(g.A,null),label:"XL"})))),n.createElement("div",{className:"pixelated",style:{width:"100%"}},n.createElement("canvas",{style:{borderRadius:"12px",width:"100%"},ref:this._set_canvas_ref,width:E.width+"px",height:E.height+"px"})),n.createElement("div",{style:{padding:"64px 8px 16px 8px",textAlign:"right",position:"absolute",background:"linear-gradient(0deg, #101010cf 20%, #10101075 60%, #10101000 90%)",width:"100%",bottom:"0px"}},n.createElement(x.A,{in:!0,timeout:600},n.createElement(p.A,{variant:"text",color:"#ffffff88",onClick:this._open_quantize_dialog},"QUANTIZE")),n.createElement(x.A,{in:!0,timeout:800},n.createElement(p.A,{variant:"text",color:"#ffffff88",onClick:this.download_artwork},"DOWNLOAD (",H.toFixed(2)," kB)")),n.createElement(x.A,{in:!0,timeout:1e3},n.createElement(p.A,{variant:"text",color:"#ffffff88",onClick:()=>this._open_link("https://pixa.pics/")},"OPEN EDITOR"))));break;case"2":W=n.createElement(x.A,{in:!0,timeout:300},n.createElement("div",{noValidate:!0,autoComplete:"off"},n.createElement(b.A,{style:{marginTop:12},value:t,fullWidth:!0,label:"Title",variant:"outlined",onChange:this._setTitle}),n.createElement(b.A,{style:{marginTop:24,marginBottom:24},label:"Content",multiline:!0,rows:1,defaultValue:k,variant:"filled",disabled:!0,fullWidth:!0}),n.createElement(b.A,{style:{marginTop:24,marginBottom:24},label:"Description",multiline:!0,minRows:6,defaultValue:"",variant:"outlined",fullWidth:!0}),n.createElement(A.A,{style:{marginBottom:12},fullWidth:!0,variant:"outlined",label:"Tags",placeholder:"Tags for content classification"})))}return n.createElement(n.Fragment,null,n.createElement(c.A,{open:w,maxWidth:"sm",fullWidth:!0,disablePortal:!1,onClose:this.request_close,keepMounted:!1},n.createElement(l.A,null,n.createElement(u.A,{style:{marginTop:8,marginBottom:24},component:"h2",variant:"h6"},"Publisher"),W),n.createElement(s.A,{style:{textAlign:"right"}},n.createElement(p.A,{variant:"text",color:"primary",autoFocus:!0,onClick:()=>this._backOrCancel(Boolean(!X&&"upload file"==F))},parseInt(i)>0?"Back":"Cancel"),n.createElement(p.A,{variant:"contained",color:"primary",disabled:0===parseInt(i),onClick:this._nextOrFinish},2===parseInt(i)?"Publish":"Next"))),n.createElement(c.A,{PaperProps:{classes:{root:e.whiteDialog}},open:D,maxWidth:"xs",disablePortal:!1,onClose:this.close_confirm_close,keepMounted:!1},n.createElement(l.A,null,n.createElement(u.A,{style:{marginTop:8,marginBottom:24},component:"h2",variant:"h6"},"Are you sure?"),n.createElement(u.A,{variant:"body2",color:"textPrimary",component:"p"},"Your current artwork will be lost.")),n.createElement(s.A,{style:{textAlign:"right"}},n.createElement(p.A,{variant:"text",color:"primary",autoFocus:!0,onClick:this.close_confirm_close},"Cancel"),n.createElement(p.A,{variant:"contained",color:"primary",onClick:this.close_confirm},"Close"))),n.createElement(c.A,{PaperProps:{classes:{root:e.whiteDialog}},open:U,maxWidth:"xs",disablePortal:!1,onClose:()=>{this.close_use_ai(!1)},keepMounted:!1},n.createElement(l.A,null,n.createElement(u.A,{style:{marginTop:8,marginBottom:24},component:"h2",variant:"h6"},"Transform with AI?"),n.createElement(u.A,{variant:"body2",color:"textPrimary",component:"p"},"It takes around 10 seconds. ",n.createElement("b",null,"#Free")," ",n.createElement("b",null,"#Anonymous"))),n.createElement(s.A,{style:{textAlign:"right"}},n.createElement(p.A,{variant:"text",color:"primary",autoFocus:!0,onClick:()=>{this.close_use_ai(!1)}},"NO"),n.createElement(p.A,{variant:"contained",color:"primary",onClick:()=>this.close_use_ai(!0)},"YES"))),n.createElement(c.A,{PaperProps:{classes:{root:e.whiteDialog}},open:j,maxWidth:"sm",fullWidth:!0,disablePortal:!1,onClose:()=>{this._close_quantize_dialog(!1)},keepMounted:!1},n.createElement(l.A,null,n.createElement(u.A,{style:{marginTop:8,marginBottom:24},component:"h2",variant:"h6"},"Quantization Settings"),n.createElement(h.A,{style:{padding:"16px 0"}},n.createElement(u.A,{gutterBottom:!0},"Downscale Ratio: ",R,"x"),n.createElement(v.A,{value:R,onChange:this._handle_downscale_change,min:2,max:32,step:1,marks:[{value:2,label:"2x"},{value:8,label:"8x"},{value:16,label:"16x"},{value:32,label:"32x"}],valueLabelDisplay:"auto"})),n.createElement(h.A,{style:{padding:"16px 0"}},n.createElement(u.A,{gutterBottom:!0},"Number of Colors: ",M),n.createElement(v.A,{value:M,onChange:this._handle_colors_change,min:2,max:256,step:1,marks:[{value:2,label:"2"},{value:64,label:"64"},{value:128,label:"128"},{value:256,label:"256"}],valueLabelDisplay:"auto"})),n.createElement(h.A,{style:{marginTop:24}},n.createElement(u.A,{gutterBottom:!0,variant:"subtitle2"},"Preview:"),n.createElement("div",{className:"pixelated",style:{width:"100%",textAlign:"center"}},n.createElement("canvas",{style:{borderRadius:"12px",width:"100%"},ref:this._set_quantize_preview_canvas_ref})))),n.createElement(s.A,{style:{textAlign:"right"}},n.createElement(p.A,{variant:"text",color:"primary",onClick:()=>{this._close_quantize_dialog(!1)}},"Cancel"),n.createElement(p.A,{variant:"contained",color:"primary",onClick:()=>{this._close_quantize_dialog(!0)}},"Confirm"))))}}const D=(0,r.default)(O)(z);i()}catch(U){i(U)}}),1)},90010:(e,t,a)=>{a.d(t,{I:()=>s});a(54743),a(11745),a(27495),a(25440),a(42762),a(21489),a(61740),a(75044),a(28845),a(373),a(35874),a(12041),a(62953);var i=a(30687);function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function r(e,t,a){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var i=a.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const o={enable_color_matching:!0,consistency_mode:!0,enable_captions:!0},s=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};return new Promise((async function(s,l){t("AI CONVERT"),a("COMPUTE",Date.now(),Date.now()+12e3);try{(await i.Kj.connect("primerz/pixagram-stable")).predict("/process_image",function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({image:e},o)).then((async e=>{const t=e.data||[],a=(t[0]||{}).url||"",i=await(await fetch(a)).blob(),n=(t[1]||" Output: ").split("Output: ")[1];s(i,n)})).catch((e=>{l(e.message)}))}catch(e){l("Please Try Again Later")}}))}},34274:(e,t,a)=>{a.a(e,(async(e,i)=>{try{a.d(t,{E:()=>c,z:()=>u});a(54743),a(11745),a(22134),a(61740),a(75044),a(28845),a(373);var n=a(90010),r=a(2232);function o(e){const{width:t,height:a,data:i}=e,n=new Uint32Array(i.buffer);function r(e,t,a,i){return a[t*i+e|0]}function o(e,t,a,i,n){i[t*n+e|0]=a>>>0}let s=0,l={},p=new Uint32Array(8),c=0;for(let e=1;e<a-1;e=e+1|0)for(let a=1;a<t-1;a=a+1|0){l={},s=r(a,e,n,t),p[0]=r(a-1,e-1,n,t),p[1]=r(a,e-1,n,t),p[2]=r(a+1,e-1,n,t),p[3]=r(a-1,e,n,t),p[4]=r(a+1,e,n,t),p[5]=r(a-1,e+1,n,t),p[6]=r(a,e+1,n,t),p[7]=r(a+1,e+1,n,t);for(var u=0;u<8;u++)c=p[u],l[c]=(l[c]||0)+1,u>=5&&l[c]>=6&&o(a,e,c,n,t)}const d=new Uint8ClampedArray(n.buffer);return new ImageData(d,t,a)}function s(e,t,a){const i=e*t;let n=Math.sqrt(a/i);return Math.min(n,1)}function l(e,t){let a;try{if("undefined"==typeof OffscreenCanvas)throw new Error("OffscreenCanvas not supported");a=new OffscreenCanvas(e,t)}catch(i){a=document.createElement("canvas"),a.width=e,a.height=t}return a}function p(e){e.imageSmoothingEnabled=!1,e.mozImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1}await(0,r.Ay)();const c=async function(e,t,a,i){const n=(t=parseInt(t))*(a=parseInt(a)),o=await createImageBitmap(e),c=s(o.width,o.height,n),u=l(o.width,o.height),d=u.getContext("2d");p(d),d.drawImage(o,0,0,o.width,o.height),o.close();const h=d.getImageData(0,0,u.width,u.height),f=await(0,r.U3)(h.data,256,"frequency");return!!Boolean(c<=1&&f.colors.length<i)&&h},u=async function(e,t,a,i,c,u,d){t=parseInt(t),a=parseInt(a);const h=async(e,i)=>{const n=t*a,c=await createImageBitmap(e,{resizeQuality:"pixelated"}),u=s(c.width,c.height,n),d=parseInt(Math.round(c.width*u)),h=parseInt(Math.round(c.height*u)),f=l(c.width,c.height),m=l(d,h),_=f.getContext("2d"),g=m.getContext("2d");p(_),p(g),_.drawImage(c,0,0,c.width,c.height),g.drawImage(f,0,0,m.width,m.height),c.close();const b=_.getImageData(0,0,f.width,f.height);g.getImageData(0,0,m.height,m.height);p(l(1,1).getContext("2d",{willReadFrequently:!0}));const v=function(e,t,a){const i=s(t.width,t.height,e.size*e.size),n=t.width,o=t.height,l=Math.round(n*i),p=Math.round(o*i),c=(0,r.Ws)(a,n,o,l,p,6,6);return function(e,t){const a=(0,r.TF)(e.data,e.width,e.height,t,!1);return new ImageData(new Uint8ClampedArray(a.data),a.width,a.height)}(new ImageData(new Uint8ClampedArray(c.data),c.width,c.height),e.colors)};return{artwork:b,artworks:[{name:"XS",size:64,colors:32},{name:"S",size:128,colors:48},{name:"M",size:160,colors:64},{name:"L",size:224,colors:72},{name:"XL",size:320,colors:96}].map((function(e){return e.imageData=o(v(e,m,g.getImageData(0,0,m.width,m.height).data)),e})),prompt:i||""}};if(!d)return h(e,"");try{return(0,n.I)(e,c,u).then(((e,t)=>h(e,t)))}catch(t){return h(e,"")}};i()}catch(d){i(d)}}),1)}}]);