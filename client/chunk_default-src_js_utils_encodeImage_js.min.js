"use strict";(self.webpackChunkpixagram_io=self.webpackChunkpixagram_io||[]).push([["default-src_js_utils_encodeImage_js"],{15656:(e,t,a)=>{a.r(t),a.d(t,{encodeIMG:()=>d});a(62953);var n=a(43930);const s={quality:75,target_size:0,target_PSNR:0,method:4,sns_strength:50,filter_strength:60,filter_sharpness:0,filter_type:1,partitions:0,segments:4,pass:1,show_compressed:0,preprocessing:0,autofilter:0,partition_limit:0,alpha_compression:1,alpha_filtering:1,alpha_quality:100,lossless:0,exact:0,image_hint:0,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:0,use_sharp_yuv:0};var i=a(54367);const o=async()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11]));let r;async function c(e,t={}){r||(r=async function(e,t){if(await o()){const n=await a.e("node_modules_jsquash_webp_codec_enc_webp_enc_simd_js").then(a.bind(a,28899));return r=(0,i.d)(n.default,e,t),r}const n=await a.e("node_modules_jsquash_webp_codec_enc_webp_enc_js").then(a.bind(a,49227));return r=(0,i.d)(n.default,e,t),r}());const n={...s,...t},c=(await r).encode(e.data,e.width,e.height,n);if(!c)throw new Error("Encoding error.");return c.buffer}const l={};c.encodeImageData=async function(e){const t=arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{quality:0,target_size:0,target_PSNR:0,method:6,sns_strength:100,filter_strength:0,filter_sharpness:0,filter_type:0,partitions:0,segments:4,pass:6,show_compressed:0,preprocessing:0,autofilter:1,partition_limit:0,alpha_compression:1,alpha_filtering:0,alpha_quality:100,lossless:1,exact:1,image_hint:1,emulate_jpeg_size:0,thread_level:0,low_memory:0,near_lossless:100,use_delta_palette:1,use_sharp_yuv:0}:{lossless:0,quality:80};const a=await c(e,t),n=new Blob([a],{type:"image/webp"});return await(s=n,new Promise(((e,t)=>{const a=new FileReader;a.onloadend=()=>e(a.result),a.readAsDataURL(s)})));var s};const _=document.createElement("canvas");async function d(e,t,a){const s="PNG"===(t="PNG"===t.toUpperCase()?"PNG":"WEBP"===t.toUpperCase()?"WEBP":"JPEG")?n.U.encodeImageData.bind(this):"WEBP"===t?c.encodeImageData.bind(this):l.encodeImageData.bind(this),i=await async function(e){if(e instanceof ImageData)return e;const t=document.createElement("img");t.src=e,await new Promise((e=>t.onload=e));const a=document.createElement("canvas");[a.width,a.height]=[t.width,t.height];const n=a.getContext("2d");return n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height)}(e);return await s(i,a)}_.context=_.getContext("2d"),n.U.encodeImageData=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return await new Promise(((a,s)=>{_.width=e.width,_.height=e.height,_.context.putImageData(e,0,0),(0,n.U)(_.toDataURL("image/png"),t?100:40,t?100:80,t?1:9,(e=>{a(e)}))}))},l.encodeImageData=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return await new Promise(((a,n)=>{_.width=e.width,_.height=e.height,_.context.putImageData(e,0,0),a(_.toDataURL("image/jpeg",{quality:t?100:80}))}))}}}]);