(self.webpackChunkpixagram_io=self.webpackChunkpixagram_io||[]).push([["src_js_pages_FeedPersonal_js-src_js_utils_QuantiMat_js-src_js_utils_TimeAgo_js-src_js_utils_c-49e3af"],{74979:(e,t,n)=>{"use strict";n.a(e,(async(e,o)=>{try{n.r(t),n.d(t,{default:()=>U});n(52675),n(89463),n(2259),n(45700),n(28706),n(51629),n(25276),n(23792),n(62062),n(54743),n(11745),n(38309),n(59089),n(89572),n(94170),n(2892),n(69085),n(59904),n(84185),n(40875),n(10287),n(26099),n(3362),n(60825),n(47764),n(95477),n(81630),n(72170),n(75044),n(69539),n(31694),n(89955),n(33206),n(44496),n(66651),n(12887),n(19369),n(66812),n(8995),n(52568),n(31575),n(36072),n(88747),n(28845),n(29423),n(57301),n(373),n(86614),n(41405),n(33684),n(23500),n(62953),n(76031);var r=n(17402),i=n(86982),s=n(79626),_=n(69205),a=n(69232),l=n(16134),c=n(61990),u=n(78725),p=n(23563),f=n(9372),h=n(24488),d=n(40497),g=n(28379),m=e([c,u,d,g]);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function v(e,t,n){return(t=T(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,T(o.key),o)}}function S(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function T(e){var t=C(e,"string");return"symbol"==b(t)?t:t+""}function C(e,t){if("object"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=b(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function A(e,t,n){return t=j(t),R(e,M()?Reflect.construct(t,n||[],j(e).constructor):t.apply(e,n))}function R(e,t){if(t&&("object"==b(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(M=function(){return!!e})()}function j(e){return j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},j(e)}function E(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&O(e,t)}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}[c,u,d,g]=m.then?(await m)():m;var x=function(e){function t(){return w(this,t),A(this,t,arguments)}return E(t,e),S(t,[{key:"_getEstimatedTotalHeight",value:function(){var e=this.props,t=e.cellCount,n=e.cellMeasurerCache,o=e.width,r=Math.floor(o/(n||{}).defaultWidth||0),i=this._positionCache.estimateTotalHeight(t,r,(n||{}).defaultHeight||0);return isFinite(i)?i:0}}])}(l.a),y=function(e){function t(e){var n;return w(this,t),v(n=A(this,t,[e]),"_updated_dimensions",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now(),t=document.documentElement,o=document.body||document.getElementsByTagName("body")[0],r=window.innerWidth||t.clientWidth||o.clientWidth,i=window.innerHeight||t.clientHeight||o.clientHeight,s=Boolean(r<960),_=Boolean(i<690),a=n.st4te._less_than_960w!==s||n.st4te._less_than_690h!==_;n.st4te._window_width;n.setSt4te({_window_width:r,_window_height:i,_load_more_threshold:i*(i/r)*2},(function(){n.forceUpdate((function(){var t=n.st4te,o=t._root,r=t._gutter_size,i=t._window_width,s=t._window_height,_=(t.data,n.st4te._column_count);if(o){var a=o.getBoundingClientRect(),l=a.width,c=a.height;if(i<100||l<100||c<100||s<100)setTimeout((function(){n._updated_dimensions(e)}),250);else{_=1;var u=Math.floor((a.width-(_+1)*r)/_);n.setSt4te({_overscan_by_pixels:s*(s/i)*8,_column_width:Math.min(u,720),_column_count:_,_root_width:l,_root_height:c},(function(){n._init_cell_measurements((function(){n.setSt4te({_is_resizing:!1})}))}))}}}))})),a&&n.setSt4te({_less_than_960w:s,_less_than_690h:_,_window_width:r,_window_height:i},(function(){n.forceUpdate()}))})),v(n,"_recompute_cell_measurements",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=n.st4te,o=t._cell_measurer_cache,r=t._masonry,i=t._cell_positioner,s=t._column_count,_=t._gutter_size,a=t._column_width;if(null!=o&&null!=r&&null!=i){o.clearAll(),o.visible_ids={};var l={cellMeasurerCache:o,columnCount:s,columnWidth:a,spacer:_};i.reset(l),r.clearCellPositions(),n.setSt4te({_cell_positioner:i,_cell_positioner_config:l,_cell_measurer_cache:o},(function(){r.forceUpdate(e)}))}else n._init_cell_measurements(e)})),v(n,"_set_masonry_ref",(function(e){null!==e&&n.setSt4te({_masonry:e},(function(){n._init_cell_measurements()}))})),v(n,"_set_root_ref",(function(e){null!==e&&n.setSt4te({_root:e})})),v(n,"_cell_renderer",(function(e){var t=e.index,o=e.key,i=e.parent,s=e.style,_=e.isScrolling,a=n.st4te,c=a._root_height,p=a._root_width,f=a._masonry,h=a._column_width,d=a._cell_measurer_cache,g=a._column_count,m=a._settings,x=a._selected_post_index;if(void 0!==f.props.itemsWithSizes[0|t]){var y=f.props.itemsWithSizes[0|t],b=y.item,v=y.size,w=f._scrollingContainer.scrollTop,k=x===t;if(v.height){var S=t%g,T=(t-S)/g,C=Math.ceil(h*(v.height/v.width))||0;s.width=0+h;var A=n.st4te,R=A._top_scroll_of_el_by_index,P=A._height_of_el_by_index,M=A._x_y_of_el_by_index,j=0+s.top,E=0+s.height,O=j+E;R[t]=j,P[t]=E,M[t]=[T,S];var U=2*c*(c/p),I=U+O>w&&j<w+c+U;d.visible_ids[v.id]=I||d.visible_ids[v.id]||!1;var z=m._selected_locales_code;return n.setSt4te({_top_scroll_of_el_by_index:R,_height_of_el_by_index:P}),r.createElement(l.dl,{cache:d,index:t,key:o,parent:i},r.createElement(u.A,{onOpen:n._open_artwork,locales:z,nsfw:m._nsfw_enabled,data:b,renderer:m._renderer,onMenuClick:n.openCardMenu,is_scrolling:_,selected:k,size:v,visible:d.visible_ids[v.id],column_width:h,image_height:C,image_width:h,id:v.id,key:o,rowIndex:T,columnIndex:S,style:s}))}}})),v(n,"_init_cell_measurements",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};n.forceUpdate((function(){if(null!=n.st4te._cell_measurer_cache&&null!=n.st4te._cell_positioner_config&&null!=n.st4te._cell_positioner)n._recompute_cell_measurements(e);else{var t=n.st4te,o=t._column_count,r=t._column_width,i=t._gutter_size,s=new l.jS({defaultHeight:600,defaultWidth:r,fixedWidth:!0});s.visible_ids={};var _={cellMeasurerCache:s,columnCount:o,columnWidth:r,spacer:i},a=(0,l.wT)(_);n.setSt4te({_cell_measurer_cache:s,_cell_positioner:a,_cell_positioner_config:_},(function(){n.forceUpdate((function(){var t=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},o=n.st4te._masonry;o?o.forceUpdate(e):setTimeout((function(){t(e)}),5)};t(e)}))}))}}))})),v(n,"_next_current_post",(function(){var e=n.st4te,t=e._post,o=e._posts,r=e._masonry,i=o.map((function(e){return e.id})).indexOf(t.id)+1,s=Math.max(0,Math.min(o.length-1,i)),_=r.props.itemsWithSizes[0|s],a=_.item;_.size;n.setSt4te({_post:a},(function(){n.forceUpdate(),n._update_selected_post_index(s)}))})),v(n,"_previous_current_post",(function(){var e=n.st4te,t=e._post,o=e._posts,r=e._masonry,i=o.map((function(e){return e.id})).indexOf(t.id)-1,s=Math.max(0,Math.min(o.length-1,i)),_=r.props.itemsWithSizes[0|s],a=_.item;_.size;n.setSt4te({_post:a},(function(){n.forceUpdate(),n._update_selected_post_index(s)}))})),v(n,"_update_selected_post_index",(function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=n.st4te,r=o._post,i=o._posts,s=o._masonry;if(s){var _=s.props.itemsWithSizes,a=void 0!==e?e:r?i.map((function(e){return(e||{}).title})).indexOf(r.title):n.st4te._selected_post_index;n.setSt4te({_selected_post_index:a,_post:i[a],_post_img:(_[a]||{}).size},(function(){n.forceUpdate((function(){t?s.forceUpdate():n._scroll_to_index()}))}))}})),v(n,"_scroll_to",(function(e){var t=n.st4te._masonry;t&&(void 0===e?(t._scrollingContainer.scrollTop=n.st4te._scroll_top,t.forceUpdate()):n.setSt4te({_scroll_top:e},(function(){t._scrollingContainer.scrollTop=e,t.forceUpdate()})))})),v(n,"_scroll_to_index",(function(e){var t=n.st4te,o=t._selected_post_index,r=t._top_scroll_of_el_by_index,i=t._height_of_el_by_index,s=t._root_height,_=r[e=void 0!==e?e:o]+i[e]/2-s/3;n._scroll_to(_)})),v(n,"_handle_masonry_scroll",(function(e){var t=n.st4te,o=(t._load_more_threshold,t._loading_posts,n.st4te),r=o._masonry,i=o._scroll_top,s=o._y,_=o._overscan_by_pixels,a=r&&r._scrollingContainer?r._scrollingContainer.scrollTop:0,l=a-i,c=n.st4te._last_scroll_check_height+l,u=Math.abs(c)>_,p=Math.min(Math.max(-64,s-l),64);i===a&&s===p||n.setSt4te({_scroll_top:a,_y:p,_last_scroll_check_height:c},(function(){(s!==p||u)&&n.setSt4te({_last_scroll_check_height:0},(function(){n.forceUpdate()}))}))})),v(n,"openCardMenu",(function(e,t){n.setSt4te({menuCardXY:Int32Array.of(e.x-24,e.y-24),menuCardData:t},(function(){n.forceUpdate()}))})),v(n,"closeCardMenu",(function(){n.setSt4te({menuCardXY:Int32Array.of(0,0),menuCardData:{}},(function(){n.forceUpdate()}))})),v(n,"_open_create_artwork",(function(){n.setSt4te({_create_artwork_dialog_open:!0},(function(){n.forceUpdate()}))})),v(n,"_create_artwork_dialog_close",(function(){n.setSt4te({_create_artwork_dialog_open:!1},(function(){n.forceUpdate()}))})),v(n,"_open_artwork",(function(e){n.setSt4te({_artwork_open:!0,_post:e},(function(){n.forceUpdate()}))})),v(n,"_close_artwork",(function(){n.setSt4te({_artwork_open:!1,_post:{}},(function(){n.forceUpdate()}))})),n.st4te={classes:e.classes,_settings:e.settings,_history:i.Vv,_pathname:e.pathname,_image_name_infographics:"",_infographics_fadein_time:300,_infographics_in:!0,_bii3_opacity:1,_join_now_button_update:0,_less_than_960w:!0,_less_than_690h:!0,menuCardXY:[],menuCardData:{},authors:[],_scrolling_reset_time_interval:225,_min_col_width:180,_max_col_width:1280,_root_width:0,_root_height:0,_root:null,_window_width:0,_window_height:0,_average_img_ratio:1,_gutter_size:16,column_count:1,_column_width:640,_load_more_threshold:2e3,_overscan_by_pixels:9e3,_cell_positioner:null,_cell_positioner_config:null,_masonry:null,_cell_measurer_cache:null,_scroll_top:0,_intervals:[],_y:0,_top_scroll_of_el_by_index:[],_last_scroll_check_height:0,_height_of_el_by_index:[],_x_y_of_el_by_index:[],_selected_post_index:0,_post_closed_at:0,_posts:[],_create_artwork_dialog_open:!1,_artwork_open:!1,_post:{}},n}return E(t,e),S(t,[{key:"componentWillMount",value:function(){window.addEventListener("resize",this._updated_dimensions),_.qf(),_.wn(0),setTimeout((function(){_.wn(100)}),300);var e=setInterval(this._handle_masonry_scroll,this.st4te._scrolling_reset_time_interval);this.setSt4te({_intervals:[e]})}},{key:"setSt4te",value:function(e,t){e=e||{},this.st4te=Object.assign(this.st4te,e),"function"==typeof t&&t()}},{key:"componentDidMount",value:function(){var e=this;this._updated_dimensions(),r.default.findDOMNode(this).addEventListener("keydown",this._handle_keydown),(0,a.A)((function(){return n.e("src_js_data_authors_js").then(n.bind(n,60209))})).then((function(t){var o=t.default();(0,a.A)((function(){return n.e("src_js_data_posts_js").then(n.bind(n,65138))})).then((function(t){var n=t.default();e.setSt4te({_posts:n.map((function(e){return e.author=o[e.author],e}))},(function(){e.forceUpdate((function(){e._updated_dimensions()}))}))}))}))}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=e.settings._renderer!==this.st4te._settings._renderer,o=e.settings._nsfw_enabled!==this.st4te._settings._nsfw_enabled;this.setSt4te({_settings:e.settings},(function(){(n||o)&&t.forceUpdate((function(){t.st4te._masonry.forceUpdate()}))}))}},{key:"componentWillUnmount",value:function(){this.st4te._intervals.forEach((function(e){clearInterval(e)}));try{window.removeEventListener("resize",this._updated_dimensions)}catch(e){}try{r.default.findDOMNode(this).removeEventListener("keydown",this._handle_keydown)}catch(e){}}},{key:"render",value:function(){var e=this,t=this.st4te,n=t.classes,o=t._settings,i=this.st4te,s=(i._less_than_960w,i._less_than_690h,i._column_width),_=i.menuCardXY,a=i.menuCardData,l=this.st4te,u=l._artwork_open,m=l._post,y=this.st4te,b=y._window_width,v=y._window_height,w=y._cell_positioner,k=y._cell_measurer_cache,S=y._overscan_by_pixels,T=y._y,C=y._scroll_top,A=y._posts,R=y._create_artwork_dialog_open,P=y._scrolling_reset_time_interval,M=v,j=b>960?b-284:b,E=Math.round((j-s)/2),O=j-2*E,U=M-16,I=o._selected_locales_code;return r.createElement(r.Fragment,null,r.createElement("div",{ref:this._set_root_ref},r.createElement(c.A,{className:n.masonry,items:A,image:function(e){return e.image},keyMapper:function(e){return e.id}},(function(t){return r.createElement(x,{style:{padding:"16px ".concat(E,"px 0px ").concat(E,"px")},key:"masonry-extended",scrollTop:C,scrollingResetTimeInterval:P,height:U,cellCount:0|(t||[]).length,itemsWithSizes:t,keyMapper:function(e){return t[e].size.id},cellMeasurerCache:k,cellPositioner:w,cellRenderer:e._cell_renderer,overscanByPixels:S,ref:e._set_masonry_ref,width:O})}))),r.createElement("div",{onClick:this._open_create_artwork,className:n.mainFab,style:{transform:"translateY(".concat(0<T&&C>512?96:0,"px)")}},r.createElement(h.A,{variant:"extended",size:"large"},r.createElement(f.A,{style:{marginRight:12}}),r.createElement("span",null,"CREATE"))),r.createElement(p.A,{xy:_,data:a,onClose:this.closeCardMenu}),r.createElement(d.A,{keepMounted:!0,open:R,onClose:this._create_artwork_dialog_close}),r.createElement(g.A,{renderer:o._renderer,nsfw:o._nsfw_enabled,format:o._format,data:m,open:u,locales:I,onClose:this._close_artwork,onPrevious:this._previous_current_post,onNext:this._next_current_post}))}}])}(r.PureComponent);const U=(0,s.default)((function(e){return{mainFab:{animation:"$slideInFromBottom 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","@global":{"@keyframes slideInFromBottom":{"0%":{transform:"translateY(160px)",filter:"opacity(0)"},"100%":{transform:"translateY(0px)",filter:"opacity(1)"}}},position:"fixed",right:16,bottom:16,transition:"transform 225ms cubic-bezier(0.4, 0, 0.2, 1) 75ms","& .MuiButtonBase-root":{borderRadius:"32px",background:"#f6f6f6",transition:"background 225ms cubic-bezier(0.4, 0, 0.2, 1) 75ms",mixBlendMode:"overlay","& .MuiTouchRipple-root":{filter:"opacity(1)","& .MuiTouchRipple-child":{backgroundImage:"\n                      radial-gradient(circle at 50% 50%,\n                        magenta 0%, blue 20%, cyan 40%, green 60%, yellow 80%, red 100%)"}}},"& .MuiButtonBase-root:hover":{background:"white",transition:"background 225ms cubic-bezier(0.4, 0, 0.2, 1) 5ms"},"& .MuiFab-extended":{padding:"0 24px",height:64,fontSize:"1.125rem"},"& .MuiFab-extended .MuiSvgIcon-root":{fontSize:"1.75rem"}},masonry:{overflow:"hidden overlay !important",contain:"style layout","& > .ReactVirtualized__Masonry":{zIndex:0,position:"absolute",margin:0,scrollBehavior:"smooth",overscrollBehavior:"none",boxSizing:"content-box !important",touchAction:"pan-y",overflow:"hidden overlay !important",willChange:"scroll-position !important","& > .ReactVirtualized__Masonry__innerScrollContainer":{top:"auto !important",left:"auto !important",contentVisibility:"auto",overflow:"initial !important",position:"absolute !important",paddingBottom:"48px",boxSizing:"content-box"}}}}}))(y);o()}catch(I){o(I)}}))},23138:(e,t,n)=>{"use strict";n(52675),n(89463),n(2259),n(33771),n(23418),n(64346),n(23792),n(31051),n(34782),n(54743),n(11745),n(38309),n(59089),n(23288),n(62010),n(60605),n(84185),n(26099),n(78459),n(58940),n(27495),n(38781),n(31415),n(47764),n(22134),n(61740),n(81630),n(72170),n(75044),n(69539),n(31694),n(89955),n(33206),n(48345),n(44496),n(66651),n(12887),n(19369),n(66812),n(8995),n(31575),n(36072),n(88747),n(28845),n(29423),n(57301),n(373),n(86614),n(41405),n(33684),n(62953);var o=n(82803),r=n(4826);var i=(0,r.SIMDopeCreateConfAdd)({create:{new_of:!0},properties:{uint32:!0,laba:!0,rgbaon4bits:!0,rgbaon6bits:!0,rgbaon8bits:!0,rgbaon12bits:!0,rgbaon16bits:!0,skin:!0},methods:{simplify:!0,get_new_element:!0,get_use_element:!0,set_tail:!0,is_dark:!0,blend_first_with:!0,blend_first_with_tails:!0,blend_all:!0,euclidean_match_with:!0,manhattan_match_with:!0,cie76_match_with:!0,copy:!0}}),s=Math.fround,_=s(100),a=s(2),l=(0,r.SIMDopeCreate)(i),c=l.simdops,u=l.Color,p=l.Colors,f=(c.minus_int,c.int_not_equal,c.plus_int,c.plus_uint,c.minus_uint,c.multiply_int,c.multiply_uint,c.multiply_uint_4),h=(c.divide_uint,c.clamp_uint8,c.clamp_uint32,c.int_equal,c.uint_less,c.int_less,c.int_greater_equal,c.uint_not_equal,c.uint_less_equal,c.min_uint,function(e){if(e=e||{},!(this instanceof h))return new h(e);e.pxl_colors=e.pxl_colors||new Uint32Array(0),e.pxls=e.pxls||new Uint32Array(0),this.speed=e.speed||"auto",this.new_pxls_="buffer"in e.pxls?new Uint32Array(e.pxls.buffer):Uint32Array.from(e.pxls),this.new_pxl_colors_="buffer"in e.pxl_colors?new p(e.pxl_colors.buffer):new p(Uint32Array.from(e.pxl_colors).buffer);var t=0|this.new_pxl_colors_.length;this.new_pxl_colors_is_skin_mask_=new o.SetFixed(0|t),this.set_new_pxl_skin_mask(),this.best_color_number_=e.number_of_color,this.max_cluster_=t>65536?65537:t>16384?4097:t>4096?257:t>256?17:1,this.index_clusters_=new Array(this.max_cluster_),this.length_clusters_=new Uint32Array(this.max_cluster_),this.pxl_colors_usage_=new Uint32Array(t),this.all_index_clusters_=new Uint32Array(t),this.clean_pxl_colors_=new Uint32Array(t),this.clean_pxl_colors_lookup_={},this.t=0,this.is_skin_ops_=0,this.match_ops_=0,this.blend_ops_=0,this.remove_duplicate_ops_=0,this.simplify_ops_=0,this.classify_on_x_bits_ops_=0});Object.defineProperty(h.prototype,"set_is_skin_ops",{get:function(){return function(e){this.is_skin_ops_=(0|e)>>>0}}}),Object.defineProperty(h.prototype,"set_match_ops",{get:function(){return function(e){this.match_ops_=(0|e)>>>0}}}),Object.defineProperty(h.prototype,"set_blend_ops",{get:function(){return function(e){this.blend_ops_=(0|e)>>>0}}}),Object.defineProperty(h.prototype,"set_remove_duplicate_ops",{get:function(){return function(e){this.remove_duplicate_ops_=(0|e)>>>0}}}),Object.defineProperty(h.prototype,"set_simplify_ops",{get:function(){return function(e){this.simplify_ops_=e}}}),Object.defineProperty(h.prototype,"set_classify_on_x_bits_ops",{get:function(){return function(e){this.classify_on_x_bits_ops_=e}}}),Object.defineProperty(h.prototype,"get_is_skin_ops",{get:function(){return function(){return 0|this.is_skin_ops_}}}),Object.defineProperty(h.prototype,"get_match_ops",{get:function(){return function(){return 0|this.match_ops_}}}),Object.defineProperty(h.prototype,"get_blend_ops",{get:function(){return function(){return 0|this.blend_ops_}}}),Object.defineProperty(h.prototype,"get_remove_duplicate_ops",{get:function(){return function(){return 0|this.remove_duplicate_ops_}}}),Object.defineProperty(h.prototype,"get_simplify_ops",{get:function(){return function(){return this.simplify_ops_}}}),Object.defineProperty(h.prototype,"get_classify_on_x_bits_ops",{get:function(){return function(){return this.classify_on_x_bits_ops_}}}),Object.defineProperty(h.prototype,"reset_deduplicate",{get:function(){return function(e){this.clean_pxl_colors_lookup_={},this.pxl_colors_usage_.fill(0,0,0|e),this.clean_pxl_colors_.fill(0,0,0|e)}}}),Object.defineProperty(h.prototype,"index_of_color_within_cleaned",{get:function(){return function(e){return(0|this.clean_pxl_colors_lookup_[(0|e)>>>0])-1|0}}}),Object.defineProperty(h.prototype,"set_cleaned_pxl_colors",{get:function(){return function(e,t){this.clean_pxl_colors_[(0|e)>>>0]=(0|t)>>>0,this.clean_pxl_colors_lookup_[(0|t)>>>0]=(e+1|0)>>>0}}}),Object.defineProperty(h.prototype,"increase_color_usage",{get:function(){return function(e){this.pxl_colors_usage_[(0|e)>>>0]=(this.pxl_colors_usage_[(0|e)>>>0]+1|0)>>>0}}}),Object.defineProperty(h.prototype,"set_new_pxls",{get:function(){return function(e,t){this.new_pxls_[(0|e)>>>0]=(0|t)>>>0}}}),Object.defineProperty(h.prototype,"set_new_pxl_colors",{get:function(){return function(e){this.new_pxl_colors_=new p(this.clean_pxl_colors_.buffer.slice(0,f(0|e))),this.set_new_pxl_skin_mask()}}}),Object.defineProperty(h.prototype,"set_new_pxl_skin_mask",{get:function(){return function(){var e=new u(new ArrayBuffer(4)),t=0|this.new_pxl_colors_.length,n=0;for(this.new_pxl_colors_is_skin_mask_=new o.SetFixed(0|t);(0|n)<(0|t);n=n+1|0)this.new_pxl_colors_.get_use_element(0|n,e).skin&&this.new_pxl_colors_is_skin_mask_.add(0|n);this.set_is_skin_ops(this.get_is_skin_ops()+n|0)}}}),Object.defineProperty(h.prototype,"get_a_new_pxl_color_from_pxl_index",{get:function(){return function(e){return 4294967295&this.new_pxl_colors_.buffer_getUint32(this.new_pxls_[0|e])}}}),Object.defineProperty(h.prototype,"reset_cluster",{get:function(){return function(){var e=this.new_pxl_colors_.length;this.max_cluster_=e>65536?65537:e>16384?4097:e>4096?257:e>256?17:1,this.length_clusters_.fill(0,0,0|this.max_cluster);for(var t=0;(0|t)<(0|this.max_cluster);t=(t+1|0)>>>0)this.index_clusters_[0|t]=[]}}}),Object.defineProperty(h.prototype,"add_in_indexes_cluster",{get:function(){return function(e,t){this.index_clusters_[(0|e)>>>0].push((0|t)>>>0)}}}),Object.defineProperty(h.prototype,"set_all_cluster_indexes",{get:function(){return function(){for(var e=0,t=0;(0|e)<(0|this.max_cluster);e=(e+1|0)>>>0)this.all_index_clusters_.set(this.index_clusters_[(0|e)>>>0],(0|t)>>>0),t=(t+this.get_length_in_index_clusters(0|e)|0)>>>0}}}),Object.defineProperty(h.prototype,"get_length_in_index_clusters",{get:function(){return function(e){return(0|this.index_clusters_[(0|e)>>>0].length)>>>0}}}),Object.defineProperty(h.prototype,"get_in_cluster_lengths",{get:function(){return function(e){return(0|this.length_clusters_[(0|e)>>>0])>>>0}}}),Object.defineProperty(h.prototype,"get_an_index_in_clusters",{get:function(){return function(e){return(0|this.all_index_clusters_[0|e])>>>0}}}),Object.defineProperty(h.prototype,"get_a_color_usage",{get:function(){return function(e){return(0|this.pxl_colors_usage_[0|e])>>>0}}}),Object.defineProperty(h.prototype,"set_a_color_usage",{get:function(){return function(e,t){return this.pxl_colors_usage_[0|e]=(0|t)>>>0}}}),Object.defineProperty(h.prototype,"get_a_color_usage_percent",{get:function(){return function(e){return this.pxl_colors_usage_[0|e]/this.new_pxls_.length}}}),Object.defineProperty(h.prototype,"get_average_color_usage_percent",{get:function(){return function(e,t){t=0|((t|=0)<(e|=0)?this.pxl_colors_usage_.length:t);var n=0,o=0,r=0;for(o=0|e;(0|o)<(0|t);o=(o+1|0)>>>0)r=(0|this.get_an_index_in_clusters((0|o)>>>0))>>>0,n+=this.pxl_colors_usage_[0|r]/this.new_pxls_.length;return n/(t-e|0)}}}),Object.defineProperty(h.prototype,"get_a_new_pxl_color",{get:function(){return function(e){return this.new_pxl_colors_.get_new_element(0|e)}}}),Object.defineProperty(h.prototype,"is_pxl_color_skin",{get:function(){return function(e){return this.new_pxl_colors_is_skin_mask_.has(0|e)}}}),Object.defineProperty(h.prototype,"max_cluster",{get:function(){return 0|this.max_cluster_}}),Object.defineProperty(h.prototype,"new_pxls_length",{get:function(){return 0|this.new_pxls_.length}}),Object.defineProperty(h.prototype,"new_pxl_colors_length",{get:function(){return 0|this.new_pxl_colors_.length}}),Object.defineProperty(h.prototype,"best_color_number",{get:function(){return 0|this.best_color_number_}}),Object.defineProperty(h.prototype,"get_data",{get:function(){return function(){return Array.of(this.new_pxls_,this.new_pxl_colors_.subarray_uint32(0,this.new_pxl_colors_.length),{deduplicate:this.get_remove_duplicate_ops(),simplify:this.get_simplify_ops(),classify:this.get_classify_on_x_bits_ops(),skin:this.get_is_skin_ops(),blend:this.get_blend_ops(),match:this.get_match_ops()})}}}),h.prototype.output=function(e){e=e||"heap";var t=this.get_data();if("heap"==e){var n=new Uint32Array(2+t[0].length+t[1].length);return n[0]=0|t[0].length,n[1]=0|t[1].length,n.set(t[0],2),n.set(t[1],2+t[0].length),n.buffer}return t},h.prototype.deduplicate=function(){this.set_remove_duplicate_ops(this.get_remove_duplicate_ops()+1|0),this.reset_deduplicate(0|this.new_pxl_colors_length);for(var e=0,t=0,n=0,o=0,r=0|this.new_pxls_length;(0|o)<(0|r);o=(o+1|0)>>>0)t=0|this.get_a_new_pxl_color_from_pxl_index(0|o),-1==(0|(n=0|this.index_of_color_within_cleaned(0|t)))&&(this.set_cleaned_pxl_colors(0|e,0|t),n=0|e,e=e+1|0),this.increase_color_usage(0|n),this.set_new_pxls(0|o,0|n);this.set_new_pxl_colors(e)},h.prototype.clusterize=function(){this.reset_cluster();var e=0;if(65537===this.max_cluster)for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|e)>>>0).rgbaon16bits)>>>0,(0|e)>>>0);else if(4097===this.max_cluster)for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|e)>>>0).rgbaon12bits)>>>0,(0|e)>>>0);else if(257===this.max_cluster)for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|e)>>>0).rgbaon8bits)>>>0,(0|e)>>>0);else if(17===this.max_cluster)for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster((0|this.get_a_new_pxl_color((0|e)>>>0).rgbaon4bits)>>>0,(0|e)>>>0);else for(;(0|e)<(0|this.new_pxl_colors_length);e=(e+1|0)>>>0)this.add_in_indexes_cluster(0,(0|e)>>>0);this.max_cluster>1&&this.set_classify_on_x_bits_ops(this.get_classify_on_x_bits_ops()+this.new_pxl_colors_length),this.set_all_cluster_indexes()},h.prototype.process_threshold=function(e,t,n){var o,r,i,l,c=!1,p=[],f=[],h=0,d=0,g=!1,m=!1,x=0,y=0,b=0,v=0,w=0,k=0,S=function(e){return 1-(1-e)*(1-e)}((e=(0|e)>>>0)/(n=(0|n)>>>0)),T=0,C=0,A=0,R=0,P=0,M=0;for(l=s(S*a),i=s(S*_);(0|P)<(0|this.max_cluster);P=(P+1|0)>>>0){for(d=(h+((0|this.get_length_in_index_clusters(0|P))>>>0)|0)>>>0,w=this.get_average_color_usage_percent(0|h,0|d),A=0|h;(0|A)<(0|d);A=(A+1|0)>>>0){if(T=(0|this.get_an_index_in_clusters((0|A)>>>0))>>>0,o=this.get_a_new_pxl_color((0|T)>>>0),g=this.is_pxl_color_skin((0|T)>>>0),(0|(x=(0|this.get_a_color_usage((0|T)>>>0))>>>0))>0)for(p=[],R=0|h;(0|R)<(0|d);R=(R+1|0)>>>0)C=(0|this.get_an_index_in_clusters((0|R)>>>0))>>>0,r=this.get_a_new_pxl_color((0|C)>>>0),m=this.is_pxl_color_skin((0|C)>>>0),0|(y=(0|this.get_a_color_usage((0|C)>>>0))>>>0)&&(0|T)!=(0|C)&&(0|g)==(0|m)&&(b=this.get_a_color_usage_percent((0|T)>>>0)/w,v=this.get_a_color_usage_percent((0|C)>>>0)/w,M=s((M=g&&m?l:g||m?i:S)*(.15*Math.abs(b-v)+.3*(2-(b+v))+.55)/1),o[t](r,M)&&(k=s(y/x),c=!0,this.set_a_color_usage(0|C,0),p.push(r),f.push(k)));(0|p.length)>0&&(u.blend_all(o,p,f),p=[],f=[])}h=0|d}return c},h.prototype.round=function(){if(this.new_pxl_colors_length>1024){for(var e=0|(this.new_pxl_colors_length>32768?4:this.new_pxl_colors_length>32768?3:this.new_pxl_colors_length>16384?2.5:this.new_pxl_colors_length>8192?2:this.new_pxl_colors_length>2048?1.5:(this.new_pxl_colors_length,1)),t=0;(0|t)<(0|this.new_pxl_colors_length);t=(t+1|0)>>>0)this.get_a_new_pxl_color((0|t)>>>0).simplify(e);this.set_simplify_ops(this.get_simplify_ops()+this.new_pxl_colors_length)}},h.prototype.init=function(){return this.round(),this.deduplicate(),this.clusterize(),this},h.prototype.run=function(){var e=0;if(this.new_pxl_colors_length<=this.best_color_number)return this.deduplicate(),this.clusterize(),this;for(var t=["euclidean_match_with","euclidean_match_with","euclidean_match_with"],n=this.speed=this.new_pxl_colors_length>32768?t[0]:this.new_pxl_colors_length>1024?t[1]:t[2];this.new_pxl_colors_length>this.best_color_number;)e=e+1|0,this.process_threshold(e,n,256)&&(this.deduplicate(),this.clusterize());return this},h.split_image_data=function(e){for(var t=new Uint32Array(e.data.buffer),n=Uint32Array.from(new Set(t)),o={},r=n.length,i=new Uint32Array(t.length),s=0,_=0|r;(0|s)<(0|_);s=(s+1|0)>>>0)o[n[0|s]]=(0|s)>>>0;for(s=0,_=0|t.length;(0|s)<(0|_);s=(s+1|0)>>>0)i[0|s]=(0|o[t[0|s]])>>>0;return[i,n,t,r]}},37532:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var o=n(19798),r=n(29411);o.A.addDefaultLocale(r.A);const i=new o.A("en-US")},20793:e=>{var t="\n  ".concat('var fu = function(image_data, scale) {\n\n    return new Promise(function (resolve, reject) {\n\n        var CRT = (function () {\n\n            "use asm";\n\n            var sqrt = Math.sqrt;\n            var cos = Math.cos;\n            var sin = Math.sin;\n            var min = Math.min;\n            var max = Math.max;\n            var imul = Math.imul;\n\n            function apply(imageData, srcx, srcy, scale, threshold) {\n\n                srcx = srcx | 0;\n                srcy = srcy | 0;\n                scale = scale | 0;\n                threshold = +threshold;\n\n                var Channels = 4;\n                var SizeX = srcx * scale | 0;\n                var SizeY = srcy * scale | 0;\n\n                var ScaledImage = new Uint8ClampedArray(SizeX * SizeY * Channels);\n\n                var total = SizeY | 0;\n                var current = 0;\n\n                var ppx = 0.0;\n                var ppy = 0.0;\n                var posx = 0;\n                var posy = 0;\n                var sub_posx = 0.0;\n                var sub_posy = 0.0;\n                var positionx = 0;\n                var positiony = 0;\n                var center = 0;\n                var left = 0;\n                var right = 0;\n                var midleft = 0;\n                var midright = 0;\n                var ret = 0;\n                var cr = 0;\n                var cg = 0;\n                var cb = 0;\n                var mlb = 0;\n                var mrr = 0;\n                var mrg = 0;\n                var lb = 0;\n                var rr = 0;\n                var rg = 0;\n                var alpha = 0;\n\n                for (var y = 0; y < SizeY; y = y + 1 | 0) {\n\n                    var offset = imul(y, SizeX) | 0;\n                    ppy = +(y / SizeY);\n\n                    for (var x = 0; x < SizeX; x = x + 1 | 0) {\n\n                        ppx = +(x / SizeX);\n                        posx = ~~(ppx * srcx);\n                        posy = ~~(ppy * srcy);\n                        sub_posx = +(ppx * srcx * 6) % 1.0;\n                        sub_posy = +(ppy * srcy * 6) % 1.0;\n                        positionx = posx | 0;\n                        positiony = posy | 0;\n\n                        center = CLR(imageData, srcx, srcy, positionx, positiony, 0, 0);\n                        left = CLR(imageData, srcx, srcy, positionx, positiony, -1, 0);\n                        right = CLR(imageData, srcx, srcy, positionx, positiony, 1, 0);\n\n                        if (sub_posy < 1.0 / 6.0) {\n\n                            center = mix(center, CLR(imageData, srcx, srcy, positionx, positiony, 0, -1), 0.5 - sub_posy / 2.0);\n                            left = mix(left, CLR(imageData, srcx, srcy, positionx, positiony, -1, -1), 0.5 - sub_posy / 2.0);\n                            right = mix(right, CLR(imageData, srcx, srcy, positionx, positiony, 1, -1), 0.5 - sub_posy / 2.0);\n\n                        } else if (sub_posy > 5.0 / 6.0) {\n\n                            center = mix(center, CLR(imageData, srcx, srcy, positionx, positiony, 0, 1), sub_posy / 2.0);\n                            left = mix(left, CLR(imageData, srcx, srcy, positionx, positiony, -1, 1), sub_posy / 2.0);\n                            right = mix(right, CLR(imageData, srcx, srcy, positionx, positiony, 1, 1), sub_posy / 2.0);\n                        }\n\n                        var scanline_multiplier;\n\n                        if (sub_posy < 0.5) {\n\n                            scanline_multiplier = (sub_posy * 2) * 0.3 + 0.7;\n\n                        } else {\n\n                            scanline_multiplier = ((1 - sub_posy) * 2) * 0.3 + 0.7;\n                        }\n\n                        Mul(center, scanline_multiplier);\n                        Mul(left, scanline_multiplier);\n                        Mul(right, scanline_multiplier);\n\n                        var odd = (ppx * srcx) & 1;\n\n                        var gradient_position;\n\n                        if (odd) {\n\n                            posy = +(posy + 0.5);\n                            posy = +(posy % 1.0);\n                        }\n\n                        if (posy < 1.0 / 3.0) {\n\n                            gradient_position = +(posy * 3.0);\n\n                            Mul(center, gradient_position * 0.6 + 0.4);\n                            Mul(left, gradient_position * 0.6 + 0.4);\n                            Mul(right, gradient_position * 0.6 + 0.4);\n\n                        } else if (posy > 2.0 / 3.0) {\n\n                            gradient_position = +(1 - posy) * 3.0;\n\n                            Mul(center, gradient_position * 0.6 + 0.4);\n                            Mul(left, gradient_position * 0.6 + 0.4);\n                            Mul(right, gradient_position * 0.6 + 0.4);\n                        }\n\n                        if (posx < 1.0 / 6.0 || posx > 5.0 / 6.0) {\n\n                            posy = +(posy + 0.5);\n                            posy = +(posy % 1.0);\n\n                            if (posy < 1.0 / 3.0) {\n\n                                gradient_position = +(posy * 3.0);\n\n                                if (posx < 0.5) {\n\n                                    gradient_position = +(1 - (1 - gradient_position) * (1 - (ppx) * 6.0));\n\n                                } else {\n\n                                    gradient_position = +(1 - (1 - gradient_position) * (1 - (1 - ppx) * 6.0));\n                                }\n\n                                Mul(center, gradient_position * 0.6 + 0.4);\n                                Mul(left, gradient_position * 0.6 + 0.4);\n                                Mul(right, gradient_position * 0.6 + 0.4);\n\n                            } else if (posy > 2.0 / 3.0) {\n\n                                gradient_position = +(1 - posy) * 3.0;\n\n                                if (posx < 0.5) {\n\n                                    gradient_position = +(1 - (1 - gradient_position) * (1 - (ppx) * 6.0));\n\n                                } else {\n\n                                    gradient_position = +(1 - (1 - gradient_position) * (1 - (1 - ppx) * 6.0));\n                                }\n\n                                Mul(center, gradient_position * 0.6 + 0.4);\n                                Mul(left, gradient_position * 0.6 + 0.4);\n                                Mul(right, gradient_position * 0.6 + 0.4);\n                            }\n                        }\n\n                        midleft = mix(left, center, 0.5);\n                        midright = mix(right, center, 0.5);\n\n                        cr = Red(center) | 0;\n                        cg = Green(center) | 0;\n                        cb = Blue(center) | 0;\n                        mlb = Blue(midleft) | 0;\n                        mrr = Red(midright) | 0;\n                        mrg = Green(midright) | 0;\n                        lb = Blue(left) | 0;\n                        rr = Red(right) | 0;\n                        rg = Green(right) | 0;\n                        alpha = Alpha(center) | 0;\n\n                        if (ppx < 1.0 / 6.0) {\n\n                            ret = mix(ARGBINT(alpha, cr * 255, cg * 255, lb * 255), ARGBINT(alpha, cr * 255, cg * 255, lb * 255), sub_posx);\n\n                        } else if (ppx < 2.0 / 6.0) {\n\n                            ret = mix(ARGBINT(alpha, cr * 255, cg * 255, lb * 255), ARGBINT(alpha, cr * 255, cg * 255, mlb * 255), sub_posx);\n\n                        } else if (ppx < 3.0 / 6.0) {\n\n                            ret = mix(ARGBINT(alpha, cr * 255, cg * 255, mlb * 255), ARGBINT(alpha, mrr * 255, cg * 255, cb * 255), sub_posx);\n\n                        } else if (ppx < 4.0 / 6.0) {\n\n                            ret = mix(ARGBINT(alpha, mrr * 255, cg * 255, cb * 255), ARGBINT(alpha, rr * 255, cg * 255, cb * 255), sub_posx);\n\n                        } else if (ppx < 5.0 / 6.0) {\n\n                            ret = mix(ARGBINT(alpha, rr * 255, cg * 255, cb * 255), ARGBINT(alpha, rr * 255, mrg * 255, cb * 255), sub_posx);\n\n                        } else {\n\n                            ret = mix(ARGBINT(alpha, rr * 255, mrg * 255, cb * 255), ARGBINT(alpha, rr * 255, rg * 255, cb * 255), sub_posx);\n                        }\n\n                        if (positionx < 1) {\n\n                            Mul(ret, positionx | 0);\n\n                        } else if (positionx > srcx - 1) {\n\n                            Mul(ret, srcx - positionx | 0);\n                        }\n\n                        if (positiony < 1) {\n\n                            Mul(ret, positiony | 0);\n\n                        } else if (positiony > srcy - 1) {\n\n                            Mul(ret, srcy - positiony | 0);\n                        }\n\n                        ScaledImage[offset * Channels] = Red(ret) | 0;\n                        ScaledImage[offset * Channels + 1] = Green(ret) | 0;\n                        ScaledImage[offset * Channels + 2] = Blue(ret) | 0;\n                        ScaledImage[offset * Channels + 3] = Alpha(ret) | 0;\n\n                    }\n\n                    current = current + 1 | 0;\n                }\n\n                return new ImageData(ScaledImage, SizeX, SizeY);\n            }\n\n            function mix(a, b, c) {\n\n                a = a | 0;\n                b = b | 0;\n                c = +c;\n\n                return ((a + ((b - a) * c)) | 0);\n            }\n\n            function Mul(x, y) {\n\n                x = x | 0;\n                y = +y;\n\n                return ((x * y) | 0);\n            }\n\n            function Red(rgb) {\n\n                rgb = rgb | 0;\n\n                return ((rgb >>> 16) & 0xFF) | 0;\n            }\n\n            function Green(rgb) {\n\n                rgb = rgb | 0;\n\n                return ((rgb >>> 8) & 0xFF) | 0;\n            }\n\n            function Blue(rgb) {\n\n                rgb = rgb | 0;\n\n                return (rgb & 0xFF) | 0;\n            }\n\n            function Alpha(rgb) {\n\n                rgb = rgb | 0;\n\n                return (rgb >>> 24) | 0;\n            }\n\n            function ARGBINT(a, r, g, b) {\n\n                a = a | 0;\n                r = r | 0;\n                g = g | 0;\n                b = b | 0;\n\n                return (((((a) << 24) | (r << 16) | (g << 8) | b) >>> 0) | 0);\n            }\n\n            function CLR(Input, srcx, srcy, x, y, dx, dy) {\n\n                Input = Input | 0;\n                srcx = srcx | 0;\n                srcy = srcy | 0;\n                x = x | 0;\n                y = y | 0;\n                dx = dx | 0;\n                dy = dy | 0;\n\n                var Channels = 4;\n\n                var xx = 0;\n                var yy = 0;\n\n                xx = (x + dx) | 0;\n                yy = (y + dy) | 0;\n\n                xx = max(0, min(srcx - 1, xx)) | 0;\n                yy = max(0, min(srcy - 1, yy)) | 0;\n\n                var index = 0;\n\n                index = ((yy * srcx + xx) * Channels) | 0;\n\n                var r = 0;\n                var g = 0;\n                var b = 0;\n                var a = 0;\n\n                r = (Input[index] | 0);\n                g = (Input[index + 1] | 0);\n                b = (Input[index + 2] | 0);\n                a = (Input[index + 3] | 0);\n\n                return ARGBINT(a, r, g, b) | 0;\n            }\n\n            return { Apply: apply };\n        }());\n\n        resolve(CRT.Apply(image_data.data, image_data.width, image_data.height, scale, 0));\n    });\n}\n\nfunction crt(image_data, scale) {\n    return new Promise(function(resolve, reject){\n        fu(image_data, scale).then((result) => {\n            resolve(result);\n        });\n    });\n}\n\n',"\n    self.onmessage = function onmessage(event) {\n        if (event.data.type === 'imageData') {\n            const result = crt(event.data.imageData, event.data.data.scale).then(function(result){\n                self.postMessage([result, event.data.id, event.data.algorithm]);\n            });\n        }\n    };\n");e.exports={functionString:t,functionSize:function(e,t,n){return{width:e*n,height:t*n,arrayBufferLength:e*n*t*n*4}}}},81968:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});n(23792),n(54743),n(11745),n(38309),n(26099),n(34594),n(22134),n(81630),n(72170),n(75044),n(69539),n(31694),n(89955),n(33206),n(44496),n(66651),n(12887),n(19369),n(66812),n(8995),n(31575),n(36072),n(88747),n(28845),n(29423),n(57301),n(373),n(86614),n(41405),n(33684);const o=function(){var e,t,n,o,r,i,s;function _(t,n){var o=e.createShader(t);if(e.shaderSource(o,n),e.compileShader(o),!e.getShaderParameter(o,e.COMPILE_STATUS))throw new Error(e.getShaderInfoLog(o));return o}return function(a){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,c=a.width,u=a.height,p=c*l,f=u*l;e||function(){t||(t=new OffscreenCanvas(1,1)),e||(e=t.getContext("webgl2"));var a=_(e.VERTEX_SHADER,"#version 300 es\n        in vec2 position;\n        out vec2 vTexCoord;\n        \n        void main() {\n            vTexCoord = (position + 1.0) * 0.5; // Convert from clip space to UV\n            gl_Position = vec4(position, 0.0, 1.0);\n        }\n    "),l=_(e.FRAGMENT_SHADER,"#version 300 es\n    precision highp float;\n    \n    uniform vec3 _uiResolution;\n    uniform sampler2D _uiChannel0;\n    \n    in vec2 vTexCoord;\n    out vec4 fragColor;\n    \n    float _uhardScan = -8.0;\n    float _uhardPix = -3.0;\n    vec2 _uwarp = vec2(0.03125, 0.0416666679);\n    float _umaskDark = 0.5;\n    float _umaskLight = 1.5;\n    \n    float _uToLinear1(in float _uc){\n      return _uc <= 0.04045 ? (_uc / 12.92) : pow((_uc + 0.055) / 1.055, 2.4);\n    }\n    vec3 _uToLinear(in vec3 _uc){\n      return vec3(_uToLinear1(_uc.r), _uToLinear1(_uc.g), _uToLinear1(_uc.b));\n    }\n    float _uToSrgb1(in float _uc){\n      return _uc < 0.0031308 ? (_uc * 12.92) : (1.055 * pow(_uc, 1.0 / 2.4) - 0.055);\n    }\n    vec3 _uToSrgb(in vec3 _uc){\n      return vec3(_uToSrgb1(_uc.r), _uToSrgb1(_uc.g), _uToSrgb1(_uc.b));\n    }\n    \n    vec3 _uFetch(in vec2 _pos, in vec2 _off){\n      vec2 p = floor((_pos * (_uiResolution.xy / 6.0)) + _off) / (_uiResolution.xy / 6.0);\n      if (max(abs(p.x - 0.5), abs(p.y - 0.5)) > 0.5) return vec3(0.0);\n      return _uToLinear(texture(_uiChannel0, p).rgb);\n    }\n    \n    vec2 _uDist(in vec2 _pos){\n      vec2 p = _pos * (_uiResolution.xy / 6.0);\n      return -(p - floor(p) - vec2(0.5));\n    }\n    \n    float _uGaus(float x, float scale){\n      return exp2(scale * x * x);\n    }\n    \n    vec3 _uHorz3(vec2 pos, float off){\n      vec3 b = _uFetch(pos, vec2(-1.0, off));\n      vec3 c = _uFetch(pos, vec2(0.0, off));\n      vec3 d = _uFetch(pos, vec2(1.0, off));\n      float dst = _uDist(pos).x;\n      float wb = _uGaus(dst - 1.0, _uhardPix);\n      float wc = _uGaus(dst, _uhardPix);\n      float wd = _uGaus(dst + 1.0, _uhardPix);\n      return (b * wb + c * wc + d * wd) / (wb + wc + wd);\n    }\n    \n    vec3 _uHorz5(vec2 pos, float off){\n      vec3 a = _uFetch(pos, vec2(-2.0, off));\n      vec3 b = _uFetch(pos, vec2(-1.0, off));\n      vec3 c = _uFetch(pos, vec2(0.0, off));\n      vec3 d = _uFetch(pos, vec2(1.0, off));\n      vec3 e = _uFetch(pos, vec2(2.0, off));\n      float dst = _uDist(pos).x;\n      float wa = _uGaus(dst - 2.0, _uhardPix);\n      float wb = _uGaus(dst - 1.0, _uhardPix);\n      float wc = _uGaus(dst, _uhardPix);\n      float wd = _uGaus(dst + 1.0, _uhardPix);\n      float we = _uGaus(dst + 2.0, _uhardPix);\n      return (a * wa + b * wb + c * wc + d * wd + e * we) / (wa + wb + wc + wd + we);\n    }\n    \n    float _uScan(vec2 pos, float off){\n      float dst = _uDist(pos).y;\n      return _uGaus(dst + off, _uhardScan);\n    }\n    \n    vec3 _uTri(vec2 pos){\n      vec3 a = _uHorz3(pos, -1.0);\n      vec3 b = _uHorz5(pos,  0.0);\n      vec3 c = _uHorz3(pos,  1.0);\n      float wa = _uScan(pos, -1.0);\n      float wb = _uScan(pos,  0.0);\n      float wc = _uScan(pos,  1.0);\n      return a * wa + b * wb + c * wc;\n    }\n    \n    vec2 _uWarp(vec2 pos){\n      pos = pos * 2.0 - 1.0;\n      pos *= vec2(1.0 + pos.y * pos.y * _uwarp.x, 1.0 + pos.x * pos.x * _uwarp.y);\n      return pos * 0.5 + 0.5;\n    }\n    \n    vec3 _uMask(vec2 pos){\n      pos.x += pos.y * 3.0;\n      vec3 mask = vec3(_umaskDark);\n      float frac = fract(pos.x / 6.0);\n      if (frac < 0.333) mask.r = _umaskLight;\n      else if (frac < 0.666) mask.g = _umaskLight;\n      else mask.b = _umaskLight;\n      return mask;\n    }\n    \n    float _uBar(float pos, float bar){\n      pos -= bar;\n      return (pos * pos < 4.0) ? 0.0 : 1.0;\n    }\n    \n   void main() {\n  vec2 fragCoord = vTexCoord * _uiResolution.xy;\n  vec4 fragColorLinear = vec4(0.0);\n\n  // Treat the whole screen as View 3\n  vec2 pos = _uWarp(fragCoord / _uiResolution.xy);\n\n  _uhardScan = -12.0;\n  _umaskDark = _umaskLight = 1.0;\n\n  fragColorLinear.rgb = _uTri(pos) * _uMask(fragCoord.xy);\n  fragColorLinear.a = 1.0;\n\n  fragColor = vec4(_uToSrgb(fragColorLinear.rgb), 1.0);\n}\n    ");if(n=e.createProgram(),e.attachShader(n,a),e.attachShader(n,l),e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS))throw new Error(e.getProgramInfoLog(n));e.useProgram(n),o=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e.STATIC_DRAW);var c=e.getAttribLocation(n,"position");e.enableVertexAttribArray(c),e.vertexAttribPointer(c,2,e.FLOAT,!1,0,0),r=e.getUniformLocation(n,"_uiChannel0"),i=e.getUniformLocation(n,"_uiResolution"),s=e.createTexture(),e.bindTexture(e.TEXTURE_2D,s),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.createFramebuffer()}(),t.width=p,t.height=f,e.viewport(0,0,p,f),e.useProgram(n),e.bindBuffer(e.ARRAY_BUFFER,o),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,s),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,c,u,0,e.RGBA,e.UNSIGNED_BYTE,a.data),e.uniform1i(r,0),e.uniform3f(i,p,f,1),e.drawArrays(e.TRIANGLES,0,6);var h=new Uint8ClampedArray(p*f*4);return e.readPixels(0,0,p,f,e.RGBA,e.UNSIGNED_BYTE,h),new ImageData(h,p,f)}}()}}]);