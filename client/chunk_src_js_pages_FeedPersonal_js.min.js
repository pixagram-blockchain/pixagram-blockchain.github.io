"use strict";(self.webpackChunkpixagram_io=self.webpackChunkpixagram_io||[]).push([["src_js_pages_FeedPersonal_js"],{74979:(e,t,s)=>{s.a(e,(async(e,i)=>{try{s.d(t,{default:()=>b});var o=s(17402),_=s(86982),n=s(79626),r=s(69205),l=s(69232),a=s(85340),c=s(61990),h=s(78725),d=s(23563),p=s(9372),m=s(24488),u=s(40497),g=s(28379),f=e([c,h,u,g]);[c,h,u,g]=f.then?(await f)():f;class w extends a.a{_getEstimatedTotalHeight(){const{cellCount:e,cellMeasurerCache:t,width:s}=this.props,i=Math.floor(s/(t||{}).defaultWidth||0),o=this._positionCache.estimateTotalHeight(e,i,(t||{}).defaultHeight||0);return isFinite(o)?o:0}}const y=e=>({mainFab:{animation:"$slideInFromBottom 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","@global":{"@keyframes slideInFromBottom":{"0%":{transform:"translateY(160px)",filter:"opacity(0)"},"100%":{transform:"translateY(0px)",filter:"opacity(1)"}}},position:"fixed",right:16,bottom:16,transition:"transform 225ms cubic-bezier(0.4, 0, 0.2, 1) 75ms","& .MuiButtonBase-root":{borderRadius:"32px",background:"#f6f6f6",transition:"background 225ms cubic-bezier(0.4, 0, 0.2, 1) 75ms",mixBlendMode:"overlay","& .MuiTouchRipple-root":{filter:"opacity(1)","& .MuiTouchRipple-child":{backgroundImage:"\n                      radial-gradient(circle at 50% 50%,\n                        magenta 0%, blue 20%, cyan 40%, green 60%, yellow 80%, red 100%)"}}},"& .MuiButtonBase-root:hover":{background:"white",transition:"background 225ms cubic-bezier(0.4, 0, 0.2, 1) 5ms"},"& .MuiFab-extended":{padding:"0 24px",height:64,fontSize:"1.125rem"},"& .MuiFab-extended .MuiSvgIcon-root":{fontSize:"1.75rem"}},masonry:{overflow:"hidden overlay !important",contain:"style layout","& > .ReactVirtualized__Masonry":{zIndex:0,position:"absolute",margin:0,scrollBehavior:"smooth",overscrollBehavior:"none",boxSizing:"content-box !important",touchAction:"pan-y",overflow:"hidden overlay !important",willChange:"scroll-position !important","& > .ReactVirtualized__Masonry__innerScrollContainer":{top:"auto !important",left:"auto !important",contentVisibility:"auto",overflow:"initial !important",position:"absolute !important",paddingBottom:"48px",boxSizing:"content-box"}}}});class x extends o.PureComponent{constructor(e){super(e),this.st4te={classes:e.classes,_settings:e.settings,_history:_.Vv,_pathname:e.pathname,_image_name_infographics:"",_infographics_fadein_time:300,_infographics_in:!0,_bii3_opacity:1,_join_now_button_update:0,_less_than_960w:!0,_less_than_690h:!0,menuCardXY:[],menuCardData:{},authors:[],_scrolling_reset_time_interval:380,_min_col_width:180,_max_col_width:1280,_root_width:0,_root_height:0,_root:null,_window_width:0,_window_height:0,_average_img_ratio:1,_gutter_size:16,column_count:1,_column_width:640,_load_more_threshold:2e3,_overscan_by_pixels:9e3,_cell_positioner:null,_cell_positioner_config:null,_masonry:null,_cell_measurer_cache:null,_scroll_top:0,_intervals:[],_y:0,_top_scroll_of_el_by_index:[],_last_scroll_check_height:0,_height_of_el_by_index:[],_x_y_of_el_by_index:[],_selected_post_index:0,_post_closed_at:0,_posts:[],_create_artwork_dialog_open:!1,_artwork_open:!1,_post:{}}}componentWillMount(){window.addEventListener("resize",this._updated_dimensions),r.qf(),r.wn(0),setTimeout((()=>{r.wn(100)}),300);const e=setInterval(this._handle_masonry_scroll,this.st4te._scrolling_reset_time_interval,{passive:!0});this.setSt4te({_intervals:[e]})}setSt4te(e,t){e=e||{},this.st4te=Object.assign(this.st4te,e),"function"==typeof t&&t()}componentDidMount(){this._updated_dimensions(),o.default.findDOMNode(this).addEventListener("keydown",this._handle_keydown),(0,l.A)((()=>s.e("src_js_data_authors_js").then(s.bind(s,60209)))).then((e=>{const t=e.default();(0,l.A)((()=>s.e("src_js_data_posts_js").then(s.bind(s,65138)))).then((e=>{const s=e.default();this.setSt4te({_posts:s.map((e=>(e.author=t[e.author],e)))},(()=>{this.forceUpdate((()=>{this._updated_dimensions()}))}))}))}))}_updated_dimensions=(e=Date.now())=>{let t=document.documentElement,s=document.body||document.getElementsByTagName("body")[0],i=window.innerWidth||t.clientWidth||s.clientWidth,o=window.innerHeight||t.clientHeight||s.clientHeight;const _=Boolean(i<960),n=Boolean(o<690),r=this.st4te._less_than_960w!==_||this.st4te._less_than_690h!==n;this.st4te._window_width;this.setSt4te({_window_width:i,_window_height:o,_load_more_threshold:o*(o/i)*2},(()=>{this.forceUpdate((()=>{const{_root:t,_gutter_size:s,_window_width:i,_window_height:o,data:_}=this.st4te;let{_column_count:n}=this.st4te;if(t){const _=t.getBoundingClientRect(),r=_.width,l=_.height;if(i<100||r<100||l<100||o<100)setTimeout((()=>{this._updated_dimensions(e)}),250);else{n=1;const e=Math.floor((_.width-(n+1)*s)/n);this.setSt4te({_overscan_by_pixels:o*(o/i)*8,_column_width:Math.min(e,720),_column_count:n,_root_width:r,_root_height:l},(()=>{this._init_cell_measurements((()=>{this.setSt4te({_is_resizing:!1})}))}))}}}))})),r&&this.setSt4te({_less_than_960w:_,_less_than_690h:n,_window_width:i,_window_height:o},(()=>{this.forceUpdate()}))};componentWillReceiveProps(e){const t=e.settings._renderer!==this.st4te._settings._renderer,s=e.settings._nsfw_enabled!==this.st4te._settings._nsfw_enabled;this.setSt4te({_settings:e.settings},(()=>{(t||s)&&this.forceUpdate((()=>{this.st4te._masonry.forceUpdate()}))}))}componentWillUnmount(){this.st4te._intervals.forEach((e=>{clearInterval(e)}));try{window.removeEventListener("resize",this._updated_dimensions)}catch(e){}try{o.default.findDOMNode(this).removeEventListener("keydown",this._handle_keydown)}catch(e){}}_recompute_cell_measurements=(e=()=>{})=>{const{_cell_measurer_cache:t,_masonry:s,_cell_positioner:i,_column_count:o,_gutter_size:_,_column_width:n}=this.st4te;if(null!=t&&null!=s&&null!=i){t.clearAll(),t.visible_ids={};let r={cellMeasurerCache:t,columnCount:o,columnWidth:n,spacer:_};i.reset(r),s.clearCellPositions(),this.setSt4te({_cell_positioner:i,_cell_positioner_config:r,_cell_measurer_cache:t},(()=>{s.forceUpdate(e)}))}else this._init_cell_measurements(e)};_set_masonry_ref=e=>{null!==e&&this.setSt4te({_masonry:e},(()=>{this._init_cell_measurements()}))};_set_root_ref=e=>{null!==e&&this.setSt4te({_root:e})};_cell_renderer=e=>{const{index:t,key:s,parent:i,style:_,isScrolling:n}=e,{_root_height:r,_root_width:l,_masonry:c,_column_width:d,_cell_measurer_cache:p,_column_count:m,_settings:u,_selected_post_index:g}=this.st4te;if(void 0===c.props.itemsWithSizes[0|t])return;const{item:f,size:w}=c.props.itemsWithSizes[0|t],y=c._scrollingContainer.scrollTop,x=g===t;if(!w.height)return;const b=t%m,v=(t-b)/m,k=Math.ceil(d*(w.height/w.width))||0;_.width=0+d;let{_top_scroll_of_el_by_index:C,_height_of_el_by_index:S,_x_y_of_el_by_index:M}=this.st4te;const z=0+_.top,E=0+_.height,U=z+E;C[t]=z,S[t]=E,M[t]=[v,b];const W=2*r*(r/l),T=W+U>y&&z<y+r+W;p.visible_ids[w.id]=T||p.visible_ids[w.id]||!1;const B=u._selected_locales_code;return this.setSt4te({_top_scroll_of_el_by_index:C,_height_of_el_by_index:S}),o.createElement(a.dl,{cache:p,index:t,key:s,parent:i},o.createElement(h.A,{onOpen:this._open_artwork,locales:B,nsfw:u._nsfw_enabled,data:f,renderer:u._renderer,onMenuClick:this.openCardMenu,is_scrolling:n,selected:x,size:w,visible:p.visible_ids[w.id],column_width:d,image_height:k,image_width:d,id:w.id,key:s,rowIndex:v,columnIndex:b,style:_}))};_init_cell_measurements=(e=()=>{})=>{this.forceUpdate((()=>{if(null!=this.st4te._cell_measurer_cache&&null!=this.st4te._cell_positioner_config&&null!=this.st4te._cell_positioner)this._recompute_cell_measurements(e);else{const{_column_count:t,_column_width:s,_gutter_size:i}=this.st4te;let o=new a.jS({defaultHeight:600,defaultWidth:s,fixedWidth:!0,minHeight:144});o.visible_ids={};let _={cellMeasurerCache:o,columnCount:t,columnWidth:s,spacer:i},n=(0,a.wT)(_);this.setSt4te({_cell_measurer_cache:o,_cell_positioner:n,_cell_positioner_config:_},(()=>{this.forceUpdate((()=>{const t=(e=()=>{})=>{const{_masonry:s}=this.st4te;s?s.forceUpdate(e):setTimeout((()=>{t(e)}),5)};t(e)}))}))}}))};_next_current_post=()=>{const{_post:e,_posts:t,_masonry:s}=this.st4te,i=t.map((e=>e.id)).indexOf(e.id)+1,o=Math.max(0,Math.min(t.length-1,i)),{item:_,size:n}=s.props.itemsWithSizes[0|o];this.setSt4te({_post:_},(()=>{this.forceUpdate(),this._update_selected_post_index(o)}))};_previous_current_post=()=>{const{_post:e,_posts:t,_masonry:s}=this.st4te,i=t.map((e=>e.id)).indexOf(e.id)-1,o=Math.max(0,Math.min(t.length-1,i)),{item:_,size:n}=s.props.itemsWithSizes[0|o];this.setSt4te({_post:_},(()=>{this.forceUpdate(),this._update_selected_post_index(o)}))};_update_selected_post_index=(e,t=!1)=>{const{_post:s,_posts:i,_masonry:o}=this.st4te;if(!o)return;const _=o.props.itemsWithSizes,n=void 0!==e?e:s?i.map((e=>(e||{}).title)).indexOf(s.title):this.st4te._selected_post_index;this.setSt4te({_selected_post_index:n,_post:i[n],_post_img:(_[n]||{}).size},(()=>{this.forceUpdate((()=>{t?o.forceUpdate():this._scroll_to_index()}))}))};_scroll_to=e=>{const{_masonry:t}=this.st4te;t&&(void 0===e?(t._scrollingContainer.scrollTop=this.st4te._scroll_top,t.forceUpdate()):this.setSt4te({_scroll_top:e},(()=>{t._scrollingContainer.scrollTop=e,t.forceUpdate()})))};_scroll_to_index=e=>{const{_selected_post_index:t,_top_scroll_of_el_by_index:s,_height_of_el_by_index:i,_root_height:o}=this.st4te;let _=s[e=void 0!==e?e:t]+i[e]/2-o/3;this._scroll_to(_)};_handle_masonry_scroll=e=>{const{_load_more_threshold:t,_loading_posts:s}=this.st4te,{_masonry:i,_scroll_top:o,_y:_,_overscan_by_pixels:n}=this.st4te,r=i&&i._scrollingContainer?i._scrollingContainer.scrollTop:0,l=r-o,a=this.st4te._last_scroll_check_height+l,c=Math.abs(a)>n,h=Math.min(Math.max(-64,_-l),64);o===r&&_===h||this.setSt4te({_scroll_top:r,_y:h,_last_scroll_check_height:a},(()=>{(_!==h||c)&&this.setSt4te({_last_scroll_check_height:0},(()=>{this.forceUpdate()}))}))};openCardMenu=(e,t)=>{this.setSt4te({menuCardXY:Int32Array.of(e.x-24,e.y-24),menuCardData:t},(()=>{this.forceUpdate()}))};closeCardMenu=()=>{this.setSt4te({menuCardXY:Int32Array.of(0,0),menuCardData:{}},(()=>{this.forceUpdate()}))};_open_create_artwork=()=>{this.setSt4te({_create_artwork_dialog_open:!0},(()=>{this.forceUpdate()}))};_create_artwork_dialog_close=()=>{this.setSt4te({_create_artwork_dialog_open:!1},(()=>{this.forceUpdate()}))};_open_artwork=e=>{this.setSt4te({_artwork_open:!0,_post:e},(()=>{this.forceUpdate()}))};_close_artwork=()=>{this.setSt4te({_artwork_open:!1,_post:{}},(()=>{this.forceUpdate()}))};render(){const{classes:e,_settings:t}=this.st4te;let{_less_than_960w:s,_less_than_690h:i,_column_width:_,menuCardXY:n,menuCardData:r}=this.st4te,{_artwork_open:l,_post:a}=this.st4te;const{_window_width:h,_window_height:f,_cell_positioner:y,_cell_measurer_cache:x,_overscan_by_pixels:b,_y:v,_scroll_top:k,_posts:C,_create_artwork_dialog_open:S,_scrolling_reset_time_interval:M}=this.st4te,z=f,E=h>960?h-284:h,U=Math.round((E-_)/2),W=E-2*U,T=z-16,B=t._selected_locales_code;return o.createElement(o.Fragment,null,o.createElement("div",{ref:this._set_root_ref},o.createElement(c.A,{className:e.masonry,items:C,image:e=>e.image,keyMapper:e=>e.id},(e=>o.createElement(w,{style:{padding:`16px ${U}px 0px ${U}px`},key:"masonry-extended",scrollTop:k,scrollingResetTimeInterval:M,height:T,cellCount:0|(e||[]).length,itemsWithSizes:e,keyMapper:t=>e[t].size.id,cellMeasurerCache:x,cellPositioner:y,cellRenderer:this._cell_renderer,overscanByPixels:b,ref:this._set_masonry_ref,width:W})))),o.createElement("div",{onClick:this._open_create_artwork,className:e.mainFab,style:{transform:`translateY(${0<v&&k>512?96:0}px)`}},o.createElement(m.A,{variant:"extended",size:"large"},o.createElement(p.A,{style:{marginRight:12}}),o.createElement("span",null,"CREATE"))),o.createElement(d.A,{xy:n,data:r,onClose:this.closeCardMenu}),o.createElement(u.A,{keepMounted:!0,open:S,onClose:this._create_artwork_dialog_close}),o.createElement(g.A,{renderer:t._renderer,nsfw:t._nsfw_enabled,format:t._format,data:a,open:l,locales:B,onClose:this._close_artwork,onPrevious:this._previous_current_post,onNext:this._next_current_post}))}}const b=(0,n.default)(y)(x);i()}catch(e){i(e)}}))}}]);