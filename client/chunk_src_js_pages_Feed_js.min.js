"use strict";(self.webpackChunkpixagram_io=self.webpackChunkpixagram_io||[]).push([["src_js_pages_Feed_js"],{72339:(e,t,s)=>{s.a(e,(async(e,o)=>{try{s.d(t,{default:()=>C});var i=s(17402),n=s(86982),_=s(79626),r=s(69205),a=s(69232),l=s(85340),c=s(61990),h=s(78725),p=s(67264),m=s(16594),f=s(23563),u=s(9372),g=s(24488),b=s(40497),x=s(28379),w=e([c,h,b,x]);[c,h,b,x]=w.then?(await w)():w;class y extends l.a{_getEstimatedTotalHeight(){const{cellCount:e,cellMeasurerCache:t,width:s}=this.props,o=Math.floor(s/(t||{}).defaultWidth||0),i=this._positionCache.estimateTotalHeight(e,o,(t||{}).defaultHeight||0);return isFinite(i)?i:0}}const k=e=>({mainTab:{animation:"$slideInFromTop 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","@global":{"@keyframes slideInFromTop":{"0%":{transform:"translateY(-96px)",filter:"opacity(0)"},"100%":{transform:"translateY(0px)",filter:"opacity(1)"}}},backgroundColor:"#101010","& .MuiTab-textColorPrimary.Mui-selected":{backgroundColor:"transparent"},"& .MuiTab-textColorPrimary.Mui-selected .MuiTab-wrapper":{color:"#101010 !important"},"& .MuiTab-fullWidth":{backgroundColor:"transparent",color:"#989898",transition:"all 225ms cubic-bezier(0.4, 0, 0.2, 1) 0ms",borderRadius:"21px"},"& .MuiTab-fullWidth:hover":{backgroundColor:"rgba(255,255,255,0.06)"},"& span.MuiTabs-indicator":{zIndex:"-1",height:"48px",backgroundColor:"#c7c7c7",borderRadius:"21px",transform:"scale3d(0.875, 0.75, 1)"},margin:"21px 16px 21px 16px",width:"calc(100% - 32px)",borderRadius:"21px",position:"absolute",top:0,left:0,zIndex:1,transition:"transform 225ms cubic-bezier(0.4, 0, 0.2, 1) 75ms"},mainFab:{animation:"$slideInFromBottom 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms","@global":{"@keyframes slideInFromBottom":{"0%":{transform:"translateY(160px)",filter:"opacity(0)"},"100%":{transform:"translateY(0px)",filter:"opacity(1)"}}},position:"fixed",right:16,bottom:16,transition:"transform 225ms cubic-bezier(0.4, 0, 0.2, 1) 75ms","& .MuiButtonBase-root":{borderRadius:"32px",background:"#f6f6f6",transform:"scale(1)",animationName:"$bounce-feed",animationTimingFunction:"cubic-bezier(0.4, 0, 0.2, 1)",animationDuration:"3.2s",animationFillMode:"both",animationDelay:"1s",animationIterationCount:"infinite",boxShadow:"0 0 8px #ffffff88, 0 0 16px #ffffffcc","@global":{"@keyframes bounce-feed":{"0%":{boxShadow:"0 0 8px #ffffff88, 0 0 16px #ffffffcc",transform:"scale(1)"},"3%":{boxShadow:"0 0 12px #ffffff88, 0 0 24px #ffffffcc",transform:"scale(1.05)"},"6%":{boxShadow:"0 0 4px #ffffff88, 0 0 8px #ffffffcc",transform:"scale(0.975)"},"9%":{boxShadow:"0 0 8px #ffffff88, 0 0 16px #ffffffcc",transform:"scale(1)"}}},transition:"background 225ms cubic-bezier(0.4, 0, 0.2, 1) 75ms","& .MuiTouchRipple-root":{filter:"opacity(1)","& .MuiTouchRipple-child":{backgroundImage:"\n                      radial-gradient(circle at 50% 50%,\n                        magenta 0%, blue 20%, cyan 40%, green 60%, yellow 80%, red 100%)"}}},"& .MuiButtonBase-root:hover":{background:"#ffffff",boxShadow:"0 0 8px #ffffff88, 0 0 16px #ffffffcc"},"& .MuiTouchRipple-child":{backgroundImage:"\n            radial-gradient(\n              circle at 50% 50% in hsl shorter hue,\n              #f000ff6b, #0095ffdb, #0cffe9ba, #d8ff00b5, #f59300c2, #6f0000c7, transparent, transparent\n            )"},"& .MuiFab-extended":{padding:"0 24px",height:64,fontSize:"1.125rem"},"& .MuiFab-extended .MuiSvgIcon-root":{fontSize:"1.75rem"}},masonry:{overflow:"hidden overlay !important",contain:"style layout","& > .ReactVirtualized__Masonry":{zIndex:0,position:"absolute",margin:0,scrollBehavior:"smooth",willChange:"scroll-position !important",overscrollBehavior:"none",contentVisibility:"auto",boxSizing:"content-box !important",touchAction:"pan-y",overflow:"hidden overlay !important",padding:"86px 12px 32px 16px",contain:"style layout size","& > .ReactVirtualized__Masonry__innerScrollContainer":{top:"auto !important",left:"auto !important",overflow:"initial !important",position:"absolute !important",paddingBottom:"48px",boxSizing:"content-box",contain:"style layout size","& div":{contain:"style layout paint"}}}}});class v extends i.PureComponent{constructor(e){super(e),this.st4te={classes:e.classes,_settings:e.settings,_history:n.Vv,_pathname:e.pathname,_image_name_infographics:"",_infographics_fadein_time:300,_infographics_in:!0,_bii3_opacity:1,_join_now_button_update:0,_less_than_960w:!0,_less_than_690h:!0,sorting:0,menuCardXY:[],menuCardData:{},authors:[],_scrolling_reset_time_interval:380,_min_col_width:10,_max_col_width:1e3,_root_width:0,_root_height:0,_root:null,_window_width:0,_window_height:0,_average_img_ratio:1,_gutter_size:16,column_count:4,_column_width:356,_load_more_threshold:2e3,_overscan_by_pixels:6e3,_cell_positioner:null,_cell_positioner_config:null,_masonry:null,_cell_measurer_cache:null,_scroll_top:0,_intervals:[],_y:0,_top_scroll_of_el_by_index:[],_last_scroll_check_height:0,_height_of_el_by_index:[],_x_y_of_el_by_index:[],_selected_post_index:0,_post_closed_at:0,_posts:[],_create_artwork_dialog_open:!1,_artwork_open:null,_post:{}}}componentWillMount(){window.addEventListener("resize",this._updated_dimensions),r.qf(),r.wn(0),setTimeout((()=>{r.wn(100)}),300);const e=setInterval(this._handle_masonry_scroll,this.st4te._scrolling_reset_time_interval,{passive:!0});this.setSt4te({_intervals:[e]})}setSt4te(e,t){e=e||{},this.st4te=Object.assign(this.st4te,e),"function"==typeof t&&t()}componentDidMount(){this._updated_dimensions(),i.findDOMNode(this).addEventListener("keydown",this._handle_keydown),(0,a.A)((()=>s.e("src_js_data_authors_js").then(s.bind(s,60209)))).then((e=>{const t=e.default();(0,a.A)((()=>s.e("src_js_data_posts_js").then(s.bind(s,65138)))).then((e=>{const s=e.default();this.setSt4te({_posts:s.map((e=>(e.author=t[e.author],e)))},(()=>{this.forceUpdate((()=>{this._updated_dimensions()}))}))}))}))}_updated_dimensions=()=>{let e=document.documentElement,t=document.body||document.getElementsByTagName("body")[0],s=window.innerWidth||e.clientWidth||t.clientWidth,o=window.innerHeight||e.clientHeight||t.clientHeight;const i=Boolean(s<960),n=Boolean(o<690),_=this.st4te._less_than_960w!==i||this.st4te._less_than_690h!==n;this.setSt4te({_window_width:s,_window_height:o,_load_more_threshold:o*(o/s)*2},(()=>{this.forceUpdate((()=>{const{_root:e,_gutter_size:t,_window_width:s,_window_height:o,data:i}=this.st4te;let{_column_count:n}=this.st4te;if(e){const i=e.getBoundingClientRect(),_=i.width,r=i.height;if(s<100||_<100||r<100||o<100)setTimeout((()=>{this._updated_dimensions(d)}),250);else{n=s>=1920?4:s>=1280?3:s>=768?2:1;const e=Math.floor((i.width-(n+1)*t)/n);this.setSt4te({_overscan_by_pixels:o*(o/s)*8,_column_width:e,_column_count:n,_root_width:_,_root_height:r},(()=>{this._init_cell_measurements((()=>{this.setSt4te({_is_resizing:!1})}))}))}}}))})),_&&this.setSt4te({_less_than_960w:i,_less_than_690h:n,_window_width:s,_window_height:o},(()=>{this.forceUpdate()}))};componentWillReceiveProps(e){const t=e.settings._renderer!==this.st4te._settings._renderer,s=e.settings._nsfw_enabled!==this.st4te._settings._nsfw_enabled;this.setSt4te({_settings:e.settings},(()=>{(t||s)&&this.forceUpdate((()=>{this.st4te._masonry.forceUpdate()}))}))}componentWillUnmount(){this.st4te._intervals.forEach((e=>{clearInterval(e)}));try{window.removeEventListener("resize",this._updated_dimensions)}catch(e){}try{i.findDOMNode(this).removeEventListener("keydown",this._handle_keydown)}catch(e){}}_recompute_cell_measurements=(e=()=>{})=>{const{_cell_measurer_cache:t,_masonry:s,_cell_positioner:o,_column_count:i,_gutter_size:n,_column_width:_}=this.st4te;if(null!=t&&null!=s&&null!=o){t.clearAll(),t.visible_ids={};let r={cellMeasurerCache:t,columnCount:i,columnWidth:_,spacer:n};o.reset(r),s.clearCellPositions(),this.setSt4te({_cell_positioner:o,_cell_positioner_config:r,_cell_measurer_cache:t},(()=>{s.forceUpdate(e)}))}else this._init_cell_measurements(e)};_set_masonry_ref=e=>{null!==e&&this.setSt4te({_masonry:e},(()=>{this._init_cell_measurements()}))};_set_root_ref=e=>{null!==e&&this.setSt4te({_root:e})};_cell_renderer=e=>{const{index:t,key:s,parent:o,style:n,isScrolling:_}=e,{_root_height:r,_root_width:a,_masonry:c,_column_width:d,_cell_measurer_cache:p,_column_count:m,_settings:f,_selected_post_index:u}=this.st4te;if(void 0===c.props.itemsWithSizes[0|t])return;const{item:g,size:b}=c.props.itemsWithSizes[0|t],x=c._scrollingContainer.scrollTop,w=u===t;if(!b.height)return;const y=t%m,k=(t-y)/m,v=Math.ceil(d*(b.height/b.width))||0;n.width=0+d;let{_top_scroll_of_el_by_index:C,_height_of_el_by_index:M,_x_y_of_el_by_index:S}=this.st4te;const z=0+n.top,E=0+n.height,T=z+E;C[t]=z,M[t]=E,S[t]=[k,y];const U=r*(r/a),W=U+T>x&&z<x+r+U;p.visible_ids[b.id]=W||p.visible_ids[b.id]||!1;const A=f._selected_locales_code;return this.setSt4te({_top_scroll_of_el_by_index:C,_height_of_el_by_index:M}),i.createElement(l.dl,{cache:p,index:t,key:s,parent:o},i.createElement(h.A,{onOpen:this._open_artwork,locales:A,nsfw:f._nsfw_enabled,data:g,renderer:f._renderer,onMenuClick:this.openCardMenu,is_scrolling:_,selected:w,size:b,visible:p.visible_ids[b.id],column_width:d,image_height:v,image_width:d,id:b.id,key:s,rowIndex:k,columnIndex:y,style:n}))};_init_cell_measurements=(e=()=>{})=>{this.forceUpdate((()=>{if(null!=this.st4te._cell_measurer_cache&&null!=this.st4te._cell_positioner_config&&null!=this.st4te._cell_positioner)this._recompute_cell_measurements(e);else{const{_column_count:t,_column_width:s,_gutter_size:o}=this.st4te;let i=new l.jS({defaultHeight:600,defaultWidth:s,fixedWidth:!0,minHeight:144});i.visible_ids={};let n={cellMeasurerCache:i,columnCount:t,columnWidth:s,spacer:o},_=(0,l.wT)(n);this.setSt4te({_cell_measurer_cache:i,_cell_positioner:_,_cell_positioner_config:n},(()=>{this.forceUpdate((()=>{const t=(e=()=>{})=>{const{_masonry:s}=this.st4te;s?s.forceUpdate(e):setTimeout((()=>{t(e)}),5)};t(e)}))}))}}))};_next_current_post=()=>{const{_post:e,_posts:t,_masonry:s}=this.st4te,o=t.map((e=>e.id)).indexOf(e.id)+1,i=Math.max(0,Math.min(t.length-1,o)),{item:n,size:_}=s.props.itemsWithSizes[0|i];this.setSt4te({_post:n},(()=>{this.forceUpdate(),this._update_selected_post_index(i)}))};_previous_current_post=()=>{const{_post:e,_posts:t,_masonry:s}=this.st4te,o=t.map((e=>e.id)).indexOf(e.id)-1,i=Math.max(0,Math.min(t.length-1,o)),{item:n,size:_}=s.props.itemsWithSizes[0|i];this.setSt4te({_post:n},(()=>{this.forceUpdate(),this._update_selected_post_index(i)}))};_handle_keydown=e=>{let{_masonry:t,_selected_post_index:s,_post_closed_at:o,_posts:i,_post_author:n,_post_permlink:_,_column_count:r,_x_y_of_el_by_index:a}=this.st4te;if(!n&&!_&&o+300<Date.now()){const t=s%r,o=(s-t)/r;let n=t,_=o;switch(e.keyCode){case 40:_+=1,e.preventDefault();break;case 38:_-=1,e.preventDefault();break;case 37:n-=1;break;case 39:n+=1}_===o&&n===t||a.forEach(((e,t)=>{e[1]===n&&_===e[0]&&(s=t)})),s=Math.max(0,Math.min(i.length-1,s)),13===e.keyCode||this.st4te._selected_post_index!==s&&this._update_selected_post_index(s)}};_update_selected_post_index=(e,t=!1)=>{const{_post:s,_posts:o,_masonry:i}=this.st4te;if(!i)return;const n=i.props.itemsWithSizes,_=void 0!==e?e:s?o.map((e=>(e||{}).title)).indexOf(s.title):this.st4te._selected_post_index;this.setSt4te({_selected_post_index:_,_post:o[_],_post_img:(n[_]||{}).size},(()=>{this.forceUpdate((()=>{t?i.forceUpdate():this._scroll_to_index()}))}))};_scroll_to=e=>{const{_masonry:t}=this.st4te;t&&(void 0===e?(t._scrollingContainer.scrollTop=this.st4te._scroll_top,t.forceUpdate()):this.setSt4te({_scroll_top:e},(()=>{t._scrollingContainer.scrollTop=e,t.forceUpdate()})))};_scroll_to_index=e=>{const{_selected_post_index:t,_top_scroll_of_el_by_index:s,_height_of_el_by_index:o,_root_height:i}=this.st4te;let n=s[e=void 0!==e?e:t]+o[e]/2-i/3;this._scroll_to(n)};_handle_masonry_scroll=e=>{const{_load_more_threshold:t,_loading_posts:s}=this.st4te,{_masonry:o,_scroll_top:i,_y:n,_overscan_by_pixels:_}=this.st4te,r=o&&o._scrollingContainer?o._scrollingContainer.scrollTop:0,a=r-i,l=this.st4te._last_scroll_check_height+a,c=Math.abs(l)>_/2,d=Math.min(Math.max(-64,n-a),64);i===r&&n===d||this.setSt4te({_scroll_top:r,_y:d,_last_scroll_check_height:l},(()=>{(n!==d||c)&&this.setSt4te({_last_scroll_check_height:0},(()=>{this.forceUpdate()}))}))};handle_sorting_change=(e,t)=>{this.st4te.sorting!==t?this.setSt4te({sorting:t},(()=>{this.forceUpdate((()=>{this._scroll_to(0)}))})):this._scroll_to(0)};openCardMenu=(e,t)=>{this.setSt4te({menuCardXY:Int32Array.of(e.x-24,e.y-24),menuCardData:t},(()=>{this.forceUpdate()}))};closeCardMenu=()=>{this.setSt4te({menuCardXY:Int32Array.of(0,0),menuCardData:{}},(()=>{this.forceUpdate()}))};_open_create_artwork=()=>{this.setSt4te({_create_artwork_dialog_open:!0},(()=>{this.forceUpdate()}))};_create_artwork_dialog_close=()=>{this.setSt4te({_create_artwork_dialog_open:!1},(()=>{this.forceUpdate()}))};_open_artwork=(e,t)=>{this.setSt4te({_artwork_open:!0,_post:e},(()=>{this.forceUpdate()}))};_close_artwork=()=>{this.setSt4te({_artwork_open:null,_post:{}},(()=>{this.forceUpdate()}))};render(){const{classes:e,_settings:t}=this.st4te;let{_less_than_960w:s,_less_than_690h:o,sorting:n,menuCardXY:_,menuCardData:r}=this.st4te,{_artwork_open:a,_post:l}=this.st4te;const{_window_width:d,_window_height:h,_cell_positioner:w,_cell_measurer_cache:k,_overscan_by_pixels:v,_y:C,_scroll_top:M,_posts:S,_create_artwork_dialog_open:z,_scrolling_reset_time_interval:E}=this.st4te,T=d>960?d-284-28:d-32,U=h-(d>960?96:64),W=t._selected_locales_code;return i.createElement(i.Fragment,null,i.createElement(m.A,{style:{transform:`translateY(${0>C&&M>72?-72:0}px)`},className:e.mainTab,value:n,variant:"fullWidth",indicatorColor:"primary",textColor:"primary",onChange:this.handle_sorting_change,fullwidth:!0},i.createElement(p.A,{label:"Created"}),i.createElement(p.A,{label:"Hot"}),i.createElement(p.A,{label:"Trending"}),i.createElement(p.A,{label:"Promoted"})),i.createElement("div",{ref:this._set_root_ref},i.createElement(c.A,{className:e.masonry,items:S,image:e=>e.image,keyMapper:e=>e.id},(e=>i.createElement(y,{key:"masonry-extended",scrollTop:M,scrollingResetTimeInterval:E,height:U,cellCount:0|(e||[]).length,itemsWithSizes:e,keyMapper:t=>e[t].size.id,cellMeasurerCache:k,cellPositioner:w,cellRenderer:this._cell_renderer,overscanByPixels:v,ref:this._set_masonry_ref,width:T})))),i.createElement("div",{onClick:this._open_create_artwork,className:e.mainFab,style:{transform:`translateY(${0<C&&M>512?96:0}px)`}},i.createElement(g.A,{variant:"extended",size:"large"},i.createElement(u.A,{style:{marginRight:12}}),i.createElement("span",null,"CREATE"))),i.createElement(f.A,{xy:_,data:r,onClose:this.closeCardMenu}),i.createElement(b.A,{keepMounted:!0,open:z,onClose:this._create_artwork_dialog_close}),i.createElement(x.A,{renderer:t._renderer,nsfw:t._nsfw_enabled,format:t._format,data:l,open:a,locales:W,onClose:this._close_artwork,onPrevious:this._previous_current_post,onNext:this._next_current_post}))}}const C=(0,_.default)(k)(v);o()}catch(e){o(e)}}))}}]);