/*! For license information please see chunk_vendors-node_modules_asaitama_boolean-array_index_js-node_modules_material-ui_core_esm_Fab_Fa-2425d1.min.js.LICENSE.txt */
(self.webpackChunkpixagram_io=self.webpackChunkpixagram_io||[]).push([["vendors-node_modules_asaitama_boolean-array_index_js-node_modules_material-ui_core_esm_Fab_Fa-2425d1"],{82803:t=>{var e=function(){function t(t,e){"use strict";return(0|(t=(0|t)>>>0))>>>0==(0|(e=(0|e)>>>0))>>>0}function e(t,e){"use strict";return((t=(0|t)>>>0)+(e=(0|e)>>>0)|0)>>>0}function i(t,e){"use strict";return((t=(0|t)>>>0)&(e=(0|e)>>>0))>>>0}function s(t,e){"use strict";return((t=(0|t)>>>0)|(e=(0|e)>>>0))>>>0}function n(t,e){"use strict";return((t=(0|t)>>>0)^(e=(0|e)>>>0))>>>0}function r(t){"use strict";return(0|t)>>>5}function a(t){"use strict";return(0|t)>>>0}var o=Uint32Array.of(1,2,4,8,16,32,64,128,256,512,1024,2048,4096,8192,16384,32768,65536,131072,262144,524288,1048576,2097152,4194304,8388608,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648),h=Uint32Array.of(4294967294,4294967293,4294967291,4294967287,4294967279,4294967263,4294967231,4294967167,4294967039,4294966783,4294966271,4294965247,4294963199,4294959103,4294950911,4294934527,4294901759,4294836223,4294705151,4294443007,4293918719,4292870143,4290772991,4286578687,4278190079,4261412863,4227858431,4160749567,4026531839,3758096383,3221225471,2147483647),u=Uint32Array.of(0,4294967295);function c(_){"use strict";return this instanceof c?(this.format_uint_=a,this.plus_uint_=e,this.uint_equal_=t,this.uint_bit_and_=i,this.uint_bit_or_=s,this.uint_bit_xor_=n,this.uint_bitwise_5_=r,_ instanceof c?this._data_=_.dataCopy:_ instanceof Uint32Array?this._data_=_:(_=(0|_)>>>0,this._data_=new Uint32Array(1+((_+32|0)>>>5)),this._data_[this._data_.length-1]=(0|_)>>>0),this._M_OR_=o,this._M_AND_=h,this._M_OPP_=u,this.buildTemporaryIndexesDataStore(),this._I_=new Uint32Array(11),this):new c(_)}Object.defineProperties(c.prototype,{idealConstructor:{get:function(){"use strict";return this.length>=65535?Uint32Array:this.length>=255?Uint16Array:Uint8Array}},buildTemporaryIndexesDataStore:{get:function(){"use strict";return function(){this._M_A_=new this.idealConstructor(32)}}},getMin:{get:function(){"use strict";return function(){for(this._I_[4]=0,this._I_[5]=this.length,this._I_[8]=this.getElement(this.uint_bitwise_5_(this._I_[4]));this._I_[4]<this._I_[5];this._I_[4]=this.plus_uint_(this._I_[4],32))if(!this.uint_equal_(this._I_[8],this._M_OPP_[0])&&(this._I_[3]=0,this._I_[7]=0,this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this._I_[7]>0))return this._M_A_[0];return-1}}},getMax:{get:function(){"use strict";return function(){for(this._I_[4]=this.length,this._I_[5]=0,this._I_[8]=this.getElement(this.uint_bitwise_5_(this._I_[4]));this._I_[4]>=this._I_[5];this._I_[4]=(this._I_[4]-32|0)>>>0)if(!this.uint_equal_(this._I_[8],this._M_OPP_[0])&&(this._I_[3]=0,this._I_[7]=0,this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this._I_[7]>0))return this._M_A_[this._I_[7]-1|0];return-1}}},countOnes:{get:function(){"use strict";return function(){for(this._I_[4]=0,this._I_[5]=this.length,this._I_[8]=this.getElement(this.uint_bitwise_5_(this._I_[4]));this._I_[4]<this._I_[5];this._I_[4]=this.plus_uint_(this._I_[4],32))this.uint_equal_(this._I_[8],this._M_OPP_[0])||(this.uint_equal_(this._I_[8],this._M_OPP_[1])?this._I_[6]=this.plus_uint_(this._I_[6],32):(this._I_[3]=0,this._I_[7]=0,this.readFourBytesCountByte(),this.readFourBytesCountByte(),this.readFourBytesCountByte(),this.readFourBytesCountByte(),this._I_[6]=this.plus_uint_(this._I_[6],this._I_[7])));return this.format_uint_(this._I_[6])}}},countZeros:{get:function(){"use strict";return function(){return this.format_uint_(this.length-this.countOnes())}}},readFourBytes:{get:function(){"use strict";return function(t,e,i){if(this._I_[4]=this.format_uint_(t),this._I_[9]=this.format_uint_(i),this._I_[3]=0,this._I_[7]=0,this._I_[8]=this.getElement(this.uint_bitwise_5_(this._I_[4])),this.uint_equal_(this._I_[8],this._M_OPP_[0]))return(0|this._I_[9])>>>0;if(this.uint_equal_(this._I_[8],this._M_OPP_[1])){if(void 0!==e)for(this._I_[10]=0;this._I_[10]<32;this._I_[10]=this.plus_uint_(this._I_[10],1))e[this.plus_uint_(this._I_[9],this._I_[10])]=this.plus_uint_(this._I_[4],this._I_[10]);return this.plus_uint_(this._I_[9],32)}return this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),this.readFourBytesCheckByte(),void 0!==e&&this._I_[7]>0&&e.set(this._M_A_.subarray(0,this._I_[7]),this._I_[9]),this.plus_uint_(this._I_[9],this._I_[7])}}},readFourBytesCountBit:{get:function(){"use strict";return function(){this.uint_equal_(this.uint_bit_and_(this._I_[8],this._M_OR_[this._I_[3]]),this._M_OR_[this._I_[3]])&&(this._I_[7]=this.plus_uint_(this._I_[7],1)),this._I_[3]=this.plus_uint_(this._I_[3],1)}}},readFourBytesCheckBit:{get:function(){"use strict";return function(){this.uint_equal_(this.uint_bit_and_(this._I_[8],this._M_OR_[this._I_[3]]),this._M_OR_[this._I_[3]])&&(this._M_A_[this._I_[7]]=this.plus_uint_(this._I_[4],this._I_[3]),this._I_[7]=this.plus_uint_(this._I_[7],1)),this._I_[3]=this.plus_uint_(this._I_[3],1)}}},readFourBytesCountByte:{get:function(){"use strict";return function(){this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit(),this.readFourBytesCountBit()}}},readFourBytesCheckByte:{get:function(){"use strict";return function(){this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit(),this.readFourBytesCheckBit()}}},getElement:{get:function(){"use strict";return function(t){return this._data_[t]}}},data:{get:function(){"use strict";return this._data_}},dataCopy:{get:function(){"use strict";return this._data_.slice(0,this._data_.length)}},readBit:{get:function(){"use strict";return function(t){return this._I_[0]=this.format_uint_(t),this._I_[1]=this.uint_bitwise_5_(this._I_[0]),this._I_[2]=this.uint_bit_and_(this._I_[0],31),this.uint_equal_(this.uint_bit_and_(this._data_[this._I_[1]],this._M_OR_[this._I_[2]]),this._M_OR_[this._I_[2]])}}},writeBit1:{get:function(){"use strict";return function(t){this._I_[0]=this.format_uint_(t),this._I_[1]=this.uint_bitwise_5_(this._I_[0]),this._I_[2]=this.uint_bit_and_(this._I_[0],31),this._data_[this._I_[1]]=this.uint_bit_or_(this._data_[this._I_[1]],this._M_OR_[this._I_[2]])}}},writeBit0:{get:function(){"use strict";return function(t){this._I_[0]=this.format_uint_(t),this._I_[1]=this.uint_bitwise_5_(this._I_[0]),this._I_[2]=this.uint_bit_and_(this._I_[0],31),this._data_[this._I_[1]]=this.uint_bit_and_(this._data_[this._I_[1]],this._M_AND_[this._I_[2]])}}},toggleBit:{get:function(){"use strict";return function(t){return this._I_[0]=this.format_uint_(t),this._I_[1]=this.uint_bitwise_5_(this._I_[0]),this._I_[2]=this.uint_bit_and_(this._I_[0],31),this.uint_equal_(this.uint_bit_and_(this._data_[this._I_[1]],this._M_OR_[this._I_[2]]),this._M_OR_[this._I_[2]])?(this._data_[this._I_[1]]=this.uint_bit_and_(this._data_[this._I_[1]],this._M_AND_[this._I_[2]]),!1):(this._data_[this._I_[1]]=this.uint_bit_or_(this._data_[this._I_[1]],this._M_OR_[this._I_[2]]),!0)}}},setFromBitArrayData:{get:function(){"use strict";return function(t){this._data_.length===t.length?this._data_.set(t):(this._data_=t instanceof Uint32Array?t.slice(0,t.length):Uint32Array.from(t),this.buildTemporaryIndexesDataStore())}}},invert:{get:function(){"use strict";return function(){for(var t=this._data_.length-1|0,e=0;(0|e)<(0|t);e=this.plus_uint_(e,1))this._data_[0|e]=~this._data_[0|e]}}},addFromArray:{get:function(){"use strict";return function(t,e,i,s){if(e=void 0===e?this._data_:e,void 0===i&&void 0===s)for(var n=Math.min(t.length,e.length,this._data_.length)-1,r=0;(0|r)<(0|n);r=this.plus_uint_(r,1))this._data_[0|r]=this.uint_bit_or_(e[0|r],t[0|r]);else if(void 0!==i&&void 0===s)for(n=Math.min(t.length,e.length,i.length,this._data_.length)-1,r=0;(0|r)<(0|n);r=this.plus_uint_(r,1))this._data_[0|r]=this.uint_bit_or_(this.uint_bit_or_(e[0|r],t[0|r]),i[0|r]);else for(n=Math.min(t.length,e.length,i.length,this._data_.length)-1,r=0;(0|r)<(0|n);r=this.plus_uint_(r,1))this._data_[0|r]=this.uint_bit_or_(this.uint_bit_or_(t[0|r],e[0|r]),this.uint_bit_or_(i[0|r],s[0|r]))}}},differentFromArray:{get:function(){"use strict";return function(t,e){e=void 0===e?this._data_:e;for(var i=Math.min(t.length,e.length,this._data_.length)-1,s=0;(0|s)<(0|i);s=this.plus_uint_(s,1))this._data_[0|s]=this.uint_bit_xor_(e[0|s],t[0|s])}}},sameFromArray:{get:function(){"use strict";return function(t,e){e=void 0===e?this._data_:e;for(var i=Math.min(t.length,e.length,this._data_.length)-1,s=0;(0|s)<(0|i);s=this.plus_uint_(s,1))this._data_[0|s]=this.uint_bit_and_(e[0|s],t[0|s])}}},clear:{get:function(){"use strict";return function(){this._data_.fill(0,0,this._data_.length-1)}}},charge:{get:function(){"use strict";return function(){this._data_.fill(4294967295,0,this._data_.length-1)}}},length:{get:function(){"use strict";return this._data_[this._data_.length-1]}},resize:{get:function(){"use strict";return function(t){if(t=Math.max(2,(0|t)>>>0),this.length!==t){var e=this._data_,i=new Uint32Array(1+((t+32|0)>>>5));i[i.length-1]=(0|t)>>>0,i.set(e.subarray(0,Math.min(e.length-1,i.length-1))),this._data_=i,this.buildTemporaryIndexesDataStore()}}}},resizeToMax:{get:function(){"use strict";return function(){this.resize(this.getMax())}}}});var _=function(i){"use strict";if(!(this instanceof _))return new _(i);if(this.format_uint_=a,this.plus_uint_=e,this.uint_equal_=t,this._VA_=Uint32Array.of(0),i instanceof _)this._ba_=i.bitArrayCopy,this._VA_.fill(i.size);else if(i instanceof c)this._ba_=i,this._VA_[0]=this._ba_.countOnes();else if("object"==typeof i){this._max_=0,this._c_=null,i instanceof Uint8ClampedArray||i instanceof Uint8Array||i instanceof Uint16Array||i instanceof Uint32Array?(this._set_=new Set(i),this._VA_[0]=this._set_.size,this._c_=i instanceof Uint32Array?Uint32Array:i instanceof Uint16Array?Uint16Array:Uint8Array,this._indexes_=this._c_.from(this._set_)):(i instanceof Set?this._set_=i:this._set_=new Set(i),this._VA_[0]=this._set_.size,this._indexes_=Uint32Array.from(this._set_));for(var s=0,n=0|this._indexes_.length;this.format_uint_(s)<this.format_uint_(n);s=this.plus_uint_(s,1))this.format_uint_(this._max_)<this.format_uint_(this._indexes_[this.format_uint_(s)])&&(this._max_=this.format_uint_(this._indexes_[this.format_uint_(s)]));this._ba_=new c(this._max_);for(s=0,n=0|this._indexes_.length;this.format_uint_(s)<this.format_uint_(n);s=this.plus_uint_(s,1))this._ba_.writeBit1(this.format_uint_(this._indexes_[this.format_uint_(s)]));delete this._set_,delete this._indexes_,delete this._max_,delete this._c_}else this._ba_=new c(0|i),this._VA_[0]=0;return this.bindInnerMethods(),this};return _.compute=function(t,e,i){for(var s=t.bitArrayData,n=e.map((function(t){return t.bitArrayData})),r=s.length-1|0,a=0,o=new Uint32Array(n.length);(0|a)<(0|r);a=this.plus_uint_(a,1))o.set(n.map((function(t){"use strict";return t[0|a]}))),s[0|a]=i.apply(i,o);t.computeSize()},_.import=function(t){return new _(new c(t))},Object.defineProperties(_.prototype,{bindInnerMethods:{get:function(){"use strict";return function(){this.readbit_=this._ba_.readBit.bind(this._ba_),this.read4bytes_=this._ba_.readFourBytes.bind(this._ba_),this.write1_=this._ba_.writeBit1.bind(this._ba_),this.write0_=this._ba_.writeBit0.bind(this._ba_)}}},bitArrayCopy:{get:function(){"use strict";return new c(this.bitArrayDataCopy)}},bitArrayData:{get:function(){"use strict";return this.bitArray.data}},bitArrayDataCopy:{get:function(){"use strict";var t=this.bitArrayData;return t.slice(0,t.length)}},bitArray:{get:function(){"use strict";return this._ba_}},size:{get:function(){"use strict";return this.format_uint_(this._VA_[0])}},length:{get:function(){"use strict";return this.format_uint_(this._ba_.length)}},idealConstructor:{get:function(){"use strict";return this._ba_.idealConstructor}},indexes:{get:function(){"use strict";for(var t=new this.idealConstructor(this.size),e=Uint32Array.of(0|this.length,0,0);e[1]<e[0];e[1]=this.plus_uint_(e[1],32))e[2]=this.read4bytes_(e[1],t,e[2]);return t}},export:{get:function(){"use strict";return function(t){return(t=void 0!==t&&Boolean(t))?this.bitArrayDataCopy:this.bitArrayData}}},has:{get:function(){"use strict";return function(t){return this.readbit_(this.format_uint_(t))}}},hasnt:{get:function(){"use strict";return function(t){return!this.readbit_(this.format_uint_(t))}}},add:{get:function(){"use strict";return function(t){t=this.format_uint_(t),(0|this.length)<(0|t)&&this._ba_.resize(t+t|0),this.hasnt(t)&&(this._VA_[0]=this.plus_uint_(this._VA_[0],1),this.write1_(t))}}},addUnsafe:{get:function(){"use strict";return function(t){t=this.format_uint_(t),this.hasnt(t)&&(this._VA_[0]=this.plus_uint_(this._VA_[0],1),this.write1_(t))}}},delete:{get:function(){"use strict";return function(t){t=this.format_uint_(t),this.has(t)&&(this.write0_(t),this._VA_[0]=(this._VA_[0]-1|0)>>>0)}}},bulkAdd:{get:function(){"use strict";return function(t){for(var e=Uint32Array.of(t.length,0);e[1]<e[0];e[1]=this.plus_uint_(e[1],1))this.add(t[e[1]])}}},bulkAddUnsafe:{get:function(){"use strict";return function(t){for(var e=Uint32Array.of(t.length,0);e[1]<e[0];e[1]=this.plus_uint_(e[1],1))this.addUnsafe(t[e[1]]);this._VA_[0]=this.plus_uint_(this._VA_[0],e[0])}}},bulkDelete:{get:function(){"use strict";return function(t){for(var e=Uint32Array.of(t.length,0);e[1]<e[0];e[1]=this.plus_uint_(e[1],1))this.delete(t[e[1]])}}},invert:{get:function(){"use strict";return function(){var t=this.length,e=this.size;this._ba_.invert(),this._VA_[0]=t-e}}},clear:{get:function(){"use strict";return function(){this._VA_[0]>0&&(this._ba_.clear(),this._VA_[0]=0)}}},clearAndBulkAdd:{get:function(){"use strict";return function(t){this.clear(),this.bulkAdd(t)}}},clearAndBulkAddUnsafe:{get:function(){"use strict";return function(t){this.clear(),this.bulkAddUnsafe(t)}}},setFromSetFixed:{get:function(){"use strict";return function(t){this._ba_.setFromBitArrayData(t.bitArrayData),this._VA_[0]=t.size}}},computeSize:{get:function(){"use strict";return function(){this._VA_[0]=this._ba_.countOnes()}}},optimize:{get:function(){"use strict";return function(){this._ba_.resizeToMax()}}},resizeUnsafe:{get:function(){"use strict";return function(t){this._ba_.resize(t)}}},resize:{get:function(){"use strict";return function(t){this.resizeUnsafe(t),this.computeSize()}}},addFromSetFixedUnsafe:{get:function(){"use strict";return function(t,e,i,s){this._ba_.addFromArray(t.bitArrayData,e instanceof _?e.bitArrayData:void 0,i instanceof _?i.bitArrayData:void 0,s instanceof _?s.bitArrayData:void 0)}}},differentFromSetFixedUnsafe:{get:function(){"use strict";return function(t,e){this._ba_.differentFromArray(t.bitArrayData,e instanceof _?e.bitArrayData:void 0)}}},sameFromSetFixedUnsafe:{get:function(){"use strict";return function(t,e){this._ba_.sameFromArray(t.bitArrayData,e instanceof _?e.bitArrayData:void 0)}}},addFromSetFixed:{get:function(){"use strict";return function(t,e,i,s){this.addFromSetFixedUnsafe(t,e,i,s),this.computeSize()}}},differentFromSetFixed:{get:function(){"use strict";return function(t,e){this.differentFromSetFixedUnsafe(t,e),this.computeSize()}}},sameFromSetFixed:{get:function(){"use strict";return function(t,e){this.sameFromSetFixedUnsafe(t,e),this.computeSize()}}},charge:{get:function(){"use strict";return function(){this._ba_.charge(),this._VA_[0]=this._ba_.length}}},forEach:{get:function(){"use strict";return function(t){this.indexes.forEach(t)}}},map:{get:function(){"use strict";return function(t){this.indexes.map(t)}}},filter:{get:function(){"use strict";return function(t){this.indexes.filter(t)}}}}),{BitArray:c,SetFixed:_}}();void 0!==t.exports&&(t.exports=e)},24488:(t,e,i)=>{"use strict";i.d(e,{A:()=>_});var s=i(80045),n=i(58168),r=i(17402),a=i(20053),o=i(32150),h=i(47851),u=i(67515),c=r.forwardRef((function(t,e){var i=t.children,o=t.classes,c=t.className,_=t.color,d=void 0===_?"default":_,l=t.component,f=void 0===l?"button":l,p=t.disabled,g=void 0!==p&&p,m=t.disableFocusRipple,y=void 0!==m&&m,w=t.focusVisibleClassName,b=t.size,v=void 0===b?"large":b,x=t.variant,I=void 0===x?"circular":x,S=(0,s.A)(t,["children","classes","className","color","component","disabled","disableFocusRipple","focusVisibleClassName","size","variant"]);return r.createElement(h.A,(0,n.A)({className:(0,a.default)(o.root,c,"large"!==v&&o["size".concat((0,u.A)(v))],g&&o.disabled,"extended"===I&&o.extended,{primary:o.primary,secondary:o.secondary,inherit:o.colorInherit}[d]),component:f,disabled:g,focusRipple:!y,focusVisibleClassName:(0,a.default)(o.focusVisible,w),ref:e},S),r.createElement("span",{className:o.label},i))}));const _=(0,o.A)((function(t){return{root:(0,n.A)({},t.typography.button,{boxSizing:"border-box",minHeight:36,transition:t.transitions.create(["background-color","box-shadow","border"],{duration:t.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,boxShadow:t.shadows[6],"&:active":{boxShadow:t.shadows[12]},color:t.palette.getContrastText(t.palette.grey[300]),backgroundColor:t.palette.grey[300],"&:hover":{backgroundColor:t.palette.grey.A100,"@media (hover: none)":{backgroundColor:t.palette.grey[300]},"&$disabled":{backgroundColor:t.palette.action.disabledBackground},textDecoration:"none"},"&$focusVisible":{boxShadow:t.shadows[6]},"&$disabled":{color:t.palette.action.disabled,boxShadow:t.shadows[0],backgroundColor:t.palette.action.disabledBackground}}),label:{width:"100%",display:"inherit",alignItems:"inherit",justifyContent:"inherit"},primary:{color:t.palette.primary.contrastText,backgroundColor:t.palette.primary.main,"&:hover":{backgroundColor:t.palette.primary.dark,"@media (hover: none)":{backgroundColor:t.palette.primary.main}}},secondary:{color:t.palette.secondary.contrastText,backgroundColor:t.palette.secondary.main,"&:hover":{backgroundColor:t.palette.secondary.dark,"@media (hover: none)":{backgroundColor:t.palette.secondary.main}}},extended:{borderRadius:24,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48,"&$sizeSmall":{width:"auto",padding:"0 8px",borderRadius:17,minWidth:34,height:34},"&$sizeMedium":{width:"auto",padding:"0 16px",borderRadius:20,minWidth:40,height:40}},focusVisible:{},disabled:{},colorInherit:{color:"inherit"},sizeSmall:{width:40,height:40},sizeMedium:{width:48,height:48}}}),{name:"MuiFab"})(c)},44385:(t,e,i)=>{"use strict";var s=i(24994),n=i(6305);e.A=void 0;var r=n(i(17402)),a=(0,s(i(76447)).default)(r.createElement("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z"}),"InsertDriveFileOutlined");e.A=a},9372:(t,e,i)=>{"use strict";var s=i(24994),n=i(6305);e.A=void 0;var r=n(i(17402)),a=(0,s(i(76447)).default)(r.createElement(r.Fragment,null,r.createElement("circle",{cx:"12",cy:"12",r:"3"}),r.createElement("path",{d:"M20 4h-3.17l-1.24-1.35c-.37-.41-.91-.65-1.47-.65H9.88c-.56 0-1.1.24-1.48.65L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 13c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"})),"PhotoCameraRounded");e.A=a},32485:(t,e)=>{var i;!function(){"use strict";var s={}.hasOwnProperty;function n(){for(var t=[],e=0;e<arguments.length;e++){var i=arguments[e];if(i){var r=typeof i;if("string"===r||"number"===r)t.push(i);else if(Array.isArray(i)){if(i.length){var a=n.apply(null,i);a&&t.push(a)}}else if("object"===r){if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]")){t.push(i.toString());continue}for(var o in i)s.call(i,o)&&i[o]&&t.push(o)}}}return t.join(" ")}t.exports?(n.default=n,t.exports=n):void 0===(i=function(){return n}.apply(e,[]))||(t.exports=i)}()},22774:function(t){(function(){function e(t){if(t=t||{},this.method=t.method||2,this.colors=t.colors||256,this.initColors=t.initColors||4096,this.initDist=t.initDist||.01,this.distIncr=t.distIncr||.005,this.hueGroups=t.hueGroups||10,this.satGroups=t.satGroups||10,this.lumGroups=t.lumGroups||10,this.minHueCols=t.minHueCols||0,this.hueStats=this.minHueCols?new i(this.hueGroups,this.minHueCols):null,this.boxSize=t.boxSize||[64,64],this.boxPxls=t.boxPxls||2,this.palLocked=!1,this.dithKern=t.dithKern||null,this.dithSerp=t.dithSerp||!1,this.dithDelta=t.dithDelta||0,this.histogram={},this.idxrgb=t.palette?t.palette.slice(0):[],this.idxi32=[],this.i32idx={},this.i32rgb={},this.useCache=!1!==t.useCache,this.cacheFreq=t.cacheFreq||10,this.reIndex=t.reIndex||0==this.idxrgb.length,this.colorDist="manhattan"==t.colorDist?c:h,this.idxrgb.length>0){var e=this;this.idxrgb.forEach((function(t,i){var s=(255<<24|t[2]<<16|t[1]<<8|t[0])>>>0;e.idxi32[i]=s,e.i32idx[s]=i,e.i32rgb[s]=t}))}}function i(t,e){this.numGroups=t,this.minCols=e,this.stats={};for(var i=-1;i<t;i++)this.stats[i]={num:0,cols:[]};this.groupsFull=0}e.prototype.sample=function(t,e){if(this.palLocked)throw"Cannot sample additional images, palette already assembled.";var i=g(t,e);switch(this.method){case 1:this.colorStats1D(i.buf32);break;case 2:this.colorStats2D(i.buf32,i.width)}},e.prototype.reduce=function(t,e,i,s){if(this.palLocked||this.buildPal(),i=i||this.dithKern,s=void 0!==s?s:this.dithSerp,e=e||1,i)var n=this.dither(t,i,s);else for(var r=g(t).buf32,a=r.length,o=(n=new Uint32Array(a),0);o<a;o++){var h=r[o];n[o]=this.nearestColor(h)}if(1==e)return new Uint8Array(n.buffer);if(2==e){var u=[];for(a=n.length,o=0;o<a;o++){h=n[o];u[o]=this.i32idx[h]}return u}},e.prototype.dither=function(t,e,i){var s={FloydSteinberg:[[7/16,1,0],[3/16,-1,1],[5/16,0,1],[1/16,1,1]],FalseFloydSteinberg:[[3/8,1,0],[3/8,0,1],[2/8,1,1]],Stucki:[[8/42,1,0],[4/42,2,0],[2/42,-2,1],[4/42,-1,1],[8/42,0,1],[4/42,1,1],[2/42,2,1],[1/42,-2,2],[2/42,-1,2],[4/42,0,2],[2/42,1,2],[1/42,2,2]],Atkinson:[[1/8,1,0],[1/8,2,0],[1/8,-1,1],[1/8,0,1],[1/8,1,1],[1/8,0,2]],Jarvis:[[7/48,1,0],[5/48,2,0],[3/48,-2,1],[5/48,-1,1],[7/48,0,1],[5/48,1,1],[3/48,2,1],[1/48,-2,2],[3/48,-1,2],[5/48,0,2],[3/48,1,2],[1/48,2,2]],Burkes:[[.25,1,0],[4/32,2,0],[2/32,-2,1],[4/32,-1,1],[.25,0,1],[4/32,1,1],[2/32,2,1]],Sierra:[[5/32,1,0],[3/32,2,0],[2/32,-2,1],[4/32,-1,1],[5/32,0,1],[4/32,1,1],[2/32,2,1],[2/32,-1,2],[3/32,0,2],[2/32,1,2]],TwoSierra:[[.25,1,0],[3/16,2,0],[1/16,-2,1],[2/16,-1,1],[3/16,0,1],[2/16,1,1],[1/16,2,1]],SierraLite:[[.5,1,0],[1/4,-1,1],[1/4,0,1]]};if(!e||!s[e])throw"Unknown dithering kernel: "+e;for(var n=s[e],r=g(t),a=r.buf32,o=r.width,h=r.height,u=(a.length,i?-1:1),c=0;c<h;c++){i&&(u*=-1);for(var _=c*o,d=1==u?0:o-1,l=1==u?o:0;d!==l;d+=u){var f=_+d,p=a[f],m=255&p,y=(65280&p)>>8,w=(16711680&p)>>16,b=this.nearestColor(p),v=255&b,x=(65280&b)>>8,I=(16711680&b)>>16;if(a[f]=255<<24|I<<16|x<<8|v,this.dithDelta)if(this.colorDist([m,y,w],[v,x,I])<this.dithDelta)continue;for(var S=m-v,A=y-x,k=w-I,C=1==u?0:n.length-1,E=1==u?n.length:0;C!==E;C+=u){var B=n[C][1]*u,D=n[C][2],F=D*o;if(B+d>=0&&B+d<o&&D+c>=0&&D+c<h){var O=n[C][0],$=f+(F+B),j=255&a[$],P=(65280&a[$])>>8,U=(16711680&a[$])>>16,z=Math.max(0,Math.min(255,j+S*O)),T=Math.max(0,Math.min(255,P+A*O)),N=Math.max(0,Math.min(255,U+k*O));a[$]=255<<24|N<<16|T<<8|z}}}}return a},e.prototype.buildPal=function(t){if(!(this.palLocked||this.idxrgb.length>0&&this.idxrgb.length<=this.colors)){var e=this.histogram,i=function(t,e){var i=[];for(var s in t)i.push(s);return p.call(i,(function(i,s){return e?t[s]-t[i]:t[i]-t[s]}))}(e,!0);if(0==i.length)throw"Nothing has been sampled, palette cannot be built.";switch(this.method){case 1:for(var s=this.initColors,n=e[i[s-1]],r=i.slice(0,s),a=s,o=i.length;a<o&&e[i[a]]==n;)r.push(i[a++]);this.hueStats&&this.hueStats.inject(r);break;case 2:r=i}r=r.map((function(t){return+t})),this.reducePal(r),!t&&this.reIndex&&this.sortPal(),this.useCache&&this.cacheHistogram(r),this.palLocked=!0}},e.prototype.palette=function(t,e){return this.buildPal(e),t?this.idxrgb:new Uint8Array(new Uint32Array(this.idxi32).buffer)},e.prototype.prunePal=function(t){for(var e,i=0;i<this.idxrgb.length;i++)t[i]||(e=this.idxi32[i],this.idxrgb[i]=null,this.idxi32[i]=null,delete this.i32idx[e]);if(this.reIndex){for(var s=[],n=[],r={},a=(i=0,0);i<this.idxrgb.length;i++)this.idxrgb[i]&&(e=this.idxi32[i],s[a]=this.idxrgb[i],r[e]=a,n[a]=e,a++);this.idxrgb=s,this.idxi32=n,this.i32idx=r}},e.prototype.reducePal=function(t){if(this.idxrgb.length>this.colors){for(var e,i=t.length,s={},n=0,r=!1,a=0;a<i;a++)n!=this.colors||r||(this.prunePal(s),r=!0),e=this.nearestIndex(t[a]),n<this.colors&&!s[e]&&(s[e]=!0,n++);r||(this.prunePal(s),r=!0)}else{var o=t.map((function(t){return[255&t,(65280&t)>>8,(16711680&t)>>16]})),h=i=o.length,u=this.initDist;if(h>this.colors){for(;h>this.colors;){var c=[];for(a=0;a<i;a++){var _=o[a];t[a];if(_)for(var d=a+1;d<i;d++){var l=o[d],f=t[d];if(l){var g=this.colorDist(_,l);g<u&&(c.push([d,l,f,g]),delete o[d],h--)}}}u+=h>3*this.colors?this.initDist:this.distIncr}if(h<this.colors){p.call(c,(function(t,e){return e[3]-t[3]}));for(var m=0;h<this.colors;)o[c[m][0]]=c[m][1],h++,m++}}for(i=o.length,a=0;a<i;a++)o[a]&&(this.idxrgb.push(o[a]),this.idxi32.push(t[a]),this.i32idx[t[a]]=this.idxi32.length-1,this.i32rgb[t[a]]=o[a])}},e.prototype.colorStats1D=function(t){for(var e,i=this.histogram,s=t.length,n=0;n<s;n++)(4278190080&(e=t[n]))>>24&&(this.hueStats&&this.hueStats.check(e),e in i?i[e]++:i[e]=1)},e.prototype.colorStats2D=function(t,e){var i=this.boxSize[0],s=this.boxSize[1],n=i*s,r=function(t,e,i,s){for(var n=t%i,r=e%s,a=t-n,o=e-r,h=[],u=0;u<e;u+=s)for(var c=0;c<t;c+=i)h.push({x:c,y:u,w:c==a?n:i,h:u==o?r:s});return h}(e,t.length/e,i,s),a=this.histogram,o=this;r.forEach((function(i){var s,r=Math.max(Math.round(i.w*i.h/n)*o.boxPxls,2),h={};!function(t,e,i){var s=t,n=s.y*e+s.x,r=(s.y+s.h-1)*e+(s.x+s.w-1),a=0,o=e-s.w+1,h=n;do{i.call(this,h),h+=++a%s.w==0?o:1}while(h<=r)}(i,e,(function(e){(4278190080&(s=t[e]))>>24&&(o.hueStats&&o.hueStats.check(s),s in a?a[s]++:s in h?++h[s]>=r&&(a[s]=h[s]):h[s]=1)}))})),this.hueStats&&this.hueStats.inject(a)},e.prototype.sortPal=function(){var t=this;this.idxi32.sort((function(e,i){var s=t.i32idx[e],n=t.i32idx[i],r=t.idxrgb[s],a=t.idxrgb[n],o=_(r[0],r[1],r[2]),h=_(a[0],a[1],a[2]),u=r[0]==r[1]&&r[1]==r[2]?-1:d(o.h,t.hueGroups),c=(a[0]==a[1]&&a[1]==a[2]?-1:d(h.h,t.hueGroups))-u;if(c)return-c;var l=+h.l.toFixed(2)-+o.l.toFixed(2);if(l)return-l;var f=+h.s.toFixed(2)-+o.s.toFixed(2);return f?-f:void 0})),this.idxi32.forEach((function(e,i){t.idxrgb[i]=t.i32rgb[e],t.i32idx[e]=i}))},e.prototype.nearestColor=function(t){var e=this.nearestIndex(t);return null===e?0:this.idxi32[e]},e.prototype.nearestIndex=function(t){if(!((4278190080&t)>>24))return null;if(this.useCache&&""+t in this.i32idx)return this.i32idx[t];for(var e,i=1e3,s=[255&t,(65280&t)>>8,(16711680&t)>>16],n=this.idxrgb.length,r=0;r<n;r++)if(this.idxrgb[r]){var a=this.colorDist(s,this.idxrgb[r]);a<i&&(i=a,e=r)}return e},e.prototype.cacheHistogram=function(t){for(var e=0,i=t[e];e<t.length&&this.histogram[i]>=this.cacheFreq;i=t[e++])this.i32idx[i]=this.nearestIndex(i)},i.prototype.check=function(t){this.groupsFull==this.numGroups+1&&(this.check=function(){});var e=255&t,i=(65280&t)>>8,s=(16711680&t)>>16,n=e==i&&i==s?-1:d(_(e,i,s).h,this.numGroups),r=this.stats[n],a=this.minCols;r.num++,r.num>a||(r.num==a&&this.groupsFull++,r.num<=a&&this.stats[n].cols.push(t))},i.prototype.inject=function(t){for(var e=-1;e<this.numGroups;e++)if(this.stats[e].num<=this.minCols)switch(l(t)){case"Array":this.stats[e].cols.forEach((function(e){-1==t.indexOf(e)&&t.push(e)}));break;case"Object":this.stats[e].cols.forEach((function(e){t[e]?t[e]++:t[e]=1}))}};var s=.2126,n=.7152,r=.0722;function a(t,e,i){return Math.sqrt(s*t*t+n*e*e+r*i*i)}var o=Math.sqrt(255*s*255+255*n*255+255*r*255);function h(t,e){var i=e[0]-t[0],a=e[1]-t[1],h=e[2]-t[2];return Math.sqrt(s*i*i+n*a*a+r*h*h)/o}var u=255*s+255*n+255*r;function c(t,e){var i=Math.abs(e[0]-t[0]),a=Math.abs(e[1]-t[1]),o=Math.abs(e[2]-t[2]);return(s*i+n*a+r*o)/u}function _(t,e,i){var s,n,r,o,h;if(t/=255,e/=255,i/=255,(s=Math.max(t,e,i))==(n=Math.min(t,e,i)))r=o=0;else{switch(h=s-n,o=(s+n)/2>.5?h/(2-s-n):h/(s+n),s){case t:r=(e-i)/h+(e<i?6:0);break;case e:r=(i-t)/h+2;break;case i:r=(t-e)/h+4}r/=6}return{h:r,s:o,l:a(t,e,i)}}function d(t,e){var i=1/e,s=i/2;if(t>=1-s||t<=s)return 0;for(var n=1;n<e;n++){var r=n*i;if(t>=r-s&&t<=r+s)return n}}function l(t){return Object.prototype.toString.call(t).slice(8,-1)}var f,p="xyzvwtursopqmnklhijfgdeabc"==(f="abcdefghijklmnopqrstuvwxyz").split("").sort((function(t,e){return~~(f.indexOf(e)/2.3)-~~(f.indexOf(t)/2.3)})).join("")?Array.prototype.sort:function(t){var e=l(this[0]);if("Number"==e||"String"==e){for(var i,s={},n=this.length,r=0;r<n;r++)i=this[r],s[i]||0===s[i]||(s[i]=r);return this.sort((function(e,i){return t(e,i)||s[e]-s[i]}))}s=this.map((function(t){return t}));return this.sort((function(e,i){return t(e,i)||s.indexOf(e)-s.indexOf(i)}))};function g(t,e){var i,s,n,r,a,o;switch(l(t)){case"HTMLImageElement":(i=document.createElement("canvas")).width=t.naturalWidth,i.height=t.naturalHeight,(s=i.getContext("2d")).drawImage(t,0,0);case"Canvas":case"HTMLCanvasElement":i=i||t,s=s||i.getContext("2d");case"CanvasRenderingContext2D":s=s||t,i=i||s.canvas,n=s.getImageData(0,0,i.width,i.height);case"ImageData":e=(n=n||t).width,r="CanvasPixelArray"==l(n.data)?new Uint8Array(n.data):n.data;case"Array":case"CanvasPixelArray":r=r||new Uint8Array(t);case"Uint8Array":case"Uint8ClampedArray":r=r||t,a=new Uint32Array(r.buffer);case"Uint32Array":a=a||t,r=r||new Uint8Array(a.buffer),e=e||a.length,o=a.length/e}return{can:i,ctx:s,imgd:n,buf8:r,buf32:a,width:e,height:o}}this.RgbQuant=e,t.exports&&(t.exports=e)}).call(this)},84215:(t,e,i)=>{"use strict";var s=i(44576),n=i(82839),r=i(22195),a=function(t){return n.slice(0,t.length)===t};t.exports=a("Bun/")?"BUN":a("Cloudflare-Workers")?"CLOUDFLARE":a("Deno/")?"DENO":a("Node.js/")?"NODE":s.Bun&&"string"==typeof Bun.version?"BUN":s.Deno&&"object"==typeof Deno.version?"DENO":"process"===r(s.process)?"NODE":s.window&&s.document?"BROWSER":"REST"},72652:(t,e,i)=>{"use strict";var s=i(76080),n=i(69565),r=i(28551),a=i(16823),o=i(44209),h=i(26198),u=i(1625),c=i(70081),_=i(50851),d=i(9539),l=TypeError,f=function(t,e){this.stopped=t,this.result=e},p=f.prototype;t.exports=function(t,e,i){var g,m,y,w,b,v,x,I=i&&i.that,S=!(!i||!i.AS_ENTRIES),A=!(!i||!i.IS_RECORD),k=!(!i||!i.IS_ITERATOR),C=!(!i||!i.INTERRUPTED),E=s(e,I),B=function(t){return g&&d(g,"normal",t),new f(!0,t)},D=function(t){return S?(r(t),C?E(t[0],t[1],B):E(t[0],t[1])):C?E(t,B):E(t)};if(A)g=t.iterator;else if(k)g=t;else{if(!(m=_(t)))throw new l(a(t)+" is not iterable");if(o(m)){for(y=0,w=h(t);w>y;y++)if((b=D(t[y]))&&u(p,b))return b;return new f(!1)}g=c(t,m)}for(v=A?t.next:g.next;!(x=n(v,g)).done;){try{b=D(x.value)}catch(t){d(g,"throw",t)}if("object"==typeof b&&b&&u(p,b))return b}return new f(!1)}},36043:(t,e,i)=>{"use strict";var s=i(79306),n=TypeError,r=function(t){var e,i;this.promise=new t((function(t,s){if(void 0!==e||void 0!==i)throw new n("Bad Promise constructor");e=t,i=s})),this.resolve=s(e),this.reject=s(i)};t.exports.f=function(t){return new r(t)}},1103:t=>{"use strict";t.exports=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}},10916:(t,e,i)=>{"use strict";var s=i(44576),n=i(80550),r=i(94901),a=i(92796),o=i(33706),h=i(78227),u=i(84215),c=i(96395),_=i(39519),d=n&&n.prototype,l=h("species"),f=!1,p=r(s.PromiseRejectionEvent),g=a("Promise",(function(){var t=o(n),e=t!==String(n);if(!e&&66===_)return!0;if(c&&(!d.catch||!d.finally))return!0;if(!_||_<51||!/native code/.test(t)){var i=new n((function(t){t(1)})),s=function(t){t((function(){}),(function(){}))};if((i.constructor={})[l]=s,!(f=i.then((function(){}))instanceof s))return!0}return!(e||"BROWSER"!==u&&"DENO"!==u||p)}));t.exports={CONSTRUCTOR:g,REJECTION_EVENT:p,SUBCLASSING:f}},80550:(t,e,i)=>{"use strict";var s=i(44576);t.exports=s.Promise},90537:(t,e,i)=>{"use strict";var s=i(80550),n=i(84428),r=i(10916).CONSTRUCTOR;t.exports=r||!n((function(t){s.all(t).then(void 0,(function(){}))}))},96167:(t,e,i)=>{"use strict";var s=i(46518),n=i(69565),r=i(79306),a=i(36043),o=i(1103),h=i(72652);s({target:"Promise",stat:!0,forced:i(90537)},{allSettled:function(t){var e=this,i=a.f(e),s=i.resolve,u=i.reject,c=o((function(){var i=r(e.resolve),a=[],o=0,u=1;h(t,(function(t){var r=o++,h=!1;u++,n(i,e,t).then((function(t){h||(h=!0,a[r]={status:"fulfilled",value:t},--u||s(a))}),(function(t){h||(h=!0,a[r]={status:"rejected",reason:t},--u||s(a))}))})),--u||s(a)}));return c.error&&u(c.value),i.promise}})},48345:(t,e,i)=>{"use strict";var s=i(72805);(0,i(94644).exportTypedArrayStaticMethod)("from",i(43251),s)},35874:(t,e,i)=>{"use strict";i(96167)},60987:(t,e,i)=>{"use strict";i.d(e,{Kj:()=>dt});var s,n=i(65606),r=(i(31546).Buffer,Object.defineProperty),a=(t,e,i)=>(((t,e,i)=>{e in t?r(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i})(t,"symbol"!=typeof e?e+"":e,i),i),o=(t,e,i)=>{if(!e.has(t))throw TypeError("Cannot "+i)},h=(t,e,i)=>(o(t,e,"read from private field"),i?i.call(t):e.get(t)),u=new Intl.Collator(0,{numeric:1}).compare;function c(t,e,i){return t=t.split("."),e=e.split("."),u(t[0],e[0])||u(t[1],e[1])||(e[2]=e.slice(2).join("."),(i=/[.-]/.test(t[2]=t.slice(2).join(".")))==/[.-]/.test(e[2])?u(t[2],e[2]):i?-1:1)}const _="host",d="queue/data",l="upload",f="login",p="runtime",g="sleeptime",m="This application is currently busy. Please try again. ",y="Connection errored out. ",w="Could not resolve app config. ",b="Space metadata could not be loaded. ",v="Invalid credentials. Could not login. ",x="File system access is only available in Node.js environments",I="Root URL not found in client config";function S(t,e,i){return e.startsWith("http://")||e.startsWith("https://")?i?t:e:t+e}async function A(t,e,i){try{const s=await fetch(`https://huggingface.co/api/spaces/${t}/jwt`,{headers:{Authorization:`Bearer ${e}`,...i?{Cookie:i}:{}}});return(await s.json()).token||!1}catch(t){return!1}}async function k(t){var e;const i=this.options.hf_token?{Authorization:`Bearer ${this.options.hf_token}`}:{};if(i["Content-Type"]="application/json","undefined"!=typeof window&&window.gradio_config&&"http://localhost:9876"!==location.origin&&!window.gradio_config.dev_mode){const e=window.gradio_config.root,i=window.gradio_config;let s=S(t,i.root,!1);return i.root=s,{...i,path:e}}if(t){const s=j(t,"config"),n=await this.fetch(s,{headers:i,credentials:"include"});if(401===(null==n?void 0:n.status)&&!this.options.auth)throw new Error("Login credentials are required to access this space.");if(401===(null==n?void 0:n.status)&&this.options.auth)throw new Error(v);if(200===(null==n?void 0:n.status)){let i=await n.json();return i.path=i.path??"",i.root=t,null==(e=i.dependencies)||e.forEach(((t,e)=>{void 0===t.id&&(t.id=e)})),i}if(401===(null==n?void 0:n.status))throw new Error("Not authorized to access this space. ");throw new Error(w)}throw new Error(w)}async function C(){const{http_protocol:t,host:e}=await $(this.app_reference,this.options.hf_token);try{if(this.options.auth){const i=await E(t,e,this.options.auth,this.fetch,this.options.hf_token);i&&this.set_cookies(i)}}catch(t){throw Error(t.message)}}async function E(t,e,i,s,n){const r=new FormData;r.append("username",null==i?void 0:i[0]),r.append("password",null==i?void 0:i[1]);let a={};n&&(a.Authorization=`Bearer ${n}`);const o=await s(`${t}//${e}/${f}`,{headers:a,method:"POST",body:r,credentials:"include"});if(200===o.status)return o.headers.get("set-cookie");throw 401===o.status?new Error(v):new Error(b)}function B(t){if(t.startsWith("http")){const{protocol:e,host:i,pathname:s}=new URL(t);return{ws_protocol:"https:"===e?"wss":"ws",http_protocol:e,host:i+("/"!==s?s:"")}}return t.startsWith("file:")?{ws_protocol:"ws",http_protocol:"http:",host:"lite.local"}:{ws_protocol:"wss",http_protocol:"https:",host:new URL(t).host}}const D=t=>{let e=[];return t.split(/,(?=\s*[^\s=;]+=[^\s=;]+)/).forEach((t=>{const[i,s]=t.split(";")[0].split("=");i&&s&&e.push(`${i.trim()}=${s.trim()}`)})),e},F=/^[a-zA-Z0-9_\-\.]+\/[a-zA-Z0-9_\-\.]+$/,O=/.*hf\.space\/{0,1}.*$/;async function $(t,e){const i={};e&&(i.Authorization=`Bearer ${e}`);const s=t.trim().replace(/\/$/,"");if(F.test(s))try{const e=await fetch(`https://huggingface.co/api/spaces/${s}/${_}`,{headers:i});return{space_id:t,...B((await e.json()).host)}}catch(t){throw new Error(b)}if(O.test(s)){const{ws_protocol:t,http_protocol:e,host:i}=B(s);return{space_id:i.split("/")[0].replace(".hf.space",""),ws_protocol:t,http_protocol:e,host:i}}return{space_id:!1,...B(s)}}const j=(...t)=>{try{return t.reduce(((t,e)=>(t=t.replace(/\/+$/,""),e=e.replace(/^\/+/,""),new URL(e,t+"/").toString())))}catch(t){throw new Error("Invalid URL. A full URL path is required.")}};function P(t,e,i,s){switch(null==t?void 0:t.type){case"string":return"string";case"boolean":return"boolean";case"number":return"number"}return"JSONSerializable"===i||"StringSerializable"===i?"any":"ListStringSerializable"===i?"string[]":"Image"===e?"parameter"===s?"Blob | File | Buffer":"string":"FileSerializable"===i?"array"===(null==t?void 0:t.type)?"parameter"===s?"(Blob | File | Buffer)[]":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}[]":"parameter"===s?"Blob | File | Buffer":"{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}":"GallerySerializable"===i?"parameter"===s?"[(Blob | File | Buffer), (string | null)][]":"[{ name: string; data: string; size?: number; is_file?: boolean; orig_name?: string}, (string | null))][]":void 0}function U(t,e){return"GallerySerializable"===e?"array of [file, label] tuples":"ListStringSerializable"===e?"array of strings":"FileSerializable"===e?"array of files or single file":null==t?void 0:t.description}function z(t,e){const i=!0;switch(t.msg){case"send_data":return{type:"data"};case"send_hash":return{type:"hash"};case"queue_full":return{type:"update",status:{queue:i,message:m,stage:"error",code:t.code,success:t.success}};case"heartbeat":return{type:"heartbeat"};case"unexpected_error":return{type:"unexpected_error",status:{queue:i,message:t.message,stage:"error",success:!1}};case"estimation":return{type:"update",status:{queue:i,stage:e||"pending",code:t.code,size:t.queue_size,position:t.rank,eta:t.rank_eta,success:t.success}};case"progress":return{type:"update",status:{queue:i,stage:"pending",code:t.code,progress_data:t.progress_data,success:t.success}};case"log":return{type:"log",data:t};case"process_generating":return{type:"generating",status:{queue:i,message:t.success?null:t.output.error,stage:t.success?"generating":"error",code:t.code,progress_data:t.progress_data,eta:t.average_duration,changed_state_ids:t.success?t.output.changed_state_ids:void 0},data:t.success?t.output:null};case"process_streaming":return{type:"streaming",status:{queue:i,message:t.output.error,stage:"streaming",time_limit:t.time_limit,code:t.code,progress_data:t.progress_data,eta:t.eta},data:t.output};case"process_completed":return"error"in t.output?{type:"update",status:{queue:i,title:t.output.title,message:t.output.error,visible:t.output.visible,duration:t.output.duration,stage:"error",code:t.code,success:t.success}}:{type:"complete",status:{queue:i,message:t.success?void 0:t.output.error,stage:t.success?"complete":"error",code:t.code,progress_data:t.progress_data,changed_state_ids:t.success?t.output.changed_state_ids:void 0},data:t.success?t.output:null};case"process_starts":return{type:"update",status:{queue:i,stage:"pending",code:t.code,size:t.rank,position:0,success:t.success,eta:t.eta},original_msg:"process_starts"}}return{type:"none",status:{stage:"error",queue:i}}}async function T(){if(this.api_info)return this.api_info;const{hf_token:t}=this.options,{config:e}=this,i={"Content-Type":"application/json"};if(t&&(i.Authorization=`Bearer ${t}`),e)try{let t,s;if("undefined"!=typeof window&&window.gradio_api_info)s=window.gradio_api_info;else{if(c((null==e?void 0:e.version)||"2.0.0","3.30")<0)t=await this.fetch("https://gradio-space-api-fetcher-v2.hf.space/api",{method:"POST",body:JSON.stringify({serialize:!1,config:JSON.stringify(e)}),headers:i,credentials:"include"});else{const s=j(e.root,this.api_prefix,"info");t=await this.fetch(s,{headers:i,credentials:"include"})}if(!t.ok)throw new Error(y);s=await t.json()}return"api"in s&&(s=s.api),s.named_endpoints["/predict"]&&!s.unnamed_endpoints[0]&&(s.unnamed_endpoints[0]=s.named_endpoints["/predict"]),function(t,e,i){const s={named_endpoints:{},unnamed_endpoints:{}};return Object.keys(t).forEach((n=>{"named_endpoints"!==n&&"unnamed_endpoints"!==n||(s[n]={},Object.entries(t[n]).forEach((([t,{parameters:r,returns:a}])=>{var o,h,u,c;const _=(null==(o=e.dependencies.find((e=>e.api_name===t||e.api_name===t.replace("/",""))))?void 0:o.id)||i[t.replace("/","")]||-1,d=-1!==_?null==(h=e.dependencies.find((t=>t.id==_)))?void 0:h.types:{generator:!1,cancel:!1};if(-1!==_&&(null==(c=null==(u=e.dependencies.find((t=>t.id==_)))?void 0:u.inputs)?void 0:c.length)!==r.length){const t=e.dependencies.find((t=>t.id==_)).inputs.map((t=>{var i;return null==(i=e.components.find((e=>e.id===t)))?void 0:i.type}));try{t.forEach(((t,e)=>{if("state"===t){const t={component:"state",example:null,parameter_default:null,parameter_has_default:!0,parameter_name:null,hidden:!0};r.splice(e,0,t)}}))}catch(t){}}const l=(t,e,i,s)=>({...t,description:U(null==t?void 0:t.type,i),type:P(null==t?void 0:t.type,e,i,s)||""});s[n][t]={parameters:r.map((t=>l(t,null==t?void 0:t.component,null==t?void 0:t.serializer,"parameter"))),returns:a.map((t=>l(t,null==t?void 0:t.component,null==t?void 0:t.serializer,"return"))),type:d}})))})),s}(s,e,this.api_map)}catch(t){t.message}}async function N(t,e,i){var s;const n={};(null==(s=null==this?void 0:this.options)?void 0:s.hf_token)&&(n.Authorization=`Bearer ${this.options.hf_token}`);const r=[];let a;for(let s=0;s<e.length;s+=1e3){const o=e.slice(s,s+1e3),h=new FormData;o.forEach((t=>{h.append("files",t)}));try{const e=i?`${t}${this.api_prefix}/${l}?upload_id=${i}`:`${t}${this.api_prefix}/${l}`;a=await this.fetch(e,{method:"POST",body:h,headers:n,credentials:"include"})}catch(t){throw new Error(y+t.message)}if(!a.ok){const t=await a.text();return{error:`HTTP ${a.status}: ${t}`}}const u=await a.json();u&&r.push(...u)}return{files:r}}async function M(t,e,i,s){let n=(Array.isArray(t)?t:[t]).map((t=>t.blob));const r=n.filter((t=>t.size>(s??1/0)));if(r.length)throw new Error(`File size exceeds the maximum allowed size of ${s} bytes: ${r.map((t=>t.name)).join(", ")}`);return await Promise.all(await this.upload_files(e,n,i).then((async i=>{if(i.error)throw new Error(i.error);return i.files?i.files.map(((i,s)=>new q({...t[s],path:i,url:`${e}${this.api_prefix}/file=${i}`}))):[]})))}class q{constructor({path:t,url:e,orig_name:i,size:s,blob:n,is_stream:r,mime_type:o,alt_text:h,b64:u}){a(this,"path"),a(this,"url"),a(this,"orig_name"),a(this,"size"),a(this,"blob"),a(this,"is_stream"),a(this,"mime_type"),a(this,"alt_text"),a(this,"b64"),a(this,"meta",{_type:"gradio.FileData"}),this.path=t,this.url=e,this.orig_name=i,this.size=s,this.blob=e?void 0:n,this.is_stream=r,this.mime_type=o,this.alt_text=h,this.b64=u}}class R{constructor(t,e){a(this,"type"),a(this,"command"),a(this,"meta"),a(this,"fileData"),this.type="command",this.command=t,this.meta=e}}void 0!==n&&n.versions&&n.versions.node;function L(t,e,i){for(;i.length>1;){const e=i.shift();if("string"!=typeof e&&"number"!=typeof e)throw new Error("Invalid key type");t=t[e]}const s=i.shift();if("string"!=typeof s&&"number"!=typeof s)throw new Error("Invalid key type");t[s]=e}async function V(t,e=void 0,i=[],s=!1,n=void 0){if(Array.isArray(t)){let r=[];return await Promise.all(t.map((async(a,o)=>{var h;let u=i.slice();u.push(String(o));const c=await V(t[o],s?(null==(h=null==n?void 0:n.parameters[o])?void 0:h.component)||void 0:e,u,!1,n);r=r.concat(c)}))),r}if(globalThis.Buffer&&t instanceof globalThis.Buffer||t instanceof Blob)return[{path:i,blob:new Blob([t]),type:e}];if("object"==typeof t&&null!==t){let e=[];for(const s of Object.keys(t)){const r=[...i,s],a=t[s];e=e.concat(await V(a,void 0,r,!1,n))}return e}return[]}function G(t,e,i,s,n=!1){if("input"===s&&!n)throw new Error("Invalid code path. Cannot skip state inputs for input.");if("output"===s&&n)return t;let r=[],a=0;const o="input"===s?e.inputs:e.outputs;for(let e=0;e<o.length;e++){const s=o[e],h=i.find((t=>t.id===s));if("state"!==(null==h?void 0:h.type)){const e=t[a];r.push(e),a++}else{if(!n){a++;continue}if(t.length===o.length){const e=t[a];r.push(e),a++}else r.push(null)}}return r}async function W(t,e,i){const s=this;await async function(t,e){var i,s;if(!(null==(i=t.config)?void 0:i.root)&&!(null==(s=t.config)?void 0:s.root_url))throw new Error(I);await H(t,e)}(s,e);const n=await V(e,void 0,[],!0,i);return(await Promise.all(n.map((async({path:e,blob:i,type:n})=>{if(!i)return{path:e,type:n};const r=await s.upload_files(t,[i]);return{path:e,file_url:r.files&&r.files[0],type:n,name:"undefined"!=typeof File&&i instanceof File?null==i?void 0:i.name:void 0}})))).forEach((({path:t,file_url:i,type:s,name:n})=>{if("Gallery"===s)L(e,i,t);else if(i){const s=new q({path:i,orig_name:n});L(e,s,t)}})),e}async function H(t,e,i=[]){for(const s in e)e[s]instanceof R?await J(t,e,s):"object"==typeof e[s]&&null!==e[s]&&await H(t,e[s],[...i,s])}async function J(t,e,s){var r,a;let o=e[s];const h=(null==(r=t.config)?void 0:r.root)||(null==(a=t.config)?void 0:a.root_url);if(!h)throw new Error(I);try{let r,a;if(void 0===n||!n.versions||!n.versions.node)throw new Error(x);{const t=await i.e("_b1f2").then(i.t.bind(i,34584,19));a=(await i.e("node_modules_path-browserify_index_js").then(i.t.bind(i,57975,19))).resolve(n.cwd(),o.meta.path),r=await t.readFile(a)}const u=new Blob([r],{type:"application/octet-stream"}),c=await t.upload_files(h,[u]),_=c.files&&c.files[0];if(_){const t=new q({path:_,orig_name:o.meta.name||""});e[s]=t}}catch(t){}}async function K(t,e,i){const s={"Content-Type":"application/json"};this.options.hf_token&&(s.Authorization=`Bearer ${this.options.hf_token}`);try{var n=await this.fetch(t,{method:"POST",body:JSON.stringify(e),headers:{...s,...i},credentials:"include"})}catch(t){return[{error:y},500]}let r,a;try{r=await n.json(),a=n.status}catch(t){r={error:`Could not parse server response: ${t}`},a=500}return[r,a]}async function Z(t,e={}){let i=!1,s=!1;if(!this.config)throw new Error("Could not resolve app config");if("number"==typeof t)this.config.dependencies.find((e=>e.id==t));else{const e=t.replace(/^\//,"");this.config.dependencies.find((t=>t.id==this.api_map[e]))}return new Promise((async(n,r)=>{const a=this.submit(t,e,null,null,!0);let o;for await(const t of a)"data"===t.type&&(s&&n(o),i=!0,o=t),"status"===t.type&&("error"===t.stage&&r(t),"complete"===t.stage&&(s=!0,i&&n(o)))}))}async function Q(t,e,i){let s,n,r="subdomain"===e?`https://huggingface.co/api/spaces/by-subdomain/${t}`:`https://huggingface.co/api/spaces/${t}`;try{if(s=await fetch(r),n=s.status,200!==n)throw new Error;s=await s.json()}catch(t){return void i({status:"error",load_status:"error",message:"Could not get space status. ",detail:"NOT_FOUND"})}if(!s||200!==n)return;const{runtime:{stage:a},id:o}=s;switch(a){case"STOPPED":case"SLEEPING":i({status:"sleeping",load_status:"pending",message:"Space is asleep. Waking it up...",detail:a}),setTimeout((()=>{Q(t,e,i)}),1e3);break;case"PAUSED":i({status:"paused",load_status:"error",message:"This space has been paused by the author. If you would like to try this demo, consider duplicating the space.",detail:a,discussions_enabled:await tt(o)});break;case"RUNNING":case"RUNNING_BUILDING":i({status:"running",load_status:"complete",message:"Space is running.",detail:a});break;case"BUILDING":i({status:"building",load_status:"pending",message:"Space is building...",detail:a}),setTimeout((()=>{Q(t,e,i)}),1e3);break;case"APP_STARTING":i({status:"starting",load_status:"pending",message:"Space is starting...",detail:a}),setTimeout((()=>{Q(t,e,i)}),1e3);break;default:i({status:"space_error",load_status:"error",message:"This space is experiencing an issue.",detail:a,discussions_enabled:await tt(o)})}}const X=async(t,e)=>{let i=0;return new Promise((s=>{Q(t,F.test(t)?"space_name":"subdomain",(n=>{e(n),"running"===n.status||"error"===n.status||"paused"===n.status||"space_error"===n.status?s():"sleeping"!==n.status&&"building"!==n.status||(i<12?(i++,setTimeout((()=>{X(t,e).then(s)}),5e3)):s())}))}))},Y=/^(?=[^]*\b[dD]iscussions{0,1}\b)(?=[^]*\b[dD]isabled\b)[^]*$/;async function tt(t){try{const e=await fetch(`https://huggingface.co/api/spaces/${t}/discussions`,{method:"HEAD"}),i=e.headers.get("x-error-message");return!(!e.ok||i&&Y.test(i))}catch(t){return!1}}const et=["cpu-basic","cpu-upgrade","cpu-xl","t4-small","t4-medium","a10g-small","a10g-large","a10g-largex2","a10g-largex4","a100-large","zero-a10g","h100","h100x8"];async function it(t,e){const{hf_token:i,private:s,hardware:n,timeout:r,auth:a}=e;if(n&&!et.includes(n))throw new Error(`Invalid hardware type provided. Valid types are: ${et.map((t=>`"${t}"`)).join(",")}.`);const{http_protocol:o,host:h}=await $(t,i);let u=null;if(a){const t=await E(o,h,a,fetch);t&&(u=D(t))}const c={Authorization:`Bearer ${i}`,"Content-Type":"application/json",...u?{Cookie:u.join("; ")}:{}},_=(await(await fetch("https://huggingface.co/api/whoami-v2",{headers:c})).json()).name,d=t.split("/")[1],l={repository:`${_}/${d}`};let f;s&&(l.private=!0);try{n||(f=await async function(t,e){const i={};e&&(i.Authorization=`Bearer ${e}`);try{const e=await fetch(`https://huggingface.co/api/spaces/${t}/${p}`,{headers:i});if(200!==e.status)throw new Error("Space hardware could not be obtained.");const{hardware:s}=await e.json();return s.current}catch(t){throw new Error(t.message)}}(t,i))}catch(t){throw Error(b+t.message)}const m=n||f||"cpu-basic";l.hardware=m;try{const s=await fetch(`https://huggingface.co/api/spaces/${t}/duplicate`,{method:"POST",headers:c,body:JSON.stringify(l)});if(409===s.status)try{return await dt.connect(`${_}/${d}`,e)}catch(t){throw t}else if(200!==s.status)throw new Error(s.statusText);const n=await s.json();return await async function(t,e,i){const s={};i&&(s.Authorization=`Bearer ${i}`);const n={seconds:e};try{const e=await fetch(`https://huggingface.co/api/spaces/${t}/${g}`,{method:"POST",headers:{"Content-Type":"application/json",...s},body:JSON.stringify(n)});if(200!==e.status)throw new Error("Could not set sleep timeout on duplicated Space. Please visit *ADD HF LINK TO SETTINGS* to set a timeout manually to reduce billing charges.");return await e.json()}catch(t){throw new Error(t.message)}}(`${_}/${d}`,r||300,i),await dt.connect(function(t){const e=/https:\/\/huggingface.co\/spaces\/([^/]+\/[^/]+)/,i=t.match(e);if(i)return i[1]}(n.url),e)}catch(t){throw new Error(t)}}class st extends TransformStream{constructor(t={allowCR:!1}){super({transform:(e,i)=>{for(e=h(this,s)+e;;){const s=e.indexOf("\n"),n=t.allowCR?e.indexOf("\r"):-1;if(-1!==n&&n!==e.length-1&&(-1===s||s-1>n)){i.enqueue(e.slice(0,n)),e=e.slice(n+1);continue}if(-1===s)break;const r="\r"===e[s-1]?s-1:s;i.enqueue(e.slice(0,r)),e=e.slice(s+1)}var n,r,a,u;a=e,o(n=this,r=s,"write to private field"),u?u.call(n,a):r.set(n,a)},flush:e=>{if(""===h(this,s))return;const i=t.allowCR&&h(this,s).endsWith("\r")?h(this,s).slice(0,-1):h(this,s);e.enqueue(i)}}),((t,e,i)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,i)})(this,s,"")}}function nt(t){let e=/[:]\s*/.exec(t),i=e&&e.index;if(i)return[t.substring(0,i),t.substring(i+e[0].length)]}function rt(t,e,i){t.get(e)||t.set(e,i)}async function*at(t,e){if(!t.body)return;let i,s,n=function(t){let e=new TextDecoderStream,i=new st({allowCR:!0});return t.pipeThrough(e).pipeThrough(i)}(t.body).getReader();for(;;){if(e&&e.aborted)return n.cancel();if(i=await n.read(),i.done)return;if(!i.value){s&&(yield s),s=void 0;continue}let[t,r]=nt(i.value)||[];t&&("data"===t?(s||(s={}),s[t]=s[t]?s[t]+"\n"+r:r):"event"===t?(s||(s={}),s[t]=r):"id"===t?(s||(s={}),s[t]=+r||r):"retry"===t&&(s||(s={}),s[t]=+r||void 0))}}async function ot(){let{event_callbacks:t,unclosed_events:e,pending_stream_messages:i,stream_status:s,config:n,jwt:r}=this;const a=this;if(!n)throw new Error("Could not resolve app config");s.open=!0;let o=null,h=new URLSearchParams({session_hash:this.session_hash}).toString(),u=new URL(`${n.root}${this.api_prefix}/${d}?${h}`);r&&u.searchParams.set("__sign",r),o=this.stream(u),o&&(o.onmessage=async function(r){let o=JSON.parse(r.data);if("close_stream"===o.msg)return void ht(s,a.abort_controller);const h=o.event_id;if(h)if(t[h]&&n){"process_completed"===o.msg&&["sse","sse_v1","sse_v2","sse_v2.1","sse_v3"].includes(n.protocol)&&e.delete(h);let i=t[h];"undefined"!=typeof window&&"undefined"!=typeof document?setTimeout(i,0,o):i(o)}else i[h]||(i[h]=[]),i[h].push(o);else await Promise.all(Object.keys(t).map((e=>t[e](o))))},o.onerror=async function(){await Promise.all(Object.keys(t).map((e=>t[e]({msg:"unexpected_error",message:y}))))})}function ht(t,e){t&&(t.open=!1,null==e||e.abort())}function ut(t,e,i){!t[e]?(t[e]=[],i.data.forEach(((i,s)=>{t[e][s]=i}))):i.data.forEach(((s,n)=>{let r=(a=t[e][n],s.forEach((([t,e,i])=>{a=function(t,e,i,s){if(0===e.length){if("replace"===i)return s;if("append"===i)return t+s;throw new Error(`Unsupported action: ${i}`)}let n=t;for(let t=0;t<e.length-1;t++)n=n[e[t]];const r=e[e.length-1];switch(i){case"replace":n[r]=s;break;case"append":n[r]+=s;break;case"add":Array.isArray(n)?n.splice(Number(r),0,s):n[r]=s;break;case"delete":Array.isArray(n)?n.splice(Number(r),1):delete n[r];break;default:throw new Error(`Unknown action: ${i}`)}return t}(a,e,t,i)})),a);var a;t[e][n]=r,i.data[n]=r}))}function ct(t,e={}){const i={close:()=>{},onerror:null,onmessage:null,onopen:null,readyState:0,url:t.toString(),withCredentials:!1,CONNECTING:0,OPEN:1,CLOSED:2,addEventListener:()=>{throw new Error("Method not implemented.")},dispatchEvent:()=>{throw new Error("Method not implemented.")},removeEventListener:()=>{throw new Error("Method not implemented.")}};return async function(t,e){let i=new Request(t,e);rt(i.headers,"Accept","text/event-stream"),rt(i.headers,"Content-Type","application/json");let s=await fetch(i);if(!s.ok)throw s;return at(s,i.signal)}(t,e).then((async t=>{i.readyState=i.OPEN;try{for await(const e of t)i.onmessage&&i.onmessage(e);i.readyState=i.CLOSED}catch(t){i.onerror&&i.onerror(t),i.readyState=i.CLOSED}})).catch((t=>{i.onerror&&i.onerror(t),i.readyState=i.CLOSED})),i}function _t(t,e={},i,s,n){var r;try{let a=function(t){(n||Q[t.type])&&_(t)},o=function(){for(et=!0;st.length>0;)st.shift()({value:void 0,done:!0})},h=function(t){et||(st.length>0?st.shift()(t):it.push(t))},u=function(t){h(function(t){return{then:(e,i)=>i(t)}}(t)),o()},_=function(t){h({value:t,done:!1})},l=function(){return it.length>0?Promise.resolve(it.shift()):et?Promise.resolve({value:void 0,done:!0}):new Promise((t=>st.push(t)))};const{hf_token:f}=this.options,{fetch:p,app_reference:g,config:w,session_hash:b,api_info:v,api_map:x,stream_status:I,pending_stream_messages:A,pending_diff_streams:k,event_callbacks:C,unclosed_events:E,post_data:B,options:D,api_prefix:F}=this,O=this;if(!v)throw new Error("No API found");if(!w)throw new Error("Could not resolve app config");let j,P,{fn_index:U,endpoint_info:T,dependency:N}=function(t,e,i,s){let n,r,a;if("number"==typeof e)n=e,r=t.unnamed_endpoints[n],a=s.dependencies.find((t=>t.id==e));else{const o=e.replace(/^\//,"");n=i[o],r=t.named_endpoints[e.trim()],a=s.dependencies.find((t=>t.id==i[o]))}if("number"!=typeof n)throw new Error("There is no endpoint matching that name of fn_index matching that number.");return{fn_index:n,endpoint_info:r,dependency:a}}(v,t,x,w),M=((t=[],e)=>{const i=e?e.parameters:[];if(Array.isArray(t))return t.length,i.length,t;const s=[],n=Object.keys(t);return i.forEach(((e,i)=>{if(t.hasOwnProperty(e.parameter_name))s[i]=t[e.parameter_name];else{if(!e.parameter_has_default)throw new Error(`No value provided for required parameter: ${e.parameter_name}`);s[i]=e.parameter_default}})),n.forEach((t=>{if(!i.some((e=>e.parameter_name===t)))throw new Error(`Parameter \`${t}\` is not a valid keyword argument. Please refer to the API for usage.`)})),s.forEach(((t,e)=>{if(void 0===t&&!i[e].parameter_has_default)throw new Error(`No value provided for required parameter: ${i[e].parameter_name}`)})),s})(e,T),q=w.protocol??"ws",R="",L=()=>R;const V="number"==typeof t?"/predict":t;let W,H=null,J=!1,K={},Z="undefined"!=typeof window&&"undefined"!=typeof document?new URLSearchParams(window.location.search).toString():"";const Q=(null==(r=null==D?void 0:D.events)?void 0:r.reduce(((t,e)=>(t[e]=!0,t)),{}))||{};async function X(){const t={stage:"complete",queue:!1,time:new Date};J=t,a({...t,type:"status",endpoint:V,fn_index:U});let e={},i={};"ws"===q?(j&&0===j.readyState?j.addEventListener("open",(()=>{j.close()})):j.close(),e={fn_index:U,session_hash:b}):(ht(I,O.abort_controller),o(),e={event_id:H},i={event_id:H,session_hash:b,fn_index:U});try{if(!w)throw new Error("Could not resolve app config");"event_id"in i&&await p(`${w.root}${F}/cancel`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(i)}),await p(`${w.root}${F}/reset`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)})}catch(t){}}const Y=async t=>{await this._resolve_hearbeat(t)};async function tt(t){if(!w)return;let e=t.render_id;w.components=[...w.components.filter((t=>t.props.rendered_in!==e)),...t.components],w.dependencies=[...w.dependencies.filter((t=>t.rendered_in!==e)),...t.dependencies];const i=w.components.some((t=>"state"===t.type)),s=w.dependencies.some((t=>t.targets.some((t=>"unload"===t[1]))));w.connect_heartbeat=i||s,await Y(w),a({type:"render",data:t,endpoint:V,fn_index:U})}this.handle_blob(w.root,M,T).then((async t=>{var e;let n=G(t,N,w.components,"input",!0);if(W={data:n||[],event_data:i,fn_index:U,trigger_id:s},function(t,e){var i,s;let n=null==(s=null==(i=null==e?void 0:e.dependencies)?void 0:i.find((e=>e.id==t)))?void 0:s.queue;return null!=n?!n:!e.enable_queue}(U,w))a({type:"status",endpoint:V,stage:"pending",queue:!1,fn_index:U,time:new Date}),B(`${w.root}${F}/run${V.startsWith("/")?V:`/${V}`}${Z?"?"+Z:""}`,{...W,session_hash:b}).then((([t,e])=>{const n=t.data;200==e?(a({type:"data",endpoint:V,fn_index:U,data:G(n,N,w.components,"output",D.with_null_state),time:new Date,event_data:i,trigger_id:s}),t.render_config&&tt(t.render_config),a({type:"status",endpoint:V,fn_index:U,stage:"complete",eta:t.average_duration,queue:!1,time:new Date})):a({type:"status",stage:"error",endpoint:V,fn_index:U,message:t.error,queue:!1,time:new Date})})).catch((t=>{a({type:"status",stage:"error",message:t.message,endpoint:V,fn_index:U,queue:!1,time:new Date})}));else if("ws"==q){const{ws_protocol:t,host:e}=await $(g,f);a({type:"status",stage:"pending",queue:!0,endpoint:V,fn_index:U,time:new Date});let n=new URL(`${t}://${S(e,w.path,!0)}/queue/join${Z?"?"+Z:""}`);this.jwt&&n.searchParams.set("__sign",this.jwt),j=new WebSocket(n),j.onclose=t=>{t.wasClean||a({type:"status",stage:"error",broken:!0,message:y,queue:!0,endpoint:V,fn_index:U,time:new Date})},j.onmessage=function(t){const e=JSON.parse(t.data),{type:n,status:r,data:o}=z(e,K[U]);if("update"===n&&r&&!J)a({type:"status",endpoint:V,fn_index:U,time:new Date,...r}),"error"===r.stage&&j.close();else{if("hash"===n)return void j.send(JSON.stringify({fn_index:U,session_hash:b}));"data"===n?j.send(JSON.stringify({...W,session_hash:b})):"complete"===n?J=r:"log"===n?a({type:"log",title:o.title,log:o.log,level:o.level,endpoint:V,duration:o.duration,visible:o.visible,fn_index:U}):"generating"===n&&a({type:"status",time:new Date,...r,stage:null==r?void 0:r.stage,queue:!0,endpoint:V,fn_index:U})}o&&(a({type:"data",time:new Date,data:G(o.data,N,w.components,"output",D.with_null_state),endpoint:V,fn_index:U,event_data:i,trigger_id:s}),J&&(a({type:"status",time:new Date,...J,stage:null==r?void 0:r.stage,queue:!0,endpoint:V,fn_index:U}),j.close()))},c(w.version||"2.0.0","3.6")<0&&addEventListener("open",(()=>j.send(JSON.stringify({hash:b}))))}else if("sse"==q){a({type:"status",stage:"pending",queue:!0,endpoint:V,fn_index:U,time:new Date});var r=new URLSearchParams({fn_index:U.toString(),session_hash:b}).toString();let t=new URL(`${w.root}${F}/${d}?${Z?Z+"&":""}${r}`);if(this.jwt&&t.searchParams.set("__sign",this.jwt),P=this.stream(t),!P)return Promise.reject(new Error("Cannot connect to SSE endpoint: "+t.toString()));P.onmessage=async function(t){const e=JSON.parse(t.data),{type:n,status:r,data:h}=z(e,K[U]);if("update"===n&&r&&!J)a({type:"status",endpoint:V,fn_index:U,time:new Date,...r}),"error"===r.stage&&(null==P||P.close(),o());else if("data"===n){let[t,e]=await B(`${w.root}${F}/queue/data`,{...W,session_hash:b,event_id:H});200!==e&&(a({type:"status",stage:"error",message:y,queue:!0,endpoint:V,fn_index:U,time:new Date}),null==P||P.close(),o())}else"complete"===n?J=r:"log"===n?a({type:"log",title:h.title,log:h.log,level:h.level,endpoint:V,duration:h.duration,visible:h.visible,fn_index:U}):"generating"!==n&&"streaming"!==n||a({type:"status",time:new Date,...r,stage:null==r?void 0:r.stage,queue:!0,endpoint:V,fn_index:U});h&&(a({type:"data",time:new Date,data:G(h.data,N,w.components,"output",D.with_null_state),endpoint:V,fn_index:U,event_data:i,trigger_id:s}),J&&(a({type:"status",time:new Date,...J,stage:null==r?void 0:r.stage,queue:!0,endpoint:V,fn_index:U}),null==P||P.close(),o()))}}else if("sse_v1"==q||"sse_v2"==q||"sse_v2.1"==q||"sse_v3"==q){a({type:"status",stage:"pending",queue:!0,endpoint:V,fn_index:U,time:new Date});let t="";"undefined"!=typeof window&&"undefined"!=typeof document&&(t=null==(e=null==window?void 0:window.location)?void 0:e.hostname);let i="dev.spaces.huggingface.tech";const s=t.includes(".dev.")?`https://moon-${t.split(".")[1]}.${i}`:"https://huggingface.co",n="undefined"!=typeof window&&"undefined"!=typeof document&&window.parent!=window,r=N.zerogpu&&w.space_id,h=n&&r?function(t,e){return new Promise(((i,s)=>{const n=new MessageChannel;n.port1.onmessage=({data:t})=>{n.port1.close(),i(t)},window.parent.postMessage(t,e,[n.port2])}))}("zerogpu-headers",s):Promise.resolve(null);h.then((t=>B(`${w.root}${F}/queue/join?${Z}`,{...W,session_hash:b},t))).then((async([t,e])=>{if(503===e)a({type:"status",stage:"error",message:m,queue:!0,endpoint:V,fn_index:U,time:new Date});else if(200!==e)a({type:"status",stage:"error",message:y,queue:!0,endpoint:V,fn_index:U,time:new Date});else{H=t.event_id,R=H;let e=async function(t){try{const{type:e,status:i,data:s,original_msg:n}=z(t,K[U]);if("heartbeat"==e)return;if("update"===e&&i&&!J)a({type:"status",endpoint:V,fn_index:U,time:new Date,original_msg:n,...i});else if("complete"===e)J=i;else if("unexpected_error"==e)a({type:"status",stage:"error",message:(null==i?void 0:i.message)||"An Unexpected Error Occurred!",queue:!0,endpoint:V,fn_index:U,time:new Date});else{if("log"===e)return void a({type:"log",title:s.title,log:s.log,level:s.level,endpoint:V,duration:s.duration,visible:s.visible,fn_index:U});"generating"!==e&&"streaming"!==e||(a({type:"status",time:new Date,...i,stage:null==i?void 0:i.stage,queue:!0,endpoint:V,fn_index:U}),s&&"stream"!==N.connection&&["sse_v2","sse_v2.1","sse_v3"].includes(q)&&ut(k,H,s))}s&&(a({type:"data",time:new Date,data:G(s.data,N,w.components,"output",D.with_null_state),endpoint:V,fn_index:U}),s.render_config&&await tt(s.render_config),J&&(a({type:"status",time:new Date,...J,stage:null==i?void 0:i.stage,queue:!0,endpoint:V,fn_index:U}),o())),"complete"!==(null==i?void 0:i.stage)&&"error"!==(null==i?void 0:i.stage)||(C[H]&&delete C[H],H in k&&delete k[H])}catch(t){a({type:"status",stage:"error",message:"An Unexpected Error Occurred!",queue:!0,endpoint:V,fn_index:U,time:new Date}),["sse_v2","sse_v2.1","sse_v3"].includes(q)&&(ht(I,O.abort_controller),I.open=!1,o())}};H in A&&(A[H].forEach((t=>e(t))),delete A[H]),C[H]=e,E.add(H),I.open||await this.open_stream()}}))}}));let et=!1;const it=[],st=[],nt={[Symbol.asyncIterator]:()=>nt,next:l,throw:async t=>(u(t),l()),return:async()=>(o(),l()),cancel:X,event_id:L};return nt}catch(rt){throw rt}}s=new WeakMap;class dt{constructor(t,e={events:["data"]}){a(this,"app_reference"),a(this,"options"),a(this,"config"),a(this,"api_prefix",""),a(this,"api_info"),a(this,"api_map",{}),a(this,"session_hash",Math.random().toString(36).substring(2)),a(this,"jwt",!1),a(this,"last_status",{}),a(this,"cookies",null),a(this,"stream_status",{open:!1}),a(this,"pending_stream_messages",{}),a(this,"pending_diff_streams",{}),a(this,"event_callbacks",{}),a(this,"unclosed_events",new Set),a(this,"heartbeat_event",null),a(this,"abort_controller",null),a(this,"stream_instance",null),a(this,"current_payload"),a(this,"ws_map",{}),a(this,"view_api"),a(this,"upload_files"),a(this,"upload"),a(this,"handle_blob"),a(this,"post_data"),a(this,"submit"),a(this,"predict"),a(this,"open_stream"),a(this,"resolve_config"),a(this,"resolve_cookies"),this.app_reference=t,e.events||(e.events=["data"]),this.options=e,this.current_payload={},this.view_api=T.bind(this),this.upload_files=N.bind(this),this.handle_blob=W.bind(this),this.post_data=K.bind(this),this.submit=_t.bind(this),this.predict=Z.bind(this),this.open_stream=ot.bind(this),this.resolve_config=k.bind(this),this.resolve_cookies=C.bind(this),this.upload=M.bind(this),this.fetch=this.fetch.bind(this),this.handle_space_success=this.handle_space_success.bind(this),this.stream=this.stream.bind(this)}fetch(t,e){const i=new Headers((null==e?void 0:e.headers)||{});return this&&this.cookies&&i.append("Cookie",this.cookies),fetch(t,{...e,headers:i})}stream(t){const e=new Headers;return this&&this.cookies&&e.append("Cookie",this.cookies),this.abort_controller=new AbortController,this.stream_instance=ct(t.toString(),{credentials:"include",headers:e,signal:this.abort_controller.signal}),this.stream_instance}async init(){var t;if(!("undefined"!=typeof window&&"WebSocket"in window||global.WebSocket)){const t=await Promise.all([i.e("vendors-node_modules_abort-controller_browser_js-node_modules_asn1_js_lib_asn1_js"),i.e("vendors-node_modules_crypto-browserify_index_js-node_modules_events_events_js-node_modules_ha-b8b43e"),i.e("vendors-node_modules_md5_js_index_js-node_modules_miller-rabin_lib_mr_js-node_modules_minimal-c99de5"),i.e("vendors-node_modules_sha_js_index_js-node_modules_stream-browserify_index_js-node_modules_str-25dd82"),i.e("node_modules_gradio_client_dist_wrapper-CviSselG_js")]).then(i.bind(i,37933));global.WebSocket=t.WebSocket}this.options.auth&&await this.resolve_cookies(),await this._resolve_config().then((({config:t})=>this._resolve_hearbeat(t))),this.api_info=await this.view_api(),this.api_map=function(t){let e={};return t.forEach((({api_name:t,id:i})=>{t&&(e[t]=i)})),e}((null==(t=this.config)?void 0:t.dependencies)||[])}async _resolve_hearbeat(t){if(t&&(this.config=t,this.api_prefix=t.api_prefix||"",this.config&&this.config.connect_heartbeat&&this.config.space_id&&this.options.hf_token&&(this.jwt=await A(this.config.space_id,this.options.hf_token,this.cookies))),t.space_id&&this.options.hf_token&&(this.jwt=await A(t.space_id,this.options.hf_token)),this.config&&this.config.connect_heartbeat){const t=new URL(`${this.config.root}${this.api_prefix}/heartbeat/${this.session_hash}`);this.jwt&&t.searchParams.set("__sign",this.jwt),this.heartbeat_event||(this.heartbeat_event=this.stream(t))}}static async connect(t,e={events:["data"]}){const i=new this(t,e);return await i.init(),i}close(){ht(this.stream_status,this.abort_controller)}set_current_payload(t){this.current_payload=t}static async duplicate(t,e={events:["data"]}){return it(t,e)}async _resolve_config(){const{http_protocol:t,host:e,space_id:i}=await $(this.app_reference,this.options.hf_token),{status_callback:s}=this.options;let n;i&&s&&await X(i,s);try{if(n=await this.resolve_config(`${t}//${e}`),!n)throw new Error(w);return this.config_success(n)}catch(t){if(!i||!s)throw s&&s({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),Error(t);Q(i,F.test(i)?"space_name":"subdomain",this.handle_space_success)}}async config_success(t){if(this.config=t,this.api_prefix=t.api_prefix||"","undefined"!=typeof window&&"undefined"!=typeof document&&"https:"===window.location.protocol&&(this.config.root=this.config.root.replace("http://","https://")),this.config.auth_required)return this.prepare_return_obj();try{this.api_info=await this.view_api()}catch(t){}return this.prepare_return_obj()}async handle_space_success(t){var e;if(!this)throw new Error(w);const{status_callback:i}=this.options;if(i&&i(t),"running"===t.status)try{if(this.config=await this._resolve_config(),this.api_prefix=(null==(e=null==this?void 0:this.config)?void 0:e.api_prefix)||"",!this.config)throw new Error(w);return await this.config_success(this.config)}catch(t){throw i&&i({status:"error",message:"Could not load this space.",load_status:"error",detail:"NOT_FOUND"}),t}}async component_server(t,e,i){var s;if(!this.config)throw new Error(w);const n={},{hf_token:r}=this.options,{session_hash:a}=this;let o;r&&(n.Authorization=`Bearer ${this.options.hf_token}`);let h,u=this.config.components.find((e=>e.id===t));if(o=(null==(s=null==u?void 0:u.props)?void 0:s.root_url)?u.props.root_url:this.config.root,"binary"in i){h=new FormData;for(const t in i.data)"binary"!==t&&h.append(t,i.data[t]);h.set("component_id",t.toString()),h.set("fn_name",e),h.set("session_hash",a)}else h=JSON.stringify({data:i,component_id:t,fn_name:e,session_hash:a}),n["Content-Type"]="application/json";r&&(n.Authorization=`Bearer ${r}`);try{const t=await this.fetch(`${o}${this.api_prefix}/component_server/`,{method:"POST",body:h,headers:n,credentials:"include"});if(!t.ok)throw new Error("Could not connect to component server: "+t.statusText);return await t.json()}catch(t){}}set_cookies(t){this.cookies=D(t).join("; ")}prepare_return_obj(){return{config:this.config,predict:this.predict,submit:this.submit,view_api:this.view_api,component_server:this.component_server}}async connect_ws(t){return new Promise(((e,i)=>{let s;try{s=new WebSocket(t)}catch(e){return void(this.ws_map[t]="failed")}s.onopen=()=>{e()},s.onerror=i=>{this.close_ws(t),this.ws_map[t]="failed",e()},s.onclose=()=>{delete this.ws_map[t],this.ws_map[t]="failed"},s.onmessage=t=>{},this.ws_map[t]=s}))}async send_ws_message(t,e){t in this.ws_map||await this.connect_ws(t);const i=this.ws_map[t];i instanceof WebSocket?i.send(JSON.stringify(e)):this.post_data(t,e)}async close_ws(t){if(t in this.ws_map){const e=this.ws_map[t];e instanceof WebSocket&&(e.close(),delete this.ws_map[t])}}}}}]);